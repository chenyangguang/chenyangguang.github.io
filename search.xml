[{"title":"周末","url":"http://chenyangguang.github.com/2018-11-11-weekenday/","content":"<h2 id=\"双十一什么的\"><a href=\"#双十一什么的\" class=\"headerlink\" title=\"双十一什么的\"></a>双十一什么的</h2><p>  好像跟我没啥关系, 这一天花了50块钱，周末了，吃饭加水果。想买个Bose QC 35,  要2000+,AirPods 也需要至少1200+, 暂时算了。还没到时候。</p>\n<h2 id=\"写博客的理由\"><a href=\"#写博客的理由\" class=\"headerlink\" title=\"写博客的理由\"></a>写博客的理由</h2><p>  与其说是写博客的理由，还不如说是梳理自己思路的方式吧。不为谁看，谁不看。任凭自己的思路铺展开来，想到哪里，就写到哪里，不必像儿时的语文课作文，不必像高考的证明题，也不像大学毕业设计。总之，我现在想的是什么，就写什么。无需关心点赞，更不用管什么转发量。</p>\n<h2 id=\"近期锻炼侧重\"><a href=\"#近期锻炼侧重\" class=\"headerlink\" title=\"近期锻炼侧重\"></a>近期锻炼侧重</h2><p>  由于脚髁的皮外伤还没有完全好，最近调整了锻炼的侧重比例, 增加了平板支撑的科目。人的身体的中心在腰腹部，所以需要将身体的核心位置练强壮一点。平板支撑锻炼的身体的核心肌肉群, 经过一段时间早晚锻炼，目前单次最长可以支撑到90s了。每日两次，每次三组，加起来一天差不多12分钟。</p>\n<h2 id=\"无惧野狐3段了\"><a href=\"#无惧野狐3段了\" class=\"headerlink\" title=\"无惧野狐3段了\"></a>无惧野狐3段了</h2><p>一年前，我还是野狐一段水准。9月份开始，对战野狐2段我已经有了超过70%的胜率了。10月份甚至达到过4段, 但是很不稳定，从2段上去，一段时间连胜，一段时间连败，反反复复，很不稳定, 所以还是3段中的水平吧。后来分析了一下，是复盘很少。目前腾讯围棋的绝艺复盘，已经开放给大众了。一天下两盘，可以收获4个积分，5个积分可以申请一次绝艺复盘, 查看了自己的一下胜率分布，发现赢的多数是我逆转的棋。进入了11月份之后，对战3段，已经有了60%的胜率了。但是我现在坚持一天最多下两盘质量局。希望多一点时间发现自己薄弱的环节，比如布局，贴身格斗。争取在年底前，能将棋力提升至4段中上的实力稳定线上。</p>\n<h2 id=\"行走\"><a href=\"#行走\" class=\"headerlink\" title=\"行走\"></a>行走</h2><p>  我个人感觉，自已最有想法的时候，往往是在路上。在行走的路上，一边走，一边由着思绪散开，漂流。任它们游走，旋转，重装，组合，平时工作日里面种种困顿烦扰的问题，随着路途的遥远慢慢蒸发，随着海拔的提升渐渐稀释，随着时间的运转徐徐淡色。我喜欢行走，到目前为止，我人生中的几次重大选择都是在极目远眺的行走时拿定注意的。<br>  五岳中，还有西岳华山，北岳恒山，中岳嵩山没有涉足。年底前找个时间去一趟，看看。有个同事会问我，我看你那么喜欢去爬山，但是你说你，爬完回来也没啥变化啊。是啊，爬一座山，可能真的没啥变化的。但是我能出去看看别的地方的真实的存在，涨涨见识。突然想到以前看到的有个登上喜玛拉雅山顶的人说的：“因为山就在哪里”。“这能长什么见识，爬山就能长见识啊”？ 我一时无语。好比看一本书，我们很可能读完，会感觉没啥收获啊，那我下次还会不会读书呢？会。为什么？因为无论你觉得或者不觉得，我们经历过的事情，会对我们的认知，对我们的世界观，人生观有一个看不见的作用。没法预料哪一个瞬间，你就想到曾见过的一朵盛开的蓝莲花，也没准哪一个时刻，就会浮现雪山上的石头缝里的一株野草, 也没准某个夜深人静的时候，就勾勒起野营时漫天的繁星。它们已经埋在我们的记忆里，根植于我们的血脉里。它们告诉我们，岁月流逝，生命坚韧，星空浩瀚。而我们见识过繁花的一瞬，我们手抚过山巅上的流云，我们迎过高空的日升日落。这就是我关闭朋友圈半年来, 真实的活过, 思考过。</p>\n","categories":[],"tags":["点滴"]},{"title":"十月","url":"http://chenyangguang.github.com/2018-10-31-october/","content":"<h2 id=\"十月就这样过去了\"><a href=\"#十月就这样过去了\" class=\"headerlink\" title=\"十月就这样过去了\"></a>十月就这样过去了</h2><p>国庆节期间一双拖鞋，两天，反穿武功山。<br>还是喜欢以前一边徒步一边记笔记好玩。那样能记录实时的真的感受。现在是拍拍风景照，发发群，吹吹水，就这么过去了。</p>\n<h2 id=\"第一次滑旱冰\"><a href=\"#第一次滑旱冰\" class=\"headerlink\" title=\"第一次滑旱冰\"></a>第一次滑旱冰</h2><p>月底时，部门组织的活动，人生中的第一次滑旱冰。摔了差不多十个狗吃屎。还把脚踝外部磨破了一块皮。搞得好几天没结痂。连游泳跑步也不行了。还是保护自己不周到, 以后得注意了。</p>\n<h2 id=\"定投\"><a href=\"#定投\" class=\"headerlink\" title=\"定投\"></a>定投</h2><p>10月11号开始定投。开始管理自己的工资了。以前从来没有投资过，这次长期定投预计是2-3年。目前累计收益6.82%, 午餐可以加几个鸡蛋了。定投需要耐心，买到指数基金。买的是趋势，买的是国运。</p>\n<h2 id=\"开发业务\"><a href=\"#开发业务\" class=\"headerlink\" title=\"开发业务\"></a>开发业务</h2><p>加班太多，领导找去谈话了。其实我完全没必要加班的。但是白天处理的杂事太多，而且需要#bug修复的多，主干开发白天时间严重不够。另外就是白天来得早啊，晚上7，8点回去，都记加班到10小时，11小时了, 这个怎么算了。</p>\n<h2 id=\"年底前定个小目标吧\"><a href=\"#年底前定个小目标吧\" class=\"headerlink\" title=\"年底前定个小目标吧\"></a>年底前定个小目标吧</h2><p>年点前，开发一款能平台通用的应用产品并上线。<br>名字还没想好。初步采用 weex 来写。</p>\n","categories":[],"tags":["点滴"]},{"title":"记一个API20倍性能优化","url":"http://chenyangguang.github.com/2018-09-24-optimize/","content":"<h2 id=\"同步\"><a href=\"#同步\" class=\"headerlink\" title=\"同步\"></a>同步</h2><p>我接手的其中一个项目中，有一个核心的业务是提供用户信息同步功能。这个同步API后头还连着其他关联业务，比如创建账号，查询信息，下载信息等。</p>\n<h2 id=\"历史问题\"><a href=\"#历史问题\" class=\"headerlink\" title=\"历史问题\"></a>历史问题</h2><p>这个业务历史悠久，主要是为各产品部门调用该接口，上传用户信息, 提供线上服务做支撑。而这个同步接口，从上线到目前为止，已经优化了35个版本！目前性能为： 同步26000个用户信息，耗时45分钟左右。调用方也是经常用到心里发毛。所以现在交到我手上了。</p>\n<h2 id=\"动手\"><a href=\"#动手\" class=\"headerlink\" title=\"动手\"></a>动手</h2><ul>\n<li>了解需求 沟通, 游走各个关口。 读源码， 画流程图。</li>\n<li>调查问题瓶颈, 监控系统(prometheus)分析响应时间，耗时。 断点设置，日志，数据库统计耗时。</li>\n<li>开会讨论, 讨论痛点，下决心，职责划分，争论方案。</li>\n<li>开会讨论, 下决心, 职责划分，争论方案。</li>\n<li>开会讨论, 定方案, 开发周期，拉一个架构师和技术副总监一起过。</li>\n<li>边写测试单例，边构思。</li>\n<li>开会, 了解进度，方案可行性。</li>\n<li>完成本地批量测试, 模拟客户端访问。引入 golang 自带的 pprof 工具。</li>\n<li>重构数据库, 优化表结构，加索引等。</li>\n<li>重构分支流程, 码代码。</li>\n<li>开发集中。中间又出几个问题，又来了几次会议，不断切遇到的问题，以及之前问题的盲点，逐一条出解决方案。</li>\n<li>合并</li>\n<li>单元测试</li>\n<li>压测</li>\n</ul>\n<h2 id=\"优化点\"><a href=\"#优化点\" class=\"headerlink\" title=\"优化点\"></a>优化点</h2><ul>\n<li>数据库表调整，添加索引。</li>\n<li>同步阶段，断开一个占用耗时将近1/3的外部接口,将外部接口交互流程滞后执行。</li>\n<li>批量处理，单个用户的信息，批次查询，然后本地计算，最后批量入库。</li>\n<li>合理地利用goroutine。</li>\n<li>等。</li>\n</ul>\n<h2 id=\"效果\"><a href=\"#效果\" class=\"headerlink\" title=\"效果\"></a>效果</h2><p>  部署到测试环境, 26000个用户月50s内同步完。优化后版本同步速度获得约20倍质的提升!暂时做个笔记吧。这个版本部分工作，是在“山竹”台风到达那天完成的。还好人没事,凌晨从公司回到了家。<br>线上的性能，待我上线确认之后再更新。</p>\n<h2 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h2><p>遇到问题，找到病因，对症下药，合理使用开源工具(比如 prometheus 和 pprof 在分析瓶颈中发挥重要的作用)。每一个解决掉的问题，都是我下一步前进的动力。</p>\n","categories":[],"tags":["Web"]},{"title":"泰山观日出","url":"http://chenyangguang.github.com/2018-08-27-taishan/","content":"<h1 id=\"出发\"><a href=\"#出发\" class=\"headerlink\" title=\"出发\"></a>出发</h1><p>我愿追随自己年轻时的血气方刚，再来几次出发，远行。</p>\n<h2 id=\"半夜闹钟\"><a href=\"#半夜闹钟\" class=\"headerlink\" title=\"半夜闹钟\"></a>半夜闹钟</h2><p>上周六2018-08-25，怕半夜赶不上车，弄了3:00,3:30，4:00的闹钟。好在及时在第一波闹钟的提醒里起来。赶在4:20到了机场。</p>\n<h2 id=\"飞机\"><a href=\"#飞机\" class=\"headerlink\" title=\"飞机\"></a>飞机</h2><p>在这个城市四年了，我是第一次到这个机场。一开始我以为自己时间还是挺多的。但是只是好奇了几下这里候机的来来往往的人，心里暗暗感叹了一会机场的穹顶，一路从安检走到登机口，感觉绕过过了两个操场。<br>早上6:10的飞机。<br>头一次总飞机。那个心情真的是, 好爽啊。特别是一面忐忑着，一面又极其激动地坐着飞机，轰隆隆地在跑道上奔着，地面的草向后面越来越快的划退，奔着奔着，后背一靠，前头拔高，脚底感觉有一股厚实的板顶着，飞起来了！要上天了！</p>\n<h2 id=\"济南的夏天\"><a href=\"#济南的夏天\" class=\"headerlink\" title=\"济南的夏天\"></a>济南的夏天</h2><p>热。</p>\n<h2 id=\"泰安的小饭馆\"><a href=\"#泰安的小饭馆\" class=\"headerlink\" title=\"泰安的小饭馆\"></a>泰安的小饭馆</h2><p>香，实惠的小菜。</p>\n<h1 id=\"泰山\"><a href=\"#泰山\" class=\"headerlink\" title=\"泰山\"></a>泰山</h1><p>泰山北斗，可不是比衡山难爬嘛! 十八盘。。。。。。， 给我多来几盘。</p>\n<h2 id=\"日出\"><a href=\"#日出\" class=\"headerlink\" title=\"日出\"></a>日出</h2><p>山顶扎一小帐篷，租一军大衣。本以为可以好好地在石板地上睡到第二天至少4点吧。。。。。。, 谁知道凌晨1点之后，陆续地帐篷周边热闹起来，压根睡不着觉。打游戏的，聊天的，嬉戏的，吃东西的，喊冷的，哼小曲的，小孩哭闹的。。。。。。许多观日出的人不远万里的，赶来等日出的好日子。4点起来，想找个位置，附近的所有能站人的石头面，都被人占着了。。。。。。后来绕树丛里，钻爬到一处人少的稍险的高台上。占着。<br>5点半左右，出来了!<br>日出时，天际的云海光影和初生的圆盘, 真的是不可阻挡, 那种透射出来的光芒柔韧而坚实。三个山头的人禁不住齐齐呐喊一阵。各种手机姿势抬着，留下在泰山上的非凡的金色映像中。</p>\n<h2 id=\"趵突泉\"><a href=\"#趵突泉\" class=\"headerlink\" title=\"趵突泉\"></a>趵突泉</h2><p>三个大泉眼。</p>\n<h2 id=\"老舍纪念馆\"><a href=\"#老舍纪念馆\" class=\"headerlink\" title=\"老舍纪念馆\"></a>老舍纪念馆</h2><p>那个老舍的房子好封闭！”济南的冬天”就是在这样的院子里写出来的吗？好怀念那个时代的人对天地人的感受。</p>\n<h1 id=\"在路上\"><a href=\"#在路上\" class=\"headerlink\" title=\"在路上\"></a>在路上</h1><p>不断行走，在路上。</p>\n","categories":[],"tags":["行万里"]},{"title":"衡山","url":"http://chenyangguang.github.com/2018-08-19-hengshan/","content":"<h1 id=\"衡山我来了\"><a href=\"#衡山我来了\" class=\"headerlink\" title=\"衡山我来了\"></a>衡山我来了</h1><p>初次听说衡山，是初二时学地理, 要考试，背书，弄了个顺口溜:”东西南北中，秦华衡恒嵩”。而且，这五座自古为游人津津乐道的心目中的憧憬，到底是晚来得太久了。<br>这次跑往衡山来爬。并不是想扎人堆，而是想出来散散心, 走走，舒展舒展筋骨。</p>\n<h2 id=\"太庙\"><a href=\"#太庙\" class=\"headerlink\" title=\"太庙\"></a>太庙</h2><p>入乡随俗，上山前，到太庙烧一炷香，拜一扣佛。</p>\n<h2 id=\"南天门\"><a href=\"#南天门\" class=\"headerlink\" title=\"南天门\"></a>南天门</h2><p>西面大风夹着云雾沿着南天门的山脊，扇吹过来，将衡山一分为二。</p>\n<h2 id=\"祝融峰\"><a href=\"#祝融峰\" class=\"headerlink\" title=\"祝融峰\"></a>祝融峰</h2><p>到顶了。</p>\n<h2 id=\"累了\"><a href=\"#累了\" class=\"headerlink\" title=\"累了\"></a>累了</h2><p>到过，这是起点。<br>过了，不想写了。</p>\n","categories":[],"tags":["行万里"]},{"title":"holiday","url":"http://chenyangguang.github.com/2018-06-18-holiday/","content":"<h2 id=\"澳门半天-2018-06-16\"><a href=\"#澳门半天-2018-06-16\" class=\"headerlink\" title=\"澳门半天(2018-06-16)\"></a>澳门半天(2018-06-16)</h2><p>平日锁在一个笼子一样的办公室，今日看了半天书，心里烦闷，翻箱倒柜中，发现港澳通行证还要次数。于是买个 14:30 的船票一路从蛇口出发，往澳门去了。目标是观光塔。一路中有几件事蛮有意思的。记一下。</p>\n<h3 id=\"第一件-奇怪的身边船客。\"><a href=\"#第一件-奇怪的身边船客。\" class=\"headerlink\" title=\"第一件, 奇怪的身边船客。\"></a>第一件, 奇怪的身边船客。</h3><p>本来我的船票是二楼第二排靠窗的，结果有个穿厚外套的老者先到，坐到我的位置去了。等我上去示意他坐了我的舱位时，他说他想坐舷窗，要和我换。我想着照顾老人，那算了。原本我也想靠外坐，看海景方便些。后来他就一直用手机看信息去了。直到我中间拿出《区块链原理、设计与应用》的书看上一段时间。他趁我翻页时，要借书看看封面和目录，随手翻了下。然后眼睛一亮，说道：“这本书可不可以借我一分钟拍个照”？我有点楞，但马上回过神来：“行，你要想看，你先拿去看吧。没事，我回去可以接着看的”。他赶紧解释：“哦，那倒不用，我想借来拍几张”。“可以，可以。给”。我就看他那眼睛像瞄上一个猎物一样。拿着这书，快速翻着，拍了几张。然后按下一个语音按钮，对着手机发起语音来：“张秘书，我刚才给你发一本书的图片过去，你去下个单，……另外，调研一下，是否还有没有同类的书，照着订几套，。。。。。。先订１０套，xxx级别以下的都让他们先学习学习。好吧。。。。。。”。有些其他的话就记不清了。总之，可以听出来，我后边舷窗的这位，可不是一个平常的游客！而且，仅凭船上一个游客看的书，他怎么就马上叫人下单去？这让我百思不得其解。可见这个人，对前沿技术或者对市场有着某种嗅觉。这个有点令我感到意外。</p>\n<h3 id=\"第二件，233米高空漫步。\"><a href=\"#第二件，233米高空漫步。\" class=\"headerlink\" title=\"第二件，233米高空漫步。\"></a>第二件，233米高空漫步。</h3><p>在路上就很期待此次行程有所心理突破的。233米，我是奔着那个蹦极来的。车从桥上横渡海岸时，就远远看着这个观光塔了。塔身是个多变型，塔尖下方有一个圆环型观光台。有一侧斜拉着两条锁绳。坐电梯上去，透过玻璃门，看到地面逐渐下沉，心里开始打鼓了。到了58层时，靠着玻璃窗户，站在那些透明的板上，看着西面的车那么小，人影那么小。生怕自己掉下去了。蹦极的人，从上面双手伸展，打个十字，嘶喊着前倾倒下来，58层的人群围拢起来，一起探头出去看。哈哈，我的心里想：这些人啊。。。。。。<br>61层。正是各种活动的入口。拿来一张价格表。好贵！那个蹦极要4000多澳元！只有一个太空漫步是三位数的。780澳元。(出门如果没兑换，到了景点一律是 1:1 汇率兑换，略亏)<br>囊中羞涩，最后，只玩了一个太空漫步。夕阳西下，233米高空跨出边沿往下看，还是有些怕。多看了几次之后，坐了一些动作。就坐在边沿上看往下探。深呼吸几次。终于不怕了。哈哈哈哈。蛮有趣！<br>中间有个插曲，是东西存放柜子时，发现只能用 30 港元，结果只能去兑换。刚兑换完，然后一个长的很清秀的妹子没带现金，正要找那些开发票的人沟通，说是票买了，但是没有现金无法开柜存包，结果开发票的给建议向我借点，然后转给我。我说我们直接用一个箱子放得了。我手机快没电了，向她借了充电宝。然后她就去蹦极去了！真会玩。胆儿也太肥了！<br>高空漫步结束后，坐上面又看了十几页《区块链原理、设计与应用》。等她跳完回来时，瞄了她一眼，很平静。那一刻，感觉那个妹子好漂亮啊。然后，就把箱子的东西还她。互相道谢之后，各自奔自己的行程去了。因为超时了，她要转账，我说当充电费了。然后，就没然后了。</p>\n<h2 id=\"珠海海洋王国一天-2018-06-17\"><a href=\"#珠海海洋王国一天-2018-06-17\" class=\"headerlink\" title=\"珠海海洋王国一天(2018-06-17)\"></a>珠海海洋王国一天(2018-06-17)</h2><p>在珠海休正，一大早就去深圳最大的两个公园山顶看了。感觉珠海是个宜居不宜游的城市，不知道是放假还是人口本来就少，感觉这里的压力，应该比深圳小很多。行人走路都那么悠闲。<br>坐公交往珠海最南端出发。那里是长隆。<br>坐过深圳的木质过山车，这里的过山车，全程没太大感觉。甚至失重感也不是那么强烈。可能和前一天的澳门高空漫步有点关系。<br>海豚和白鲸剧场表演，让人感叹，动物很奇妙。<br>各种海底生态中才有的动物，在这里看到了。最震惊的还是水母。追逐光ppppp的神奇动物。<br>我在想，为啥这里的馆能做到那么大，那些生态怎么维持？那么多海底动物在里面，怎么维持平衡？怎么喂食所有的动物呢？水的循环做的很好。水质很干净。<br>然后，今天还碰到了昨天和我存放一柜子背包的那个妹子。她和她男朋友一块儿也到这里游玩来了。太巧了。</p>\n<h2 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h2><p>旅途中，最重要的就是接触来自不同世界，说着不同语言的人。不少有着奇幻之旅的游客，不远万里，汇到一起，然后又散去。<br>然后，在路上，遇到妹子的概率比宅在家里，要高很多。<br>世界很大, 不可思议的事情，不同寻常的人很多，很多。<br>常出去走走。<br>应该像以前去西藏一样，将路上所有的所思所想都记录下来。很有意思。</p>\n","categories":[],"tags":["点滴"]},{"title":"最近","url":"http://chenyangguang.github.com/2018-06-05-stronger/","content":"<h2 id=\"变动\"><a href=\"#变动\" class=\"headerlink\" title=\"变动\"></a>变动</h2><p>过去半年，经历了不少新的东西。<br>遇到不少问题。不过都已经过去，都一一过去了。<br>这半年的工作遇到的问题，比去年加起来都多。主要是因为工作变动，原先从事 php 和 python 开发转到 golang 上面。然后是工作环境从 ubuntu 切到 windows 上。谁说开发工具不重要的，真的到一个团队里面去的时候，周围的工具链还是很影响效率的。</p>\n<h2 id=\"无题\"><a href=\"#无题\" class=\"headerlink\" title=\"无题\"></a>无题</h2><p>和 golang 相匹配的工具链一大坨，docker, elk, beego, k8s 都需要时间消化，然后自己还要对基础进行补课(数据结构和算法依然是短板)， 对于网络协议的理解还是粗浅， 对mysql, redis 的使用还不够深熟。这些还只是闲暇时间的事情。日常工作中又常是各种旧的系统留下的 bug, 排查日志，定位问题，运维修复。一边还得和别的部门打交道，交接沟通头痛的需求，“过堂”……</p>\n<h2 id=\"小成\"><a href=\"#小成\" class=\"headerlink\" title=\"小成\"></a>小成</h2><p>不过这半年过得还是蛮充实的。处理的问题多了，慢慢地也就心里有点数了。对于某些事情的轻重缓急有了划分，渐渐抽出时间实现一些认为更有价值的东西去。<br>而且每迈过一道坎，就信心更增加了一些。后面遇到问题，就不至于那么慌了。</p>\n<p>强者需要面对更多的困难。</p>\n","categories":[],"tags":["点滴"]},{"title":"ball-lightning","url":"http://chenyangguang.github.com/2018-05-20-ball-lightning/","content":"<h3 id=\"故事情节\"><a href=\"#故事情节\" class=\"headerlink\" title=\"故事情节\"></a>故事情节</h3><p>《球形闪电》是刘慈欣早年的科幻作品。以第一人称讲述了一个少年孩童时代，因一晚狂暴的雷雨之夜被球形闪电夺去父母性命的机缘下，从此迷上了球形闪电的科幻故事。</p>\n<h3 id=\"读感1\"><a href=\"#读感1\" class=\"headerlink\" title=\"读感1\"></a>读感1</h3><p>大学毕业之后已经很久没看过科幻小说了。现在看小说和以前有最大的不同就是快速浏览。不再像以前那样仔细咀嚼。而且都是不敢兴趣的章节往往直接跳过去。另外就是，会被中间的某些情景突然带到现实世界中，应该是”分神”。不是那种纯想象的情景。这或许是就是看到和接触到的现实的事物多了，想象力就慢慢的衰弱的感觉吧。一度还对个别场景下的描述觉得可疑，觉得那些不可能发生的。</p>\n<h3 id=\"读感２\"><a href=\"#读感２\" class=\"headerlink\" title=\"读感２\"></a>读感２</h3><p>可是，科幻小说真正的目标不就是联系现实，并且超越现实，思考和憧憬那些美好的未知事物吗？这些想象创造出那些过去和现在都不存在，在未来有可能存在的创造物和事件。比如古代的封神演义里面的千里眼，顺风耳等，现在都已经有了实际的对应事物。但是真正令我们着迷的永远是未知的事物, 比如黑洞，星际旅行。无论是宏观还是微观上的想象力，都是这个宇宙的美好。</p>\n<h3 id=\"收获共鸣\"><a href=\"#收获共鸣\" class=\"headerlink\" title=\"收获共鸣\"></a>收获共鸣</h3><p>我对其中的一句话特别有感触：“美妙人生的关键在于你能迷上什么”。这不就是我们一生在追求并为之努力的东西吗?</p>\n","categories":[],"tags":["读书"]},{"title":"从 ubuntu 到 arch","url":"http://chenyangguang.github.com/2018-05-19-arch/","content":"<h2 id=\"逃离-ubuntu-转投-arch\"><a href=\"#逃离-ubuntu-转投-arch\" class=\"headerlink\" title=\"逃离 ubuntu 转投 arch\"></a>逃离 ubuntu 转投 arch</h2><p>起因先是 ubuntu16.04 升级到 ubuntu18.04, 结果每次开机直接进入了一个grub的　shell 界面, 系统无法启动了。第二次装了ubuntu18.04, 然后后面装了不少开发软件，再升级时，又挂了！有点来气，花了两天时间重装系统。不过，这次是换成了 arch。为啥，因为 arch 官网上介绍说它的定制性更高（更需要折腾），而且是滚动更新(What are you 弄啥咧?)。</p>\n<h2 id=\"arch-系统的-u-盘安装\"><a href=\"#arch-系统的-u-盘安装\" class=\"headerlink\" title=\"arch 系统的 ｕ 盘安装\"></a>arch 系统的 ｕ 盘安装</h2><p>记录一下，头一天的时候，我的安装方式是按照知乎某个人的推荐装的，结果好几个地方卡死了。比如联网，比如挂载。后来证明，只要熟读 arch 官网　wiki 上面的文档(武功秘籍)，基本上是不会整出一些”奇门遁甲”的啥”幺蛾子”的。前提是，一定要通读。</p>\n<h2 id=\"切到-arch-的感受\"><a href=\"#切到-arch-的感受\" class=\"headerlink\" title=\"切到 arch 的感受\"></a>切到 arch 的感受</h2><ul>\n<li>速度比 ubuntu 快。天下武功，唯快不破。不知道是否因为 arch 的二进制包的安装方式，还是 安装的无关的依赖很少的缘故，在 arch 下面上网几乎不卡。即使看 youtube 视频也是非常流畅!</li>\n<li>安装效率高。arch 下面 <strong>sudo pacman -S smartgit</strong>, 需要安装的依赖，直接选数字然后回车就好了。安装好快。而 ubuntu 下面安装 smartgit 的需要好几个步骤，比如你安装了 smartgit包，好需要相同的命令去找缺失的依赖包(javaxxxxxx)。还得说下使用 “yaourt” 去安装 <strong>AUR</strong> 类型的软件真的是很便利。比如 安装个 <strong>nmap</strong> 扫描一下主机ip和端口:</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  blog git:(master) ✗ yaourt nmap</span><br><span class=\"line\">1 extra/nmap 7.70-2 [installed]</span><br><span class=\"line\">    Utility for network discovery and security auditing</span><br><span class=\"line\">2 community/vulscan 2.0-2</span><br><span class=\"line\">    A module which enhances nmap to a vulnerability scanner</span><br><span class=\"line\">3 blackarch/autonse 20.82a6e18-1 (blackarch blackarch-automation)</span><br><span class=\"line\">    Massive NSE (Nmap Scripting Engine) AutoSploit and AutoScanner.</span><br><span class=\"line\">4 blackarch/brutespray 116.bd65d69-2 (blackarch blackarch-automation blackarch-cracker)</span><br><span class=\"line\">...</span><br><span class=\"line\">32 aur/umit 1.0-1 (67) (0.20)</span><br><span class=\"line\">    A powerful nmap frontend.</span><br><span class=\"line\">==&gt; Enter n° of packages to be installed (e.g., 1 2 3 or 1-3)</span><br><span class=\"line\">==&gt; ---------------------------------------------------------</span><br><span class=\"line\">==&gt; (这里选数字然后回车就可以了)</span><br></pre></td></tr></table></figure>\n<ul>\n<li>几乎所有需要的比较新的软件和开发工具都有了。而且都是命令行三两下就安装好了。比如 docker, vim，emacs, docker, git, smartgit, nodejs, npm, nvm, python(系统自带了), php, nginx, apache, mysql, mariadb, postgresql， virtualbox, tmux, zsh(这个好像是自带了), shadowsocks(这个好极了,就下个package, 再命令行启动一下，浏览器加个 proxy 扩展就直接翻出去了!)等, 而且这些软件几乎都是主流中非常新的版本！这个比较和我心意。</li>\n</ul>\n<h2 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h2><ol>\n<li>通过 ubuntu 迁移到 arch 的过程，中间加深了对挂载，分区，以及搭建系统的很多命令的认知。</li>\n<li>选一个就近的源，比如清华的。</li>\n<li>没有什么是不能用一条命令解决不了的，如果不行就用两条! </li>\n<li>安装过程中，有犯错，比如一开始略过官方 wiki 直接参照网上某个人的推荐，东看一点，细看一点，结果这个装了一半，那个流程也是一半，都出现了一些一时令人懊恼的问题。还好最后回归官网 wiki 通读，针对具体的章节细读，才顺利解决了。</li>\n<li>安装 arch 一定要联网。最简单是直接通过命令行的 <code>wifi-menu</code> 调出无线 wifi　的列表，选择自己知道密码的那个 wifi, 然后输入密码。</li>\n<li>选一个图形界面桌面，比如 xfce, 安装。</li>\n<li>在联网的基础上，第一要务是先翻出去。道理不用多说。其他都是水到渠成了。</li>\n<li>从 arch 系统中 安装 blackarch 非常方便。blackarch 包含大概 1900 多个黑客武器! 强大而丰富的武器库！我去扒了一下，貌似 blackarch 还是 kali 系统的那个团队搞的!</li>\n<li>然后，能用命令行快速解决的，就不要多花时间去选个图标了。比如一开视频，发现，播放没有声音! 装个 alsamixer　即可, 命令行里面直接调起 alsamixer, 控制音量啥的，都在里面了。弄张图吧。<br><img src=\"/images/full.jpg\" alt=\"\"></li>\n</ol>\n","categories":[],"tags":["arch"]},{"title":"php 源码 (string)","url":"http://chenyangguang.github.com/2018-05-01-php-source-code-appreciation/","content":"<h1 id=\"PHP-源码赏析-第一套广播体操-string-篇\"><a href=\"#PHP-源码赏析-第一套广播体操-string-篇\" class=\"headerlink\" title=\"PHP 源码赏析 ~ 第一套广播体操(string 篇)\"></a>PHP 源码赏析 ~ 第一套广播体操(string 篇)</h1><h2 id=\"寻根究底\"><a href=\"#寻根究底\" class=\"headerlink\" title=\"寻根究底\"></a>寻根究底</h2><p>最近看到一些 php 的函数时，一直在想，它背后是怎么实现的呢？不仔细的挖一遍它的底细，压根就是经常会用错。而且感觉用的是一个黑箱子。指不定里面啥时候窜出一条蛇来。所以，找来源码，推敲一下底层的实现逻辑。<br><a id=\"more\"></a></p>\n<h2 id=\"第一节-伸展运动-strpos\"><a href=\"#第一节-伸展运动-strpos\" class=\"headerlink\" title=\"第一节: 伸展运动 strpos\"></a>第一节: 伸展运动 <a href=\"https://github.com/php/php-src/blob/master/ext/standard/string.c\" target=\"_blank\" rel=\"noopener\">strpos</a></h2><p>它的整个实现风貌先展现出来， 长的是貌美如花: </p>\n<h3 id=\"strpos-源码\"><a href=\"#strpos-源码\" class=\"headerlink\" title=\"strpos 源码\"></a>strpos 源码</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PHP_FUNCTION(strpos)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tzval *needle;</span><br><span class=\"line\">\tzend_string *haystack;</span><br><span class=\"line\">\tchar *found = NULL;</span><br><span class=\"line\">\tchar  needle_char[2];</span><br><span class=\"line\">\tzend_long  offset = 0;</span><br><span class=\"line\"></span><br><span class=\"line\">\tZEND_PARSE_PARAMETERS_START(2, 3)</span><br><span class=\"line\">\t\tZ_PARAM_STR(haystack)</span><br><span class=\"line\">\t\tZ_PARAM_ZVAL(needle)</span><br><span class=\"line\">\t\tZ_PARAM_OPTIONAL</span><br><span class=\"line\">\t\tZ_PARAM_LONG(offset)</span><br><span class=\"line\">\tZEND_PARSE_PARAMETERS_END();</span><br><span class=\"line\"></span><br><span class=\"line\">\tif (offset &lt; 0) &#123;</span><br><span class=\"line\">\t\toffset += (zend_long)ZSTR_LEN(haystack);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tif (offset &lt; 0 || (size_t)offset &gt; ZSTR_LEN(haystack)) &#123;</span><br><span class=\"line\">\t\tphp_error_docref(NULL, E_WARNING, &quot;Offset not contained in string&quot;);</span><br><span class=\"line\">\t\tRETURN_FALSE;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tif (Z_TYPE_P(needle) == IS_STRING) &#123;</span><br><span class=\"line\">\t\tif (!Z_STRLEN_P(needle)) &#123;</span><br><span class=\"line\">\t\t\tphp_error_docref(NULL, E_WARNING, &quot;Empty needle&quot;);</span><br><span class=\"line\">\t\t\tRETURN_FALSE;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tfound = (char*)php_memnstr(ZSTR_VAL(haystack) + offset,</span><br><span class=\"line\">\t\t\t                Z_STRVAL_P(needle),</span><br><span class=\"line\">\t\t\t                Z_STRLEN_P(needle),</span><br><span class=\"line\">\t\t\t                ZSTR_VAL(haystack) + ZSTR_LEN(haystack));</span><br><span class=\"line\">\t&#125; else &#123;</span><br><span class=\"line\">\t\tif (php_needle_char(needle, needle_char) != SUCCESS) &#123;</span><br><span class=\"line\">\t\t\tRETURN_FALSE;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\tneedle_char[1] = 0;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tfound = (char*)php_memnstr(ZSTR_VAL(haystack) + offset,</span><br><span class=\"line\">\t\t\t\t\t\t\tneedle_char,</span><br><span class=\"line\">\t\t\t\t\t\t\t1,</span><br><span class=\"line\">\t\t                    ZSTR_VAL(haystack) + ZSTR_LEN(haystack));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tif (found) &#123;</span><br><span class=\"line\">\t\tRETURN_LONG(found - ZSTR_VAL(haystack));</span><br><span class=\"line\">\t&#125; else &#123;</span><br><span class=\"line\">\t\tRETURN_FALSE;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"初探\"><a href=\"#初探\" class=\"headerlink\" title=\"初探\"></a>初探</h3><p>咋看，果然没有让我失望, 有点蒙: 这都啥啥啥? 第一眼只看懂了 if, else。 没系统的学习过 c 语言，阅读起来真的很费眼力劲, 呵呵。<br>那就先过一遍: </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zval *needle;</span><br><span class=\"line\">zend_string *haystack;</span><br><span class=\"line\">char *found = NULL;</span><br><span class=\"line\">char  needle_char[2];</span><br><span class=\"line\">zend_long  offset = 0;</span><br></pre></td></tr></table></figure>\n<p>这一堆，是定义了一些变量。</p>\n<p>然后<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ZEND_PARSE_PARAMETERS_START(2, 3)</span><br><span class=\"line\">\tZ_PARAM_STR(haystack)</span><br><span class=\"line\">\tZ_PARAM_ZVAL(needle)</span><br><span class=\"line\">\tZ_PARAM_OPTIONAL</span><br><span class=\"line\">\tZ_PARAM_LONG(offset)</span><br><span class=\"line\">ZEND_PARSE_PARAMETERS_END();</span><br></pre></td></tr></table></figure></p>\n<p>没看懂，应该是初始化参数, (2, 3)说明是这个 <strong>strpos</strong> 函数的参数在 2 - 3 个之间。</p>\n<p>接着，进行至第三个参数 offset 的判断了。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if (offset &lt; 0) &#123;</span><br><span class=\"line\">\toffset += (zend_long)ZSTR_LEN(haystack);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">if (offset &lt; 0 || (size_t)offset &gt; ZSTR_LEN(haystack)) &#123;</span><br><span class=\"line\">\tphp_error_docref(NULL, E_WARNING, &quot;Offset not contained in string&quot;);</span><br><span class=\"line\">\tRETURN_FALSE;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>猜测当第三个参数 offset 是负数的时候，是反向的查找的。如果负数太小了，比如反向查找 ‘test’ 中的 ‘s’ 来说， 就是 strpos(‘test’, ‘t’, -10), 就会报错了。 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜   php -r &quot;echo strpos(&apos;test&apos;, &apos;s&apos;, -10);&quot;</span><br><span class=\"line\">PHP Warning:  strpos(): Offset not contained in string in Command line code on line 1</span><br><span class=\"line\"></span><br><span class=\"line\">Warning: strpos(): Offset not contained in string in Command line code on line 1</span><br></pre></td></tr></table></figure>\n<p>果然。</p>\n<p>先不追究细节, 走着。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if (Z_TYPE_P(needle) == IS_STRING) &#123;</span><br><span class=\"line\">\tif (!Z_STRLEN_P(needle)) &#123;</span><br><span class=\"line\">\t\tphp_error_docref(NULL, E_WARNING, &quot;Empty needle&quot;);</span><br><span class=\"line\">\t\tRETURN_FALSE;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tfound = (char*)php_memnstr(ZSTR_VAL(haystack) + offset,</span><br><span class=\"line\">\t\t                Z_STRVAL_P(needle),</span><br><span class=\"line\">\t\t                Z_STRLEN_P(needle),</span><br><span class=\"line\">\t\t                ZSTR_VAL(haystack) + ZSTR_LEN(haystack));</span><br><span class=\"line\">&#125; else &#123;</span><br><span class=\"line\">\tif (php_needle_char(needle, needle_char) != SUCCESS) &#123;</span><br><span class=\"line\">\t\tRETURN_FALSE;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tneedle_char[1] = 0;</span><br><span class=\"line\"></span><br><span class=\"line\">\tfound = (char*)php_memnstr(ZSTR_VAL(haystack) + offset,</span><br><span class=\"line\">\t\t\t\t\t\tneedle_char,</span><br><span class=\"line\">\t\t\t\t\t\t1,</span><br><span class=\"line\">\t                    ZSTR_VAL(haystack) + ZSTR_LEN(haystack));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>一个 if(){} else{}, 哎呀，我滴亲娘啊，好像很简单啊，就判断一下要查找的参数 needle 是不是字符串类型, 然后如此如此, 最后返回一个 found。</p>\n<p>而 found 最核心的就是一个真正查找这个字符的位置的函数 <strong>php_memnstr</strong>, 这个函数的实体实际是 <strong>zend_memnstr</strong> 这个函数。</p>\n<p>继续追下去看看</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">static zend_always_inline const char *</span><br><span class=\"line\">zend_memnstr(const char *haystack, const char *needle, size_t needle_len, const char *end)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tconst char *p = haystack;</span><br><span class=\"line\">\tconst char ne = needle[needle_len-1];</span><br><span class=\"line\">\tptrdiff_t off_p; </span><br><span class=\"line\">\tsize_t off_s;</span><br><span class=\"line\"></span><br><span class=\"line\">\tif (needle_len == 1) &#123;</span><br><span class=\"line\">\t\treturn (const char *)memchr(p, *needle, (end-p));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\toff_p = end - haystack;</span><br><span class=\"line\">\toff_s = (off_p &gt; 0) ? (size_t)off_p : 0;</span><br><span class=\"line\"></span><br><span class=\"line\">\tif (needle_len &gt; off_s) &#123;</span><br><span class=\"line\">\t\treturn NULL;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tif (EXPECTED(off_s &lt; 1024 || needle_len &lt; 9)) &#123;\t/* glibc memchr is faster when needle is too short */</span><br><span class=\"line\">\t\tend -= needle_len;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\twhile (p &lt;= end) &#123;</span><br><span class=\"line\">\t\t\tif ((p = (const char *)memchr(p, *needle, (end-p+1))) &amp;&amp; ne == p[needle_len-1]) &#123;</span><br><span class=\"line\">\t\t\t\tif (!memcmp(needle, p, needle_len-1)) &#123;</span><br><span class=\"line\">\t\t\t\t\treturn p;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\tif (p == NULL) &#123;</span><br><span class=\"line\">\t\t\t\treturn NULL;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\tp++;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\treturn NULL;</span><br><span class=\"line\">\t&#125; else &#123;</span><br><span class=\"line\">\t\treturn zend_memnstr_ex(haystack, needle, needle_len, end);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>这里 zend_memnstr() , 接收四个传进来的参数。 这里可以看到， 当判断出查找的字符串很短，查找的区间也很短时，(为啥是off_s &lt; 1024 或者 needle_len &lt; 9 这两个阀值， 不得而知) 调用的是 glibc 库，这个库是 linux 最底层的 api, 否则就跑去调用 <strong>zend_operators.h</strong> 文件下面的 <strong>ZEND_FASTCALL</strong> 类型的 <strong>zend_memnstr_ex</strong>, 注释里说 glibc 更快。</p>\n<p>ptrdiff_t  这个其实是一个 zend_long 在/intl/collator/collator_sort.c文件下面有这个定义。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#if !defined(HAVE_PTRDIFF_T) &amp;&amp; !defined(_PTRDIFF_T_DEFINED)</span><br><span class=\"line\">typedef zend_long ptrdiff_t;</span><br><span class=\"line\">#endif</span><br></pre></td></tr></table></figure>\n<p>又跳去搞事情了</p>\n<p>/ext/standard/file.c</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#define FPUTCSV_FLD_CHK(c) memchr(ZSTR_VAL(field_str), c, ZSTR_LEN(field_str))</span><br></pre></td></tr></table></figure>\n<p>其他看不太明白。</p>\n<p>在非字符串类型搜索分支判断里面，还进行了详细的判断。总之: 要搜索的字符应该是字符串或者数值类型。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">static int php_needle_char(zval *needle, char *target)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tswitch (Z_TYPE_P(needle)) &#123;</span><br><span class=\"line\">\t\tcase IS_LONG:</span><br><span class=\"line\">\t\t\t*target = (char)Z_LVAL_P(needle);</span><br><span class=\"line\">\t\t\treturn SUCCESS;</span><br><span class=\"line\">\t\tcase IS_NULL:</span><br><span class=\"line\">\t\tcase IS_FALSE:</span><br><span class=\"line\">\t\t\t*target = &apos;\\0&apos;;</span><br><span class=\"line\">\t\t\treturn SUCCESS;</span><br><span class=\"line\">\t\tcase IS_TRUE:</span><br><span class=\"line\">\t\t\t*target = &apos;\\1&apos;;</span><br><span class=\"line\">\t\t\treturn SUCCESS;</span><br><span class=\"line\">\t\tcase IS_DOUBLE:</span><br><span class=\"line\">\t\t\t*target = (char)(int)Z_DVAL_P(needle);</span><br><span class=\"line\">\t\t\treturn SUCCESS;</span><br><span class=\"line\">\t\tcase IS_OBJECT:</span><br><span class=\"line\">\t\t\t*target = (char) zval_get_long(needle);</span><br><span class=\"line\">\t\t\treturn SUCCESS;</span><br><span class=\"line\">\t\tdefault:</span><br><span class=\"line\">\t\t\tphp_error_docref(NULL, E_WARNING, &quot;needle is not a string or an integer&quot;);</span><br><span class=\"line\">\t\t\treturn FAILURE;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>然后就看到世界的尽头： </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if (found) &#123;</span><br><span class=\"line\">\tRETURN_LONG(found - ZSTR_VAL(haystack));</span><br><span class=\"line\">&#125; else &#123;</span><br><span class=\"line\">\tRETURN_FALSE;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>找到了, 就返回一个位置，没找到就返回 FALSE 了。<br>伸展运动就做完了。<br>现在回过头来看，好像没那么简单。好多个宏不知道是干啥用的， 还有几个方法。</p>\n<h3 id=\"细究\"><a href=\"#细究\" class=\"headerlink\" title=\"细究\"></a>细究</h3><p>第一个需要搞明白的是 ZSTR_LEN(haystack) 这个宏是干啥用的。  在 zend_string.h 中找到了它的定义： </p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ZSTR_VAL(zstr)  (zstr)-&gt;val</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ZSTR_LEN(zstr)  (zstr)-&gt;len</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ZSTR_H(zstr)    (zstr)-&gt;h</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ZSTR_HASH(zstr) zend_string_hash_val(zstr)</span></span><br></pre></td></tr></table></figure>\n<p>这个解释在一篇 PHP 字符扩展的<a href=\"https://juejin.im/entry/583e8f36ac502e006c3605ee\" target=\"_blank\" rel=\"noopener\">文章</a>里面有写道：<br>“ <strong>ZSTR_</strong> 开头的宏方法是 <strong>zend_string</strong> 结构专属的方法 <strong>ZSTR_VAL</strong>, <strong>ZSTR_LEN</strong>, <strong>ZSTR_H</strong> 宏方法分别对应 <strong> zend_string</strong> 结构的成员。<br><strong>ZSTR_HASH</strong> 是获取字符串的hash值，如果不存在，就调用 hash 函数生成一个”。</p>\n<h2 id=\"strpos-的实现思路\"><a href=\"#strpos-的实现思路\" class=\"headerlink\" title=\"strpos 的实现思路\"></a>strpos 的实现思路</h2><h2 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h2><p>头疼</p>\n<h2 id=\"有木有启发\"><a href=\"#有木有启发\" class=\"headerlink\" title=\"有木有启发?\"></a>有木有启发?</h2><p>木有，感觉 底层写的很难懂。因为中间总是卡住。各种宏定义, 各种指针子子孙孙无穷尽也。</p>\n<!--more-->\n","categories":[],"tags":["php"]},{"title":"源码","url":"http://chenyangguang.github.com/2018-05-01-tools/","content":"<h2 id=\"源码看累了\"><a href=\"#源码看累了\" class=\"headerlink\" title=\"源码看累了\"></a>源码看累了</h2><p>源码看着看着，会产生一种疑惑： 我为什么要看源码？当初我之所以到底层看源码，完全是好奇，想知道它后面运行的机制。但是，最近开始疲劳了。忽然觉得：这样是不是没什么必要？因为，一个好的赛车手，未必就能造车，或者修车。但他可以将车玩的很溜, 上演速度与激情！而一个造车师傅，或者修车师傅，却不一定能在 F1 赛道上撒的开。<br>那么，如果满足了好奇心之后，还有必要去深究底层的实现逻辑么？</p>\n","categories":[],"tags":["php"]},{"title":"php 源码 (宏)","url":"http://chenyangguang.github.com/2018-05-01-php-source-code-basic-string/","content":"<h2 id=\"zend-基础类型-宏\"><a href=\"#zend-基础类型-宏\" class=\"headerlink\" title=\"zend 基础类型- 宏\"></a>zend 基础类型- 宏</h2><p>zend 底层有相当多的宏, 特别是 php7 系列, 源码比 php 5 有不少结构方面的改变。所以不去研究 php5 的 zend 了, 直接往后研究的源码都主要看最新的 <strong>php-src</strong>。 zend 系列的宏主要分布在 zend_API.h, zend_types.h, zend_operators.h 里面。<br><a id=\"more\"></a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">typedef struct _zend_object_handlers zend_object_handlers;</span><br><span class=\"line\">typedef struct _zend_class_entry     zend_class_entry;</span><br><span class=\"line\">typedef union  _zend_function        zend_function;</span><br><span class=\"line\">typedef struct _zend_execute_data    zend_execute_data;</span><br><span class=\"line\"></span><br><span class=\"line\">typedef struct _zval_struct     zval;</span><br><span class=\"line\"></span><br><span class=\"line\">typedef struct _zend_refcounted zend_refcounted;</span><br><span class=\"line\">typedef struct _zend_string     zend_string;</span><br><span class=\"line\">typedef struct _zend_array      zend_array;</span><br><span class=\"line\">typedef struct _zend_object     zend_object;</span><br><span class=\"line\">typedef struct _zend_resource   zend_resource;</span><br><span class=\"line\">typedef struct _zend_reference  zend_reference;</span><br><span class=\"line\">typedef struct _zend_ast_ref    zend_ast_ref;</span><br><span class=\"line\">typedef struct _zend_ast        zend_ast;</span><br></pre></td></tr></table></figure>\n<p>放眼望去，似曾相识燕归来！ </p>\n<h3 id=\"zval\"><a href=\"#zval\" class=\"headerlink\" title=\"zval\"></a>zval</h3><p>zval 不就是大名鼎鼎的 php 变量容器么！源码内使用频率相当高。一搜 php-src，超过 9999 次现身!<br>可想而知， zval 肯定是灰常重要的。<br>解开这个结构体，发现是这个模样:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">struct _zval_struct &#123;</span><br><span class=\"line\">\tzend_value        value;\t\t\t/* value */</span><br><span class=\"line\">\tunion &#123;</span><br><span class=\"line\">\t\tstruct &#123;</span><br><span class=\"line\">\t\t\tZEND_ENDIAN_LOHI_4(</span><br><span class=\"line\">\t\t\t\tzend_uchar    type,\t\t\t/* active type */</span><br><span class=\"line\">\t\t\t\tzend_uchar    type_flags,</span><br><span class=\"line\">\t\t\t\tzend_uchar    const_flags,</span><br><span class=\"line\">\t\t\t\tzend_uchar    reserved)\t    /* call info for EX(This) */</span><br><span class=\"line\">\t\t&#125; v;</span><br><span class=\"line\">\t\tuint32_t type_info;</span><br><span class=\"line\">\t&#125; u1;</span><br><span class=\"line\">\tunion &#123;</span><br><span class=\"line\">\t\tuint32_t     next;                 /* hash collision chain */</span><br><span class=\"line\">\t\tuint32_t     cache_slot;           /* literal cache slot */</span><br><span class=\"line\">\t\tuint32_t     lineno;               /* line number (for ast nodes) */</span><br><span class=\"line\">\t\tuint32_t     num_args;             /* arguments number for EX(This) */</span><br><span class=\"line\">\t\tuint32_t     fe_pos;               /* foreach position */</span><br><span class=\"line\">\t\tuint32_t     fe_iter_idx;          /* foreach iterator index */</span><br><span class=\"line\">\t\tuint32_t     access_flags;         /* class constant access flags */</span><br><span class=\"line\">\t\tuint32_t     property_guard;       /* single property guard */</span><br><span class=\"line\">\t\tuint32_t     extra;                /* not further specified */</span><br><span class=\"line\">\t&#125; u2;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>分为三个部分， zend_value, u1, u2 三个联合体。<br>跟踪 zend_value 看看, </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">typedef union _zend_value &#123;</span><br><span class=\"line\">\tzend_long         lval;\t\t\t\t/* long value */</span><br><span class=\"line\">\tdouble            dval;\t\t\t\t/* double value */</span><br><span class=\"line\">\tzend_refcounted  *counted;</span><br><span class=\"line\">\tzend_string      *str;</span><br><span class=\"line\">\tzend_array       *arr;</span><br><span class=\"line\">\tzend_object      *obj;</span><br><span class=\"line\">\tzend_resource    *res;</span><br><span class=\"line\">\tzend_reference   *ref;</span><br><span class=\"line\">\tzend_ast_ref     *ast;</span><br><span class=\"line\">\tzval             *zv;</span><br><span class=\"line\">\tvoid             *ptr;</span><br><span class=\"line\">\tzend_class_entry *ce;</span><br><span class=\"line\">\tzend_function    *func;</span><br><span class=\"line\">\tstruct &#123;</span><br><span class=\"line\">\t\tuint32_t w1;</span><br><span class=\"line\">\t\tuint32_t w2;</span><br><span class=\"line\">\t&#125; ww;</span><br><span class=\"line\">&#125; zend_value;</span><br></pre></td></tr></table></figure>\n<p>跋山涉水， zend_value 这个联合体可以存放所有可能的 php 数据类型数据。 数值分: 长整型或者双精度浮点型。 剩下的基本是指针值。有计数器指针，字符串指针，数组指针，对象指针，资源指针，引用指针, 空指针， 类指针，函数指针。 </p>\n<p>而 u1 里面又是啥东东？ ZEND_ENDIAN_LOHI_4()这个东西, </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#ifdef WORDS_BIGENDIAN</span><br><span class=\"line\"># define ZEND_ENDIAN_LOHI(lo, hi)          hi; lo;</span><br><span class=\"line\"># define ZEND_ENDIAN_LOHI_3(lo, mi, hi)    hi; mi; lo;</span><br><span class=\"line\"># define ZEND_ENDIAN_LOHI_4(a, b, c, d)    d; c; b; a;</span><br><span class=\"line\"># define ZEND_ENDIAN_LOHI_C(lo, hi)        hi, lo</span><br><span class=\"line\"># define ZEND_ENDIAN_LOHI_C_3(lo, mi, hi)  hi, mi, lo,</span><br><span class=\"line\"># define ZEND_ENDIAN_LOHI_C_4(a, b, c, d)  d, c, b, a</span><br><span class=\"line\">#else</span><br><span class=\"line\"># define ZEND_ENDIAN_LOHI(lo, hi)          lo; hi;</span><br><span class=\"line\"># define ZEND_ENDIAN_LOHI_3(lo, mi, hi)    lo; mi; hi;</span><br><span class=\"line\"># define ZEND_ENDIAN_LOHI_4(a, b, c, d)    a; b; c; d;</span><br><span class=\"line\"># define ZEND_ENDIAN_LOHI_C(lo, hi)        lo, hi</span><br><span class=\"line\"># define ZEND_ENDIAN_LOHI_C_3(lo, mi, hi)  lo, mi, hi,</span><br><span class=\"line\"># define ZEND_ENDIAN_LOHI_C_4(a, b, c, d)  a, b, c, d</span><br><span class=\"line\">#endif</span><br></pre></td></tr></table></figure>\n<p>这些 哆瑞咪发嗦啦奇多, 暂时不知道做什么。不过 type, type_flags, const_flags, reserved 按照字面意思应该包含激活的类型，类型标志，常量标记，保留值。所以 u1 其实是存的类型相关的信息值。</p>\n<p>u2 里面是存放一个额外的数据, 有介绍说是一般情况下用不到？这个<a href=\"http://nikic.github.io/\" target=\"_blank\" rel=\"noopener\">博客</a>说的。</p>\n<p>这里面有几个疑问仍未确定: </p>\n<ol>\n<li>zend_ast_ref 是类型数据？ </li>\n<li>又有一个 zval! 这个是为什么？ 这个效果是不是这样： 我这个值里面还可以放任何类型的数据！php 就是这样实现存放数据的么？</li>\n<li>php 官方文档给出的是基本类型是 Boolean 布尔类型， Integer整型，Float 浮点型，String 字符串，Array 数组，Object 对象，Resource 资源类型，NULL, CallBack/Callable类型。</li>\n<li>ww 这个结构体是干啥用的？莫非是存放 CallBack/Callable 类型的数据？</li>\n</ol>\n<h2 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h2><p>PHP 底层没有看起来的那么简单。有些构造可能是巧妙的，但是目前还领会不到。</p>\n<!--more-->\n","categories":[],"tags":["php"]},{"title":"lua","url":"http://chenyangguang.github.com/2018-04-26-lua-lumen/","content":"<h2 id=\"Lua-入门\"><a href=\"#Lua-入门\" class=\"headerlink\" title=\"Lua 入门\"></a>Lua 入门</h2><p>最近想系统花几天时间学习 Lua 是因为在看 《redis 实战》的过程中发现 Lua 可与 redis 匹配产生叠加性能。nginx+Lua+redis 的联姻又可以再次增强 redis 的功力。</p>\n<h3 id=\"教程\"><a href=\"#教程\" class=\"headerlink\" title=\"教程\"></a>教程</h3><p>  Lua 是用标准 C 语言编写的强大的、开源、轻量级、嵌入式的脚本语言。提供面向过程, 面向对象, 面向函数式, 数据驱动的编程方式。</p>\n<h3 id=\"设计目的\"><a href=\"#设计目的\" class=\"headerlink\" title=\"设计目的\"></a>设计目的</h3><p>  嵌入到应用程序中, 为应用程序提供灵活的扩展和定制功能。</p>\n<h3 id=\"特性\"><a href=\"#特性\" class=\"headerlink\" title=\"特性\"></a>特性</h3><ul>\n<li>轻量级: 使用标准 C 语言编写并以源码形式开放, 编译后只有 100 多k, 非常便于嵌入到别的程序中。</li>\n<li>可扩展: Lua 提供了非常易于使用的扩展接口和机制: 由宿主(通常是 C 或 C++)提供这些功能， 使用起来就像内置的功能一般。</li>\n<li>其他特性: 自动内存管理; 提供了一种通用的类型的表(<strong>table</strong>), 用来实现数组, 哈希表, 集合, 对象; 语言内置模式匹配; 闭包(<strong>closure</strong>); 函数也可以看作一个值; 提供多线程等。</li>\n</ul>\n<h3 id=\"应用场景\"><a href=\"#应用场景\" class=\"headerlink\" title=\"应用场景\"></a>应用场景</h3><ul>\n<li>游戏开发</li>\n<li>独立应用脚本</li>\n<li>Web 应用脚本</li>\n<li>扩展和数据库插件: MySQL Proxy 和 MySQL WorkBench</li>\n<li>安全系统, 如入侵检测系统</li>\n</ul>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> ~</span><br><span class=\"line\">curl -R -O http://www.lua.org/ftp/lua-5.3.0.tar.gz</span><br><span class=\"line\">tar zxf lua-5.3.0.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> lua-5.3.0</span><br><span class=\"line\">make linux <span class=\"built_in\">test</span></span><br><span class=\"line\">make install</span><br></pre></td></tr></table></figure>\n<h3 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  ~ lua -i</span><br><span class=\"line\">Lua 5.2.3  Copyright (C) 1994-2013 Lua.org, PUC-Rio</span><br><span class=\"line\">&gt; <span class=\"built_in\">print</span>(<span class=\"string\">\"Hello Lua!\"</span>)</span><br><span class=\"line\">Hello Lua!</span><br><span class=\"line\">&gt;</span><br></pre></td></tr></table></figure>\n<p>并没有诸如 <strong>exit</strong> 的命令退出! 直接 Ctrl + c, 呵。</p>\n<h3 id=\"First-Blood-Demo\"><a href=\"#First-Blood-Demo\" class=\"headerlink\" title=\"First Blood Demo !\"></a>First Blood Demo !</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜ touch first-blood.lua</span><br><span class=\"line\">➜ lua <span class=\"built_in\">echo</span> <span class=\"string\">'print(\"hello world lua!\")'</span> &gt; first-blood.lua</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"built_in\">print</span>(<span class=\"string\">\"hello world lua\"</span>) &gt; first-blood.lua</span><br><span class=\"line\">➜  lua lua first-blood.lua </span><br><span class=\"line\">hello world lua!</span><br></pre></td></tr></table></figure>\n<h3 id=\"两种注释方式\"><a href=\"#两种注释方式\" class=\"headerlink\" title=\"两种注释方式\"></a>两种注释方式</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-- single line commentary <span class=\"keyword\">for</span> lua</span><br><span class=\"line\">--[[</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">'multiple'</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">'commentary'</span>)</span><br><span class=\"line\">]]--</span><br></pre></td></tr></table></figure>\n<h3 id=\"八种数据类型\"><a href=\"#八种数据类型\" class=\"headerlink\" title=\"八种数据类型\"></a>八种数据类型</h3><ul>\n<li>nil </li>\n<li>boolean</li>\n<li>number, 双精度类型浮点实数</li>\n<li>string </li>\n<li>userdata, 表示任意存储在变量中的 C 数据结构</li>\n<li>function, 由C 或者 Lua 写的函数</li>\n<li>thread, 表示执行的独立线路, 用于执行协同程序</li>\n<li>table, Lua 中的表(table), 其实是个<strong>关联数组</strong>(associative arrays), 数组的索引可以是数字或者字符串。使用<strong>{}</strong>来构造创建。</li>\n</ul>\n<h3 id=\"基本\"><a href=\"#基本\" class=\"headerlink\" title=\"基本\"></a>基本</h3><ul>\n<li><strong>数字</strong>, <strong>字母</strong> 和 <strong>下划线</strong> 构成合法变量, <strong>区分大小写</strong>。</li>\n<li>默认变量都是全局的, 使用 <strong>local</strong> 显示声明局部变量。使用前无需声明，默认值是 <strong>nil</strong>, 删除一个变量直接将该变量值致 <strong>nil</strong> 即可。</li>\n<li>字符串连接使用 <strong>..</strong> 。</li>\n<li><strong>#</strong> 计算字符串长度。</li>\n<li>索引从 <strong>1</strong> 开始!</li>\n<li><strong>table</strong> 长度不固定, 添加新数据时长度自动增长。未初始化值为 <strong>nil</strong>。</li>\n<li><strong>线程</strong> VS <strong>协程</strong>: 线程可以同时运行多个，协程任意时刻只能运行一个，并且出于运行状态的协程只有被挂起(<strong>suspend</strong>)时才会暂停。</li>\n<li>table 的索引可以使用<strong>[i]</strong>或者 <strong>.</strong> 操作, 如: table1[“fix”], table.fix。</li>\n<li><strong>^</strong> 和 <strong>..</strong> 是右连接, 其他运算符是左连。</li>\n</ul>\n<h3 id=\"循环控制\"><a href=\"#循环控制\" class=\"headerlink\" title=\"循环控制\"></a>循环控制</h3><ul>\n<li>for 循环</li>\n<li>while</li>\n<li>repeat … until</li>\n<li>break, 跳出当前循环语句, 并执行脚本紧接着的语句。</li>\n</ul>\n<h3 id=\"函数\"><a href=\"#函数\" class=\"headerlink\" title=\"函数\"></a>函数</h3><ul>\n<li>Lua 函数可以 <strong>return</strong> 多个结果值。</li>\n<li>Lua 函数可以在参数列表中使用 <strong>…</strong> 作为可变参数。</li>\n<li>函数可以作为参数传递给函数, 有点像 <strong>Lisp</strong> 里面的。</li>\n</ul>\n<h3 id=\"运算\"><a href=\"#运算\" class=\"headerlink\" title=\"运算\"></a>运算</h3><ul>\n<li>加减乘除求余之外, 特殊的运算符号 <strong>^</strong> 乘幂;</li>\n<li>关系运算符号中 <strong>~=</strong> 表示不等于; </li>\n<li>逻辑运算符号三板斧: and, or , not;</li>\n<li><strong>..</strong> 号连接, <strong>#</strong> 一元运算符, 返回字符串或表的长度(pirnt(#’abc’))。</li>\n<li><p>运算符优先级排行榜:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^</span><br><span class=\"line\">not - (unary)</span><br><span class=\"line\">* /</span><br><span class=\"line\">+ -</span><br><span class=\"line\">..</span><br><span class=\"line\">&lt; &gt; &lt;= &gt;= ~= ==</span><br><span class=\"line\">and </span><br><span class=\"line\">or</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"参考来源\"><a href=\"#参考来源\" class=\"headerlink\" title=\"参考来源\"></a>参考来源</h2><ul>\n<li><a href=\"https://www.Lua.org/\" target=\"_blank\" rel=\"noopener\">Lua官网</a></li>\n<li><a href=\"http://www.runoob.com/Lua/Lua-tutorial.html\" target=\"_blank\" rel=\"noopener\">Lua 基本入门网上教程</a></li>\n<li><a href=\"https://github.com/lua/lua\" target=\"_blank\" rel=\"noopener\">github 源码</a></li>\n<li><a href=\"http://lua-users.org/wiki/\" target=\"_blank\" rel=\"noopener\">Lua wiki tools</a></li>\n</ul>\n","categories":[],"tags":["lua"]},{"title":"update ubuntu16.04 to ubuntu18.04","url":"http://chenyangguang.github.com/2018-04-24-update-ubuntu2LTS18.04/","content":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get upgrade</span><br><span class=\"line\">sudo apt-get install update-manager-core</span><br><span class=\"line\">sudo do-release-upgrade -d --devel-release</span><br></pre></td></tr></table></figure>\n","categories":[],"tags":["点滴"]},{"title":"Golang way","url":"http://chenyangguang.github.com/2018-03-01-TheWayToGoLang/","content":"<h1 id=\"Go-入门\"><a href=\"#Go-入门\" class=\"headerlink\" title=\"Go 入门\"></a>Go 入门</h1><p>  一直听说 Go 是天生支持并发编程的, 于是磨刀霍霍向牛羊, 入坑。</p>\n<h3 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h3><h4 id=\"特点\"><a href=\"#特点\" class=\"headerlink\" title=\"特点\"></a>特点</h4><ul>\n<li>Go 语言可以进行隐式定义, 但是不存在隐式类型转换。</li>\n<li>所有的内存在 Go 中都经过初始化的。</li>\n<li>变量的命名使用陀峰法，首个单词小写，每个新单词首字母大写。如果需要全局变量能够被外包所使用， 则首字母也需要大写。</li>\n</ul>\n<h4 id=\"基本类型和运算符\"><a href=\"#基本类型和运算符\" class=\"headerlink\" title=\"基本类型和运算符\"></a>基本类型和运算符</h4><ul>\n<li>两个类型相同的值可以使用 <strong>==</strong> 或者 <strong>!=</strong> 来比较。不同类型的值不可以比较。</li>\n<li>Go 支持 整形和浮点型数字, 并且原生支持复数, 其中位的运算采用补码。int 是最快的类型, 尽量使用 float64。</li>\n<li><ul>\n<li>号和指针名称间留有一个空格，以防止被误认为是乘法表达式。 <em> 用在一个指针前面时，将得到这个指针指向地址所存储的值；这就是反引用(间接引用)操作符, 也可以称为指针转移。指针的高级应用是可以传递一个变量的应用(如函数的参数), 如此不会传递变量的拷贝。注意: 在 Go 中不允许像 C 中的 </em>pointer++ 的指针算法。</li>\n</ul>\n</li>\n<li>特殊的流程控制, <strong>select</strong> 结构用于 <strong>channel</strong> 的选择。可省掉判断条件里面的小括号。必要时使用小括号提高优先级。 <strong>switch</strong> 可以接受的 <strong>case</strong> 判断可以是统一类型的任何类型的值或者表达式。而 <strong>for</strong> 可以在循环体内同时使用多个计数器。</li>\n</ul>\n<h4 id=\"精华的-goroutine-和-channel\"><a href=\"#精华的-goroutine-和-channel\" class=\"headerlink\" title=\"精华的 goroutine 和  channel\"></a>精华的 goroutine 和  channel</h4><p><strong>goroutine</strong> 是 Go 程序并发的执行体, <strong>channel</strong> 是它们之间的连接, 是可以让一个 goroutine 发送特征值到另一个 goroutine 的通信机制．没一个 channel 是一个具体类型的导管，叫做通道的元素类型．channel 的创建使用 make. channel 有两个操作, send, receive 统称通信．使用上古神奇的符号 <strong>&lt;-</strong>．close(ch) 关闭　channel, make()可以创建两种通道, 带正数的第二个参数的是缓冲通道，其他的是非缓冲通道.</p>\n<h2 id=\"参考来源\"><a href=\"#参考来源\" class=\"headerlink\" title=\"参考来源\"></a>参考来源</h2><ul>\n<li><a href=\"https://github.com/Unknwon/the-way-to-go_ZH_CN\" target=\"_blank\" rel=\"noopener\">Go之路</a></li>\n<li><a href=\"https://golang.org/\" target=\"_blank\" rel=\"noopener\">Go官网</a></li>\n</ul>\n","categories":[],"tags":["go"]},{"title":"过去的 2017","url":"http://chenyangguang.github.com/2018-01-14-theEndOf2017/","content":"<h2 id=\"2017年小结\"><a href=\"#2017年小结\" class=\"headerlink\" title=\"2017年小结\"></a>2017年小结</h2><p>之前元旦前的一天本来想做个小结的，后来因为工作变动，加上适应新的环境，就拖了一阵．<br><a id=\"more\"></a></p>\n<h2 id=\"时间花销\"><a href=\"#时间花销\" class=\"headerlink\" title=\"时间花销\"></a>时间花销</h2><p>2017 年在上班工作区间的时间利用有所提升，特别是有半年的时间基本上都是围绕在上午, 集中精力将当天的主要编码任务完成．从上半年的一到公司优先刷知乎，刷 News 有了一些习惯上面的转变．所以加班很少，有了更多的时间上研究自己感兴趣的东西, 这也为目前所从事的工作打下了一个基础．</p>\n<p>但是, 从上下班路上的时间，以及周末等非上班时间的利用. 并不充分．特别是可以到墙外，所以经常看 Youtube 上的视频, 看了不少电影，连续剧，课程，音乐, 还有个别综艺节目. 整个 2017 年下来，英语听力,阅读水平有所提升，口语 0 提升.</p>\n<p>Emacs 中的 Org-mode 工作日志基本上只看到了工作场合下的时间分布，而且极其粗略．事情轻重缓急层次偶尔还没有归档．</p>\n<h2 id=\"目标完成情况\"><a href=\"#目标完成情况\" class=\"headerlink\" title=\"目标完成情况\"></a>目标完成情况</h2><ul>\n<li>DONE [#A]游泳卡一共充了两次 500 RMB 全部用光了．</li>\n<li>DONE [#B]个人博客完成一次重组(hero 静态化).</li>\n<li>DONE [#A]&lt;&lt;设计模式之禅&gt;&gt;使用 php 重构一边.</li>\n<li>IN_PROGRESS [#A]学习 docker, 拥有属于自已习惯的一套系统和开发环境</li>\n<li>IN_PROGRESS [#A]啃完一边算法导论(包含做习题)</li>\n<li>IN_PROGRESS [#B]听懂一般的音乐表达的方式《如何听懂音乐》</li>\n<li>In_progress [#B]学会六孔陶笛, 后半年12孔陶笛能正确自如的演奏自己喜欢的调子</li>\n<li>DONE [#A]学习一门新语言并使用到开发过程中来(Golang | Nodejs)(最后选择了 Golang)。</li>\n<li>TODO [#B]参加一项深圳的全程马拉松, 时间在5小时30分以内</li>\n<li>DONE [#B]学习 vue 前端框架</li>\n<li>TODO [#B]使用自己总结的股票数据去买入股票，盈利在5%以上</li>\n<li>IN_PROGRESS [#A]读十本豆瓣排名前十的书籍</li>\n<li>Question</li>\n</ul>\n<p>问题其实蛮多的,比如:</p>\n<p>做好的规划，执行不充分，<br>专业上的投入专注度续航能力欠佳,<br>偷懒或者被其他事情转移了注意力.<br>平时有点子的时刻也挺多的，特别是在车上，偶尔冒出一些新的构思，或者创想, 或者是改变生活现状的火花, 只是需要作出决定的时刻没有足够的决绝!甚至有一点拖! 还有多次，想的和做的不一致! 知行不一!这就像军队没有统一的意志,所以这一年出来的效果，不过是”呵呵”二字． 这个毛病，在短时间之内，尚需徐徐图之. 否则， 2018 年里，还是受制肘.</p>\n<h2 id=\"关于早起\"><a href=\"#关于早起\" class=\"headerlink\" title=\"关于早起\"></a>关于早起</h2><p>2017 年里，除了感冒期间, 过年, 以及和朋友聚会喝了一点小酒，第二天起来会稍晚一点. 这些情况加起来，差不多有10天左右是晚于８点半起来的，有差不多 340 天基本是 5:50~7:30 时间区间起来的, 终于弄了个习惯! 可以继续保持下去，早起，能保证一天的精气神!</p>\n<h2 id=\"目标\"><a href=\"#目标\" class=\"headerlink\" title=\"目标\"></a>目标</h2><p>暂时留着 Org-mode 里面吧．留点悬念，2019 年元旦再总结. 不过, 2018 年的首要目标是还清 2017 年欠下的技术债．</p>\n<h2 id=\"2018-的一个展望\"><a href=\"#2018-的一个展望\" class=\"headerlink\" title=\"2018 的一个展望\"></a>2018 的一个展望</h2><p>希望今年能遇到一个心仪的姑娘!</p>\n<!--more-->\n","categories":[],"tags":["点滴"]},{"title":"备忘录模式","url":"http://chenyangguang.github.com/2017-12-01-mementoPattern/","content":"<h1 id=\"0x00-备忘录模式\"><a href=\"#0x00-备忘录模式\" class=\"headerlink\" title=\"0x00 备忘录模式\"></a>0x00 备忘录模式</h1><h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><p><strong>Without violating encapsulation, capture and externalize an object’s internal state so that the object can be restored to this state later.(在不破坏封装性的前提下，捕获一个对象的内部状态，并在这个对象外保存该状态．之后可将该对象恢复到之前保存的状态．)</strong></p>\n<a id=\"more\"></a>\n<h2 id=\"角色\"><a href=\"#角色\" class=\"headerlink\" title=\"角色\"></a>角色</h2><ul>\n<li>Originator 发起人角色, 记录当前时刻的内部状态，负责定义哪些属于备份范围的状态，负责创建和恢复备忘录数据．</li>\n<li>Memento 备忘录角色, 负责存储　Originator 发起人对象的内部状态，在需要的时候提供发起人需要的内部状态．</li>\n<li>Caretaker 备忘录管理员角色, 对备忘录进行管理，保存和提供备忘录.</li>\n</ul>\n<h2 id=\"php-实例\"><a href=\"#php-实例\" class=\"headerlink\" title=\"php 实例\"></a>php 实例</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">/*</span><br><span class=\"line\"> * Memento Pattern</span><br><span class=\"line\"> */</span><br><span class=\"line\"></span><br><span class=\"line\">// 发起人</span><br><span class=\"line\">class Originator &#123;</span><br><span class=\"line\">    private $state;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function getState()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return $this-&gt;state;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function setState($_state)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;state = $_state;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // 新建备忘录</span><br><span class=\"line\">    public function createMemento()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return new Memento($this-&gt;state);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // 备忘录恢复</span><br><span class=\"line\">    public function restoreMemento(Memento $_memento)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;setState($_memento-&gt;getState());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 备忘录角色</span><br><span class=\"line\">class Memento &#123;</span><br><span class=\"line\">    private $state;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function __contruct($_state)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;state = $_state;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function getState()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return $this-&gt;state;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function setState($_state)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;state = $_state;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 备忘录管理者</span><br><span class=\"line\">class Caretaker &#123;</span><br><span class=\"line\">    private $memento;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function getMemento()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return $this-&gt;memento;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function setMemento(Memento $_memento)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;memento = $_memento;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Client &#123;</span><br><span class=\"line\">    public static function main()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $originator = new Originator();</span><br><span class=\"line\">        $caretaker = new Caretaker();</span><br><span class=\"line\">        $caretaker-&gt;setMemento($originator-&gt;createMemento());</span><br><span class=\"line\">        $originator-&gt;restoreMemento($caretaker-&gt;getMemento());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h1><h2 id=\"场景\"><a href=\"#场景\" class=\"headerlink\" title=\"场景\"></a>场景</h2><ul>\n<li>需要保存和恢复数据的相关状态场景</li>\n<li>提供一个可回滚的操作</li>\n<li>需要监控的副本中</li>\n<li>数据库连接的事务管理就是用的备忘录模式．</li>\n</ul>\n<h2 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h2><ul>\n<li>备忘录的生命周期需要主动管理, 备忘录创建出来就要在＂最近＂的代码中使用，建立就要使用，不使用立刻删除其引用，坐等GC处理它．</li>\n<li>不要在频繁建立备份的场景中使用备忘录模式，因为: <ol>\n<li>控制不了备忘录创建的对象数量</li>\n<li>大对象的创建需要消耗资源，影响系统的性能</li>\n</ol>\n</li>\n</ul>\n<!--more-->\n","categories":[],"tags":["设计模式"]},{"title":"门面模式","url":"http://chenyangguang.github.com/2017-11-30-facade/","content":"<h1 id=\"0x00-门面模式\"><a href=\"#0x00-门面模式\" class=\"headerlink\" title=\"0x00 门面模式\"></a>0x00 门面模式</h1><p>外观模式.</p>\n<h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><p><strong> Provide a unified interface to a set of interface in a subsystem. Facade defines a higher-level interface that makes the subsystem easier to use.(要求一个子系统的外部与内部的通信必须通过一个统一的对象进行．)</strong></p>\n<h2 id=\"角色\"><a href=\"#角色\" class=\"headerlink\" title=\"角色\"></a>角色</h2><ul>\n<li>Facade 门面角色, 该角色知晓所有功能和责任，委托类．</li>\n<li>Subsystem 子系统角色, 子系统并不知道门面类的存在．</li>\n</ul>\n<h2 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h2><p>减少系统的相互依赖</p>\n<h2 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h2><p>不符合开闭原则．</p>\n<h2 id=\"应用场景\"><a href=\"#应用场景\" class=\"headerlink\" title=\"应用场景\"></a>应用场景</h2><p>适用于:</p>\n<ul>\n<li>为一个复杂的模块或子系统提供一个供外界访问的接口．</li>\n<li>子系统相对独立.</li>\n<li>预防低水平人员带来的风险扩散．</li>\n</ul>\n<h2 id=\"php实现\"><a href=\"#php实现\" class=\"headerlink\" title=\"php实现\"></a>php实现</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">// 子系统</span><br><span class=\"line\">class SubsystemOne &#123;</span><br><span class=\"line\">    public function dosthFir()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        echo &apos;subsystem class one.&apos;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">class SubsystemTwo &#123;</span><br><span class=\"line\">    public function dosthSec()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        echo &apos;subsystem class two.&apos;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">class SubsystemThr &#123;</span><br><span class=\"line\">    public function dosthThr()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        echo &apos;subsystem class three.&apos;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 门面类</span><br><span class=\"line\">class Facade &#123;</span><br><span class=\"line\">    private $objOne;</span><br><span class=\"line\">    private $objTwo;</span><br><span class=\"line\">    private $objThree;</span><br><span class=\"line\">    private $context;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function __construct()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;objOne = new SubsystemOne();</span><br><span class=\"line\">        $this-&gt;objTwo = new SubsystemTwo();</span><br><span class=\"line\">        $this-&gt;objThr = new SubsystemThr();</span><br><span class=\"line\">        $this-&gt;context = new Context();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function jobFir()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;objOne-&gt;dosthFir();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public function jobSec()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;objTwo-&gt;dosthSec();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public function jobThr()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;context-&gt;combineJob();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 封装类, 不要直接参与子系统内的业务逻辑</span><br><span class=\"line\">class Context &#123;</span><br><span class=\"line\">    private $objOne;</span><br><span class=\"line\">    private $objThr;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function __construct()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;objOne = new SubsystemOne();</span><br><span class=\"line\">        $this-&gt;objThr = new SubsystemThr();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function combineJob()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;objOne-&gt;doSthFir();</span><br><span class=\"line\">        $this-&gt;objThr-&gt;doSthThr();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h1><p>门面不参与子系统内的业务逻辑．Laravel 框架就用了不少 Facade.</p>\n","categories":[],"tags":["设计模式"]},{"title":"设计模式-观察者模式","url":"http://chenyangguang.github.com/2017-11-29-observerPattern/","content":"<h1 id=\"0x00-观察者模式\"><a href=\"#0x00-观察者模式\" class=\"headerlink\" title=\"0x00 观察者模式\"></a>0x00 观察者模式</h1><p>也可称发布订阅模式(Publish/Subscribe).</p>\n<h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><p><strong>Define a one-to-many dependency between objets so that when one object changes state, all its dependents are notified and updated automatically.(定义对象间一对多的依赖关系，使得每当一个对象改变状态，则所有依赖于它的对象都会得到通知并自动更新．)</strong><br><a id=\"more\"></a></p>\n<h2 id=\"角色\"><a href=\"#角色\" class=\"headerlink\" title=\"角色\"></a>角色</h2><ul>\n<li>Subject 被观察者, 必须能够动态地增加和取消观察者，起到观察观察者并通知观察者的职责.</li>\n<li>Observer 观察者, 观察者接受到消息通知后，进行更新．</li>\n<li>ConcreteSubject 具体被观察者, 定义被观察者自已的业务逻辑，同时定义对哪些事件进行通知．</li>\n<li>ConcreteObserver 具体观察者, 每个具体观察者自己的处理逻辑．</li>\n</ul>\n<h2 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h2><ul>\n<li>抽象耦合观察者和被观察者之间的关系, 使之易于扩展．</li>\n<li>建立一套触发机制．</li>\n</ul>\n<h2 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h2><p>多级触发时，效率变差．</p>\n<h2 id=\"php-实现\"><a href=\"#php-实现\" class=\"headerlink\" title=\"php 实现\"></a>php 实现</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">/*</span><br><span class=\"line\"> * observer pattern</span><br><span class=\"line\"> */</span><br><span class=\"line\"></span><br><span class=\"line\">//被观察者</span><br><span class=\"line\">abstract class Subject &#123;</span><br><span class=\"line\">    private $observers = [];</span><br><span class=\"line\">    public function addObserver(Observer $_observer)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        array_push($this-&gt;observers, $_observer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function delObserver(Observer $_observer)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $key = array_search($this-&gt;observers, $_observer);</span><br><span class=\"line\">        if ($key !== false) &#123;</span><br><span class=\"line\">            array_splice($this-&gt;observers, $key, 1);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // 通知所有观察者</span><br><span class=\"line\">    public function notifyObservers()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        foreach($this-&gt;observers as $observer) &#123;</span><br><span class=\"line\">            $observer-&gt;update();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// 具体被观察者</span><br><span class=\"line\">class ConcreteSubjects extends Subject &#123;</span><br><span class=\"line\">    public function doSth()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        parent::notifyObservers();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 观察者接口</span><br><span class=\"line\">interface Observer &#123;</span><br><span class=\"line\">    public function update();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class ConcreteObserver implements Observer &#123;</span><br><span class=\"line\">    public function update()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        echo &quot;Get it!Yes!Sir!&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Client &#123;</span><br><span class=\"line\">    public static function main()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $subject = new ConcreteSubjects();</span><br><span class=\"line\">        $observers = new ConcreteObserver();</span><br><span class=\"line\">        $subject-&gt;addObserver($observers);</span><br><span class=\"line\">        $subject-&gt;doSth();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">(new Client())::main();</span><br></pre></td></tr></table></figure>\n<h2 id=\"用武之地\"><a href=\"#用武之地\" class=\"headerlink\" title=\"用武之地\"></a>用武之地</h2><ul>\n<li>可拆分的非组合的关联行为场景.</li>\n<li>事件多级出发场景．</li>\n<li>跨系统的消息交换场景，如消息队列的处理机制．</li>\n</ul>\n<h1 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h1><p>观察者模式需要重点解决两个问题: </p>\n<ul>\n<li>广播链, 在一个观察者模式中，最多出现一个对象既是观察者也是被观察者，即消息最多转发一次(转发两次)是比较恰当的好控制的．</li>\n<li>异步处理, 需要考虑线程安全和队列．</li>\n</ul>\n<!--more-->\n","categories":[],"tags":["设计模式"]},{"title":"设计模式-组合模式","url":"http://chenyangguang.github.com/2017-11-28-composite/","content":"<h1 id=\"0x00-组合模式\"><a href=\"#0x00-组合模式\" class=\"headerlink\" title=\"0x00 组合模式\"></a>0x00 组合模式</h1><p>组合模式，即合成模式．</p>\n<h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><p><strong>Compose objects into tree structures to represent part-whole hierarchies. Composite lets clients treat individual objects and compositions of objects uniformly.(将抽象对象组合成树形结构以表示＂部分－整天＂的层次结构，使得用户对单个对象和组合对象的使用具有一致性．)</strong></p>\n<h2 id=\"关键角色\"><a href=\"#关键角色\" class=\"headerlink\" title=\"关键角色\"></a>关键角色</h2><ul>\n<li>Component 抽象构件, 定义参加组合对象的共有属性和方法, 可以定义一些默认的属性或行为．</li>\n<li>Leaf 叶子构件, 叶子对象，无剩余分支, 属于遍历的最小单位．</li>\n<li>Composite 树枝构件, 树枝对象，组合树枝节点和叶子节点形成一个树形结构．</li>\n</ul>\n<h2 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h2><ul>\n<li>高层模块调用简单, 一棵树形机构中的所有节点都是 Component, 局部和整体对调用者来说没有区别。即高层模块无需关心自己处理的是单个对象还是整个组合结构，简化了高层模块的代码。</li>\n<li>节点自由增加<br>如果想增加一个树枝节点，树叶节点，只要找到它的父节点即可。容易扩展。</li>\n</ul>\n<h2 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h2><p>树叶和树枝直接使用了实现类，限制了接口的使用范围．</p>\n<h2 id=\"使用场景\"><a href=\"#使用场景\" class=\"headerlink\" title=\"使用场景\"></a>使用场景</h2><ul>\n<li>维护和展示”部分-整体”关系的场景，诸如树形菜单，文件和文件夹管理．</li>\n<li>从一个整体中能够独立出部分模块或功能的场景．</li>\n</ul>\n<h2 id=\"php实现\"><a href=\"#php实现\" class=\"headerlink\" title=\"php实现\"></a>php实现</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">// 抽象构件</span><br><span class=\"line\">abstract class Component &#123;</span><br><span class=\"line\">    public function doSth() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 树枝构件</span><br><span class=\"line\">class Composite extends Component &#123;</span><br><span class=\"line\">    private $compArr = [];</span><br><span class=\"line\">    public function add(Component $_component)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        array_push($this-&gt;compArr, $_component);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function remove(Component $_component)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $key = array_search($_component, $this-&gt;compArr);</span><br><span class=\"line\">        if (!$key !== false) &#123;</span><br><span class=\"line\">            array_splice($this-&gt;compArr, $key, 1);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function getChildren()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return $this-&gt;compArr;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 叶子构件</span><br><span class=\"line\">class Leaf extends Component &#123;</span><br><span class=\"line\">    public function doSth()</span><br><span class=\"line\">    &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Client &#123;</span><br><span class=\"line\">    public static function main()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $root = new Composite();</span><br><span class=\"line\">        $root-&gt;doSth();</span><br><span class=\"line\">        $branch = new Composite();</span><br><span class=\"line\">        $root-&gt;add($branch);</span><br><span class=\"line\">        $leaf = new Leaf();</span><br><span class=\"line\">        $branch-&gt;add($leaf);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public static function showTree(Composite $root)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"0x-小结\"><a href=\"#0x-小结\" class=\"headerlink\" title=\"0x 小结\"></a>0x 小结</h1><p>不管你在不在, 设计方式就在那里……</p>\n","categories":[],"tags":["设计模式"]},{"title":"设计模式-迭代器模式","url":"http://chenyangguang.github.com/2017-11-27-iterator/","content":"<h1 id=\"0x00-迭代器模式\"><a href=\"#0x00-迭代器模式\" class=\"headerlink\" title=\"0x00 迭代器模式\"></a>0x00 迭代器模式</h1><p>迭代器类似于一个数据库中(MySQL的游标是单向的)的游标，可以在一个容器内翻滚，遍历所有的查看的元素.</p>\n<h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><p><strong>Provide a way to access the elements of an arrgegate object sequentially without exposing its underlying representation.</strong>(它提供一种方法访问容器对象中的各个元素，而又不需暴露对象的内部细节．)<br><a id=\"more\"></a></p>\n<h2 id=\"角色\"><a href=\"#角色\" class=\"headerlink\" title=\"角色\"></a>角色</h2><ul>\n<li>Iterator 抽象迭代器, 定义和遍历元素的接口, 一般有固定的三个方法: first(), next(), hasNext().</li>\n<li>ConcreteIterator 具体迭代器, 具体实现迭代器接口．</li>\n<li>Aggregate 抽象容器, 提供创建具体迭代器角色的接口．</li>\n<li>ConcreteAggregate 具体容器, 创建迭代器的对象．</li>\n</ul>\n<h2 id=\"php实现\"><a href=\"#php实现\" class=\"headerlink\" title=\"php实现\"></a>php实现</h2><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * Iterator Pattern</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IIterator</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">next</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">hasNext</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">remove</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConcreteIterator</span> <span class=\"keyword\">implements</span> <span class=\"title\">IIterator</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> $arr = [];</span><br><span class=\"line\">    <span class=\"keyword\">public</span> $cursor = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span><span class=\"params\">($_arr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;arr = $_arr;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">hasNext</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>-&gt;cursor == count(<span class=\"keyword\">$this</span>-&gt;arr) ? <span class=\"keyword\">false</span> : <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">next</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        $result = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">$this</span>-&gt;hasNext()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> (<span class=\"keyword\">$this</span>-&gt;arr)[<span class=\"keyword\">$this</span>-&gt;cursor++];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> $result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 开发系统时，如果用到迭代器的删除方法，应该完成两个功能: 1. 删除当前元素, 2. 当前游标指向下一个元素．</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">remove</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;cursor = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Aggregate</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">add</span><span class=\"params\">($obj)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">remove</span><span class=\"params\">($obj)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">iterator</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConcreteAggregate</span> <span class=\"keyword\">implements</span> <span class=\"title\">Aggregate</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> $arr = [];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">add</span><span class=\"params\">($obj)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;arr[] = $obj;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">iterator</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ConcreteIterator(<span class=\"keyword\">$this</span>-&gt;arr);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">remove</span><span class=\"params\">($obj)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;remove($obj);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Client</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        $agg = <span class=\"keyword\">new</span> ConcreteAggregate();</span><br><span class=\"line\">        $agg-&gt;add(<span class=\"string\">'test'</span>);</span><br><span class=\"line\">        $agg-&gt;add(<span class=\"string\">'hello'</span>);</span><br><span class=\"line\">        $agg-&gt;add(<span class=\"string\">'world'</span>);</span><br><span class=\"line\">        $iterator = $agg-&gt;iterator();</span><br><span class=\"line\">        <span class=\"keyword\">while</span> ($iterator-&gt;hasNext()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> $iterator-&gt;next(), PHP_EOL;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">(<span class=\"keyword\">new</span> Client())::main();</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">test</span></span><br><span class=\"line\"><span class=\"comment\">hello</span></span><br><span class=\"line\"><span class=\"comment\">world</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"php-中自有的-Iterator-接口\"><a href=\"#php-中自有的-Iterator-接口\" class=\"headerlink\" title=\"php 中自有的 Iterator 接口\"></a>php 中自有的 Iterator 接口</h2><p><a href=\"http://php.net/manual/en/spl.iterators.php\" target=\"_blank\" rel=\"noopener\">php 原生迭代器</a>.</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Iterator extends Traversable &#123;</span><br><span class=\"line\"><span class=\"comment\">/* 方法 */</span></span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">public</span> mixed current ( void )</span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">public</span> scalar key ( void )</span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">public</span> void next ( void )</span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">public</span> void rewind ( void )</span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">public</span> boolean valid ( void )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>提供了好几个方法.</p>\n<h1 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h1><p>渐渐能摸着一些门道了．<br><!--more--></p>\n","categories":[],"tags":["设计模式"]},{"title":"设计模式-适配器模式","url":"http://chenyangguang.github.com/2017-11-26-adapterPattern/","content":"<h1 id=\"0x00-适配器模式\"><a href=\"#0x00-适配器模式\" class=\"headerlink\" title=\"0x00 适配器模式\"></a>0x00 适配器模式</h1><p>适配器模式，也叫变压器模式, 包装模式(Wrapper)。 装饰者模式也是包装模式的一种。电流传输过程中使用的高压电流，输送到千里之外的家家户户前，并不能直接使用，否则直接烧坏了电器。这就需要进行降压，使用适配器将高压电流转变成家用电器适用的 220v(中国) 电流。</p>\n<h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><p><strong>Convert the interface of  a class into another interface clients expect. Apdapter lets classes work togetherthat couldn’t otherwise because of incompatible interfaces.</strong>(将一个类的接口变换成客户端所期待的另一种接口，从而使原本因接口不匹配而无法在一起工作的两个类能够在一起工作。)</p>\n<a id=\"more\"></a>\n<h2 id=\"角色\"><a href=\"#角色\" class=\"headerlink\" title=\"角色\"></a>角色</h2><ul>\n<li>Target 目标角色, 期望最后提供的目标接口。存在。</li>\n<li>Adaptee 源角色, 需要转变的接口。存在。</li>\n<li>Adapter 适配器角色，核心角色。 </li>\n</ul>\n<h2 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h2><ul>\n<li>使两个没有任何关系的类在一起运行。</li>\n<li>增加类的透明性。 </li>\n<li>提高类的复用度。</li>\n<li>灵活。</li>\n</ul>\n<h2 id=\"php实现\"><a href=\"#php实现\" class=\"headerlink\" title=\"php实现\"></a>php实现</h2><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Target</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">job</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConcreteTarget</span> <span class=\"keyword\">implements</span> <span class=\"title\">Target</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">job</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">'220 v 电流可以正常使用'</span> . PHP_EOL;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Adaptee</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSth</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">'25000 V高压电流也能用'</span> . PHP_EOL;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Adapter</span> <span class=\"keyword\">extends</span> <span class=\"title\">Adaptee</span> <span class=\"keyword\">implements</span> <span class=\"title\">Target</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">job</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">parent</span>::doSth();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Client</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        $target  = <span class=\"keyword\">new</span> ConcreteTarget();</span><br><span class=\"line\">        $target-&gt;job();</span><br><span class=\"line\">        $target2 = <span class=\"keyword\">new</span> Adapter();</span><br><span class=\"line\">        $target2-&gt;job();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">(<span class=\"keyword\">new</span> Client())::main();</span><br><span class=\"line\"><span class=\"comment\">// 220 v 电流可以正常使用</span></span><br><span class=\"line\"><span class=\"comment\">// 25000 V高压电流也能用</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h1><!--more-->\n","categories":[],"tags":["设计模式"]},{"title":"设计模式-策略模式","url":"http://chenyangguang.github.com/2017-11-24-strategy/","content":"<h1 id=\"0x00-策略模式\"><a href=\"#0x00-策略模式\" class=\"headerlink\" title=\"0x00 策略模式\"></a>0x00 策略模式</h1><p>策略模式，也叫政策模式, 使用的是面向对象的继承和多态机制。</p>\n<h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><p><strong> Define a amily of algorithms, encapsulate each one, and make them interchangeable</strong>. (定义一组算法，将每个算法都封装起来，并且使它们之间可以交换。) </p>\n<a id=\"more\"></a>\n<h2 id=\"三个角色组成\"><a href=\"#三个角色组成\" class=\"headerlink\" title=\"三个角色组成\"></a>三个角色组成</h2><ul>\n<li>Context 封装角色, 也称上下文角色，起承上启下封装作用，屏蔽高层模块对策略，算法的直接访问，封装可能存在的变化。</li>\n<li>Strategy 抽象策略角色，策略、算法家族的抽象，通常为接口，定义每个策略或算法必须具有的方法和属性。</li>\n<li>ConcreteStrategy 具体策略角色，实现抽象策略中的操作，该类含有具体的算法。</li>\n</ul>\n<h2 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h2><ul>\n<li>算法可以自由切换<br>只要实现了抽象策略，就成为了策略家族的一个成员，通过封装角色对其进行封装，保证对外提供“可自由切换”的策略。</li>\n<li>避免使用多重条件判断<br>策略家族对外提供的访问接口就是封装类，简化操作，避免条件语句判断。</li>\n<li>易于扩展</li>\n</ul>\n<h2 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h2><ul>\n<li>策略类数量增多<br>每个策略都是一个类，复用的可能性很小，类数量持续增多。</li>\n<li>所有的策略类都需要对外暴露<br>上层模块必须知道有哪些策略，才能进一步决定使用哪一个策略。</li>\n</ul>\n<h2 id=\"使用场景\"><a href=\"#使用场景\" class=\"headerlink\" title=\"使用场景\"></a>使用场景</h2><ul>\n<li>多个类只有算法或行为上略有不同的场景。</li>\n<li>算法需要自由切换的场景。</li>\n<li>需要屏蔽算法规则的场景。</li>\n</ul>\n<h2 id=\"PHP-实现\"><a href=\"#PHP-实现\" class=\"headerlink\" title=\"PHP 实现\"></a>PHP 实现</h2><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 抽象策略接口</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Strategy</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSth</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 具体策略角色</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConcreteStrategy1</span> <span class=\"keyword\">implements</span> <span class=\"title\">Strategy</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSth</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">'strategy 1'</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConcreteStrategy2</span> <span class=\"keyword\">implements</span> <span class=\"title\">Strategy</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSth</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">'strategy 2'</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 封装角色</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Context</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> $strategy = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Context</span><span class=\"params\">(Strategy $_strategy)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;strategy = $_strategy;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doAct</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;strategy-&gt;doSth();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 场景类</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Client</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        $strategy = <span class=\"keyword\">new</span> ConcreteStrategy1();</span><br><span class=\"line\">        $context = <span class=\"keyword\">new</span> Context($strategy);</span><br><span class=\"line\">        $context-&gt;doAct();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//调用</span></span><br><span class=\"line\">(<span class=\"keyword\">new</span> Client())::main(); <span class=\"comment\">// output: strategy 1</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h1><p>类似于可以提供上、中、下对策的场景选择时，使用策略模式最佳。</p>\n<!--more-->\n","categories":[],"tags":["设计模式"]},{"title":"设计模式-装饰者模式","url":"http://chenyangguang.github.com/2017-11-23-decorator/","content":"<h1 id=\"0x00-装饰者模式\"><a href=\"#0x00-装饰者模式\" class=\"headerlink\" title=\"0x00 装饰者模式\"></a>0x00 装饰者模式</h1><h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><p><strong>Attach additional responsibilities to an object dynamically keeping the same interface. Decorators provide a flexible alternative to subclassing for extending functionality.(动态地给一个对象添加一些额外的职责。就增加功能来说，装饰模式相比生成子类更为灵活。) </strong></p>\n<a id=\"more\"></a>\n<h2 id=\"通用类四个角色\"><a href=\"#通用类四个角色\" class=\"headerlink\" title=\"通用类四个角色\"></a>通用类四个角色</h2><ul>\n<li>Component 抽象组件, 作为最核心最原始的对象接口或者抽象类。</li>\n<li>ConcreteComponent 具体构件, 接口或者抽象类的实现。</li>\n<li>Decorator 装饰角色, 属性中必然有一个 private 变量指向 Component 抽象组件。</li>\n<li>具体装饰角色</li>\n</ul>\n<h2 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h2><ul>\n<li>装饰类和被装饰类可以独立发展, 而不会相互耦合。Component 类无须知道 Decorator 类, Decorator 类是从外部扩展 Component 类的功能，而 Decorator 也不需知道具体的构件。</li>\n<li>装饰模式是继承关系的一个替代方案。</li>\n<li>动态地扩展一个实现类的功能。</li>\n</ul>\n<h2 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h2><p>多层复杂的装饰, 数量增加, 会增加系统的复杂度, 同时带给排查问题的时间和难度。</p>\n<h2 id=\"php-实例\"><a href=\"#php-实例\" class=\"headerlink\" title=\"php 实例\"></a>php 实例</h2><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * decorator pattern</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">abstract</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSth</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConcreteComponent</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSth</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">'concrete component'</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 抽象装饰类</span></span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Decorator</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> $component = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Decorator</span><span class=\"params\">(Component $_component)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;component = $_component;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSth</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;component-&gt;doSth();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 具体装饰类</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConcreteDecorator1</span> <span class=\"keyword\">extends</span> <span class=\"title\">Decorator</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">ConcreteDecorator1</span><span class=\"params\">(Component $_component)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">parent</span>::__construct($_component);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">deco1</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">'decorator 1 '</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSth</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;deco1();</span><br><span class=\"line\">        <span class=\"keyword\">parent</span>::doSth();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConcreteDecorator2</span> <span class=\"keyword\">extends</span> <span class=\"title\">Decorator</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">ConcreteDecorator2</span><span class=\"params\">(Component $_component)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">parent</span>::__construct($_component);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">deco2</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">'decorator 2 '</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSth</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;deco2();</span><br><span class=\"line\">        <span class=\"keyword\">parent</span>::doSth();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">$component = <span class=\"keyword\">new</span> ConcreteComponent();</span><br><span class=\"line\">$component = <span class=\"keyword\">new</span> ConcreteDecorator1($component);</span><br><span class=\"line\">$component = <span class=\"keyword\">new</span> ConcreteDecorator2($component);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> $component-&gt;doSth();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// decorator 2 decorator 1 concrete component</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h1><p>优点和缺点是并存的，优点有时候也会转化成缺点。反之，亦然。<br><!--more--></p>\n","categories":[],"tags":["设计模式"]},{"title":"设计模式-责任链模式","url":"http://chenyangguang.github.com/2017-11-22-chainOfResponsibility/","content":"<h1 id=\"0x00-责任链模式\"><a href=\"#0x00-责任链模式\" class=\"headerlink\" title=\"0x00 责任链模式\"></a>0x00 责任链模式</h1><h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><p><strong>Avoid coupling the sender of a request to its rceiver by giving more than one object a chance to handle the request. Chain the receiving objects and pass the request along the chain until an object handles it.(使多个对象都有机会处理请求，从而避免了请求的发送者和接受者之间的耦合关系。将这些对象连成一条链，并沿着这条链传递该请求，直到有对象处理它为止。)</strong></p>\n<a id=\"more\"></a>\n<h2 id=\"重点\"><a href=\"#重点\" class=\"headerlink\" title=\"重点\"></a>重点</h2><p>其重心和核心都在“链”上，有一条链去处理相似的请求在链中决定谁来处理这个请求，并返回相应的结果，多个具体处理者 ConcreteHandler 组成了责任者模式的核心”链”。</p>\n<h2 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h2><p>将请求和处理分开。请求者只需递交请求到窗口，不关心谁在处理，而处理者只关心自己的处理部分，然后提交下一级处理者，直至结束。灵活解耦。</p>\n<h2 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h2><ul>\n<li>性能, 每个请求从链头遍历到链尾, 当链较长时，性能会有问题。</li>\n<li>调试，这个是否只能二分断点排查了。。。。。。</li>\n</ul>\n<h2 id=\"留意\"><a href=\"#留意\" class=\"headerlink\" title=\"留意\"></a>留意</h2><p>对链的节点数量进行限制，避免超长链的现象发生。可在 setNext()方法中判断</p>\n<h2 id=\"php-实现\"><a href=\"#php-实现\" class=\"headerlink\" title=\"php 实现\"></a>php 实现</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">abstract class Handler &#123;</span><br><span class=\"line\">    private  $nextHandler;</span><br><span class=\"line\">    public final function job(Request $_request) &#123;</span><br><span class=\"line\">        $reponse = null;</span><br><span class=\"line\">        if ($this-&gt;getEmerLevel() == $_request-&gt;getRequestLevel()) &#123;</span><br><span class=\"line\">            $response = $this-&gt;report($_request);</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            if ($this-&gt;nextHandler != null) &#123;</span><br><span class=\"line\">                $response = $this-&gt;nextHandler-&gt;job($_request);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        return $response;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function setNext(Handler $_handler) &#123;</span><br><span class=\"line\">        $this-&gt;nextHandler = $_handler;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // 处理紧急程度</span><br><span class=\"line\">    abstract function getEmerLevel();</span><br><span class=\"line\"></span><br><span class=\"line\">    // 处理任务</span><br><span class=\"line\">    abstract function report();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Level &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Request  &#123;</span><br><span class=\"line\">    public function getRequestLevel() &#123;</span><br><span class=\"line\">        return null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Response &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 三个具体处理者</span><br><span class=\"line\">class ConcreteHandler1 extends Handler &#123;</span><br><span class=\"line\">    protected function report(Request $_request) &#123;</span><br><span class=\"line\">        return null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected function getEmerLevel() &#123;</span><br><span class=\"line\">        return null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class ConcreteHandler2 extends Handler &#123;</span><br><span class=\"line\">    protected function report(Request $_request) &#123;</span><br><span class=\"line\">        return null;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected function getEmerLevel() &#123;</span><br><span class=\"line\">        return null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">class ConcreteHandler3 extends Handler &#123;</span><br><span class=\"line\">    protected function report(Request $_request) &#123;</span><br><span class=\"line\">        return null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    protected function getEmerLevel() &#123;</span><br><span class=\"line\">        return null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 场景类</span><br><span class=\"line\">class Client &#123;</span><br><span class=\"line\">    public static function main() &#123;</span><br><span class=\"line\">        $handler1 = new ConcreteHandler1();</span><br><span class=\"line\">        $handler2 = new ConcreteHandler2();</span><br><span class=\"line\">        $handler3 = new ConcreteHandler3();</span><br><span class=\"line\">        $handler1-&gt;setNext($handler2);</span><br><span class=\"line\">        $handler2-&gt;setNext($handler3);</span><br><span class=\"line\">        $res = $handler1-&gt;job(new Request());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h1><p>在责任者模式的核心是: 发起的一个请求直接投给第一个处理者, 依次传递给下一层处理者，直至最终返回结构, 整个请求的处理过程被屏蔽起来。</p>\n<!--more-->\n","categories":[],"tags":["设计模式"]},{"title":"设计模式-命令模式","url":"http://chenyangguang.github.com/2017-11-21-command/","content":"<h1 id=\"0x00-命令模式\"><a href=\"#0x00-命令模式\" class=\"headerlink\" title=\"0x00 命令模式\"></a>0x00 命令模式</h1><h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><p><strong>命令模式是一个高内聚的模式，其定义为: Encapsulate a request as an object, there by letting you parameterize clients with different requests, queue or log requests, and support undoable oerations.</strong><br>(将一个请求封装成一个对象，从而让你使用不同的请求把客户端参数化，对请求队列或者记录请求日志，可以提供命令的撤销和回复功能。)</p>\n<h2 id=\"通用类\"><a href=\"#通用类\" class=\"headerlink\" title=\"通用类\"></a>通用类</h2><p>包含三个角色: </p>\n<ul>\n<li>Receive 接受这角色, 命令传递到这里被执行。</li>\n<li>Command 命令角色, 声明需要执行的所有命令。</li>\n<li>Invoker 调用者角色, 接受到命令，并执行命令。</li>\n</ul>\n<h2 id=\"php-实现\"><a href=\"#php-实现\" class=\"headerlink\" title=\"php 实现\"></a>php 实现</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">/*</span><br><span class=\"line\">  command pattern</span><br><span class=\"line\"> */</span><br><span class=\"line\"></span><br><span class=\"line\">// 通用的 Receiver 类</span><br><span class=\"line\">abstract class Receiver &#123;</span><br><span class=\"line\">    abstract function dosth();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 具体的 Receiver 类</span><br><span class=\"line\">class ConcreteReceiver1 extends Receiver  &#123;</span><br><span class=\"line\">    public function doSth() &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class ConcreteReceiver2 extends Receiver &#123;</span><br><span class=\"line\">    public function doSth() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 抽象的Command 类</span><br><span class=\"line\">abstract class Command &#123;</span><br><span class=\"line\">    abstract function execute();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 具体 Command 类</span><br><span class=\"line\">class ConcreteCommand1 extends Command &#123;</span><br><span class=\"line\">    private $receiver;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function ConcreteCommand1(Receiver $_receiver) &#123;</span><br><span class=\"line\">        $this-&gt;receiver = $_receiver;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function execute() &#123;</span><br><span class=\"line\">        $this-&gt;receiver-&gt;doSth();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class ConcreteCommand2 extends Command &#123;</span><br><span class=\"line\">    private $receiver;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function ConcreteCommand2(Receiver $_receiver) &#123;</span><br><span class=\"line\">        $this-&gt;receiver = $_receiver;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function execute() &#123;</span><br><span class=\"line\">        $this-&gt;receiver-&gt;doSth();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 调用者 Invoker 类</span><br><span class=\"line\">class Invoker &#123;</span><br><span class=\"line\">    private $command;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function setCommand(Command $_command) &#123;</span><br><span class=\"line\">        $this-&gt;command = $_command;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public function act() &#123;</span><br><span class=\"line\">        $this-&gt;command-&gt;execute();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 场景调用</span><br><span class=\"line\">class client &#123;</span><br><span class=\"line\">    public static function main() &#123;</span><br><span class=\"line\">        $invoker = new Invoker();</span><br><span class=\"line\">        $receiver = new ConcreteReceiver1();</span><br><span class=\"line\">        $command = new ConcreteCommand1($receiver);</span><br><span class=\"line\">        $invoker-&gt;setCommand($command);</span><br><span class=\"line\">        $invoker-&gt;act();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h1><p>切勿好高骛远, 即使你的征途是星辰大海, 也要脚踏实地做好准备工作。</p>\n","categories":[],"tags":["设计模式"]},{"title":"中介者模式","url":"http://chenyangguang.github.com/2017-11-12-MediaPattern/","content":"<h1 id=\"0x00-中介者模式\"><a href=\"#0x00-中介者模式\" class=\"headerlink\" title=\"0x00 中介者模式\"></a>0x00 中介者模式</h1><p>现实生活中像神舟飞船的指挥中心, 机场的调度中心, MVC 框架中的 C(controller), 媒体网关, 房租中介等等, 都有着中介者的影子．中介者模式还叫 <strong>调停者模式</strong> ．</p>\n<h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><p><em>Define an boject that encapsulates how a set of objects nteract. Mediator promotes loose coupling by keeping objects from referring to each other explicitly, and it lets you vary their interaction independently.(用一个中介对象封装一系列的对象交互，中介者是各对象不需要显示地相互作用，从而使其耦合松散，而且可以独立地改变它们之间的交互．)</em></p>\n<h2 id=\"构成\"><a href=\"#构成\" class=\"headerlink\" title=\"构成\"></a>构成</h2><ul>\n<li>Mediator 抽象中介者角色, 抽象中介者角色定义统一的接口，用于各同事角色之间的通信．</li>\n<li>Concrete Mediator 具体中介者角色, 具体中介者角色通过协调各同事角色实现协作行为，因此它必须依赖于同事角色．</li>\n<li>Colleague 同事角色, 每个同事角色与其他的同事角色的通信, 必须经过”和事老”<strong>中介者</strong>协作．每个同事类的行为分为两种: <ol>\n<li>自发行为: 同事本身的行为, 如改变对象自身的状态, 处理自己的行为等不需要依赖中介者的动作．</li>\n<li>依赖方法: 依赖中介者才能完成的行为．</li>\n</ol>\n</li>\n</ul>\n<h2 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h2><p>中介者模式减少了类之间的依赖，同事类只依赖于中介者, 将<strong>一对多</strong>的依赖变成<strong>一对一</strong>的依赖，减少依赖的同时也降低了类之间的耦合．</p>\n<h2 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h2><p>随着逻辑复杂度增加，原本 N　个对象直接的相互依赖关系转嫁给中介者和同事类的依赖关系，中介者的逻辑会逐渐复杂，并且变得越来越庞大臃肿．</p>\n<h2 id=\"使用场景\"><a href=\"#使用场景\" class=\"headerlink\" title=\"使用场景\"></a>使用场景</h2><p>多个对象之间<strong>紧密耦合</strong>(在类图中出现了蜘蛛网状结构)的情况下，用中介者是好的选择．<br>话说那些什么经纪人什么秘书的是不是中介者模式？</p>\n<h2 id=\"php-实现\"><a href=\"#php-实现\" class=\"headerlink\" title=\"php 实现\"></a>php 实现</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">// 通用抽象中介者</span><br><span class=\"line\">abstract class Mediator &#123;</span><br><span class=\"line\">    protected  $colleague;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function getColleague() &#123;</span><br><span class=\"line\">        return $this-&gt;colleague;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function setColleague(ConcreteColleague $conColl) &#123;</span><br><span class=\"line\">        $this-&gt;colleague = $conColl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    abstract public function doSth();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 通用中介者</span><br><span class=\"line\">class ConcreteMediator extends  Mediator &#123;</span><br><span class=\"line\">    public function dosth() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 抽象同事类</span><br><span class=\"line\">abstract class Colleague &#123;</span><br><span class=\"line\">    protected $mediator;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function Colleague(Mediator $_mediator) &#123;</span><br><span class=\"line\">        $this-&gt;mediator = $_mediator;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 具体同事类</span><br><span class=\"line\">class ConcreteColleague extends Colleague &#123;</span><br><span class=\"line\">    public function ConcreteColleague(Mediator $_mediator) &#123;</span><br><span class=\"line\">        parent::setColleague($_mediator);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // 自发行为</span><br><span class=\"line\">    public function selfMethod() &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // 依赖方法</span><br><span class=\"line\">    public function relyMethod() &#123;</span><br><span class=\"line\">        parent::doSth(); // 委托中介处理</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<h1 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h1><p>字面上中介和代理多少带着模糊的雷同，所以中介和代理的区别是？</p>\n","categories":[],"tags":["设计模式"]},{"title":"秒杀场景小结","url":"http://chenyangguang.github.com/2017-11-08-secKill/","content":"<p>即使看过秒杀场景的处理办法，还是会忘，因为没有真正实战过．总得抽时间总结一下这个场景的应对策略．那天就需要处理这块业务呢？以防一般的 bug 在那时顶风作案.</p>\n<h2 id=\"0x00-那山，那人，那秒杀\"><a href=\"#0x00-那山，那人，那秒杀\" class=\"headerlink\" title=\"0x00 那山，那人，那秒杀\"></a>0x00 那山，那人，那秒杀</h2><a id=\"more\"></a>\n<p>秒杀场景通常发生在活动日, 节假日促销，”双十一”, 春运火车票抢购等. 此时,　一般是月黑风高, Bug 容易趁机做乱之时．</p>\n<!-- 但是根本上, bug能顶风作案的 -->\n<p>秒杀开始之前，先来欣赏一段&lt;&lt;亮剑&gt;&gt;李云龙攻打县城的场景, 当时日方从四面八方往平安县城增援时, 丁伟所在的防区的阻击方式很是巧妙: </p>\n<p>一开始没搞懂增援的敌人是干啥时, 丁伟的策略是: “一线部队放过敌人的骑兵, 全力阻击敌人的步兵， 二线部队务将敌人的骑兵拦截在二道河口”.　然后发现敌人不顾一切地要奔赴县城时，他明白了，这伙部队是下了死命令往县城奔啊！如果硬抗，肯定是伤亡惨重啊，但是又不能撤出部队，让敌军从防区里过去．亮点来了, 下了四道命令: </p>\n<ol>\n<li>发动地方武装和民兵, 沿公路线及公路两侧埋设地雷, 密度要大;</li>\n<li>派出小部队，占据公路沿线的隘口和制高点, 节节抗击．迟缓敌人的进攻锋芒;</li>\n<li>炸毁防区内所有的桥梁;</li>\n<li>前沿部队撤出阵地，让开路口，让敌人进来．采用麻雀战，袭扰敌人．</li>\n</ol>\n<p>“原则就只有一个，不惜一切代价，阻敌增援.”</p>\n<p> 这不就是活生生的秒杀现场吗！下单的人就是”日军”，不顾死活的都狂点狂刷剩下的库存, 提交表单, 奔赴”县城(数据库)”! 买!买!买!但是你说我网站能让你轻易从我”防区”过去么？那么怎么阻击经过我秒杀系统的场景＂防区＂呢?或者说怎么设计和优化我防区的阻击能力呢？</p>\n<h3 id=\"现场特点\"><a href=\"#现场特点\" class=\"headerlink\" title=\"现场特点\"></a>现场特点</h3><ol>\n<li>大量用户在同一时间发起进攻, 造成瞬时的高流量.</li>\n<li>访问量远远大于库存量．</li>\n<li>业务流程就是下单并减库存.</li>\n</ol>\n<h3 id=\"针对性的架构\"><a href=\"#针对性的架构\" class=\"headerlink\" title=\"针对性的架构\"></a>针对性的架构</h3><p>秒杀页面-&gt;服务器站点-&gt;服务层-&gt;数据库层</p>\n<ul>\n<li>秒杀页面 <ol>\n<li>静态化，在秒杀页面，就得将页面静态化, 除了必要的静态元素，其余的全部静态化，结合 CDN抵抗页面静态元素的访问．</li>\n<li>禁止用户重复提交, 提交过后按钮置为不可点击或者灰色.</li>\n<li>用户限流, 同一个IP用户一定时间内只允许提交一次订单.</li>\n<li>验证码填写识别.</li>\n</ol>\n</li>\n<li>服务器站点: <ol>\n<li>限制用一个 UID 用户一段时间内的访问次数．</li>\n<li>采用消息队列缓存请求, 批量读取, 把多个请求的查询合并到一起进行, 减少数据库的访问次数．</li>\n<li>redis 缓存查询的结果, 特别是库存量．</li>\n</ol>\n</li>\n<li>服务层<ol>\n<li>分时分段分批次放票, “骑兵”, “步兵”梯队放过处理．</li>\n<li>下订单模块(秒杀的核心部分), 队列控制异步化，做请求队列，判断读列是否已经满, 若未满，则将请求放到队列中;若已满, 则后面的请求返回秒杀失败. 总之, 单位时间只透过有限的”部队”(请求)去”县城”(数据库).</li>\n<li>下单, 异步付款．</li>\n</ol>\n</li>\n</ul>\n<h3 id=\"关键点\"><a href=\"#关键点\" class=\"headerlink\" title=\"关键点\"></a>关键点</h3><ol>\n<li>业务拆分, 独立并发访问.</li>\n<li>高并发控制，请求量拦截．</li>\n<li>读写分离(查询和下单拆分独立).</li>\n<li>请求队列控制接受数，控制并发量.</li>\n<li>订单和支付保持一致性．</li>\n</ol>\n<h2 id=\"0x01-让暴风雨来的更猛烈些吧\"><a href=\"#0x01-让暴风雨来的更猛烈些吧\" class=\"headerlink\" title=\"0x01 让暴风雨来的更猛烈些吧\"></a>0x01 让暴风雨来的更猛烈些吧</h2><p>要点是层层阻击, 将流量压力拦在上游．减少到达写入数据库的增援部队数量．<br>留给中国队的时间已经不多了，哦不，是留给 Bug 的时间已经不多了, 又错了，是留给增援到数据库的”敌军”(写操作)已经不多了……</p>\n<h2 id=\"0x02-参考\"><a href=\"#0x02-参考\" class=\"headerlink\" title=\"0x02 参考\"></a>0x02 参考</h2><ol>\n<li><a href=\"https://mp.weixin.qq.com/s?sn=fb28fd5e5f0895ddb167406d8a735548&amp;__biz=MjM5ODYxMDA5OQ==&amp;mid=2651959391&amp;idx=1&amp;scene=21&amp;pass_ticket=5a1eixuRcaxaEfBB3VPh7z%2BRHowhFEJSqSWxYJTsomcQQ1yIU7LMGpQxjDey9Xgj\" target=\"_blank\" rel=\"noopener\">秒杀系统架构优化之路.58沈剑</a></li>\n<li><a href=\"http://blog.csdn.net/suifeng3051/article/details/52607544\" target=\"_blank\" rel=\"noopener\">如何设计一个秒杀系统</a></li>\n<li><a href=\"http://www.csdn.net/article/2014-11-28/2822858\" target=\"_blank\" rel=\"noopener\">Web系统大规模并发–电商秒杀与抢购.徐汉彬</a><!--more-->\n</li>\n</ol>\n","categories":[],"tags":["Web","计算机技术"]},{"title":"设计模式-原型模式","url":"http://chenyangguang.github.com/2017-11-06-TheZenOfDesignPatternPrototype/","content":"<p>设计模式第七式–原型模式。</p>\n<h2 id=\"0x00-原型模式\"><a href=\"#0x00-原型模式\" class=\"headerlink\" title=\"0x00 原型模式\"></a>0x00 原型模式</h2><h3 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p> <em>Specify the kinds of objects to create using prototypical instance, and create new objects by copying this prototype.</em><br> (用原型实例指定创建对象的种类, 并且通过拷贝这些原型创建新的对象。)</p>\n<a id=\"more\"></a>\n<p>通用类图<br><img src=\"/2017-11-06-TheZenOfDesignPatternPrototype/photos/prototype.png\" alt=\"通用类图\"></p>\n<h4 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h4><ul>\n<li>性能优良, 原型模式在内存二进制流的拷贝, 要比直接 new 一个对象性能好很多，特别是要在一个循环体内产生大量的对象时。 缺点也是减少了约束。</li>\n</ul>\n<h4 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h4><ul>\n<li>逃避构造函数的约束, 直接在内存中拷贝, 构造函数是不会执行的。优点是减少了约束，</li>\n</ul>\n<h4 id=\"使用场景\"><a href=\"#使用场景\" class=\"headerlink\" title=\"使用场景\"></a>使用场景</h4><p>类初始化需要消耗非常多的资源, 如: 数据, 硬件资源。</p>\n<ol>\n<li>性能和安全要求的场景, 通过 new 产生一个对象需要非常繁琐的数据准备或访问权限的情况，可以使用原型模式。</li>\n<li>一个对象多个修改者的场景, 一个对象需要提供其他对象访问, 而且各个调用者可能都需要修改其值时, 可以考虑使用原型模式拷贝多个对象供调用者使用。</li>\n<li>原型模式可和工厂方法模式一起使用, 通过 clone 的方法创建一个对象, 然后由工厂方法提供给调用者。</li>\n</ol>\n<h4 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h4><ul>\n<li>构造函数不会被执行</li>\n<li>浅拷贝和深拷贝</li>\n<li>要使用 clone 方法， 类的成员变量上不要增加 final 关键字。</li>\n</ul>\n<h4 id=\"php-实例\"><a href=\"#php-实例\" class=\"headerlink\" title=\"php 实例\"></a>php 实例</h4><h2 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h2><p>  原型模式先产生一个包含大量共有信息的类，然后进行拷贝副本(影分身), 修正细节信息, 建立一个完整的个性对象。<br><!--more--></p>\n","categories":[],"tags":["设计模式"]},{"title":"设计模式-建造者模式","url":"http://chenyangguang.github.com/2017-10-26-BuilderPattern/","content":"<h2 id=\"0x00-建造者模式\"><a href=\"#0x00-建造者模式\" class=\"headerlink\" title=\"0x00 建造者模式\"></a>0x00 建造者模式</h2><h3 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p><em>Separate the construction of a complex object from its representation so that the same<br>construction process can create different representations</em>.<br>(将一个复杂对象的构建与它的表示分离, 使得同样的构建过程可以创建不同的表示。)</p>\n<a id=\"more\"></a>\n<p><img src=\"/2017-10-26-BuilderPattern/photos/builder-pattern.png\" alt=\"\"></p>\n<h4 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h4><ul>\n<li>封装性, 客户端不需要知道产品内部的细节.</li>\n<li>建造者独立，容易扩展.</li>\n<li>便于控制细节风险, 由于具体的建造者都是独立的，因此对建造过程中的逐步细化，不会影响到其他模块.</li>\n</ul>\n<h4 id=\"使用场景\"><a href=\"#使用场景\" class=\"headerlink\" title=\"使用场景\"></a>使用场景</h4><ul>\n<li>相同的方法, 不用的执行顺序, 产生不同的事件结果时，可以采用建造者模式.</li>\n<li>多个部件或零件，都可以装配到一个对象中，但是产生的运行结果又不相同的，则可以使用该模式.</li>\n<li>产品类非常复杂，或者产品类中的调用顺序不同产生了不同的效果，这个时候使用建造者模式非常合适.</li>\n</ul>\n<h4 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h4><p>建造者模式关注的是零件类型和装饰工艺(顺序), 这个是它与工厂模式最大不同的地方。</p>\n<h4 id=\"PHP-实例\"><a href=\"#PHP-实例\" class=\"headerlink\" title=\"PHP 实例\"></a>PHP 实例</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">abstract class AbstractQueryBuilder &#123;</span><br><span class=\"line\">    abstract function getQuery();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">abstract class AbstractQueryDirector &#123;</span><br><span class=\"line\">    abstract function __construct(AbstractQueryBuilder $builder);</span><br><span class=\"line\">    abstract function buildQuery();</span><br><span class=\"line\">    abstract function getQuery();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Model &#123;</span><br><span class=\"line\">    private $sql = NULL;</span><br><span class=\"line\">    private $sql_table = NULL;</span><br><span class=\"line\">    private $sql_where = NULL;</span><br><span class=\"line\">    private $sql_limit = NULL;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __construct() &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function querySql() &#123;</span><br><span class=\"line\">        return $this-&gt;sql;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function table($table) &#123;</span><br><span class=\"line\">        $this-&gt;sql_table  = $table;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function where($where) &#123;</span><br><span class=\"line\">        $this-&gt;sql_where = $where;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function limit ($limit) &#123;</span><br><span class=\"line\">        $this-&gt;sql_limit = $limit;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function splicingQuery () &#123;</span><br><span class=\"line\">        $this-&gt;sql = &apos;SELECT * FROM &apos;;</span><br><span class=\"line\">        $this-&gt;sql .= $this-&gt;sql_table;</span><br><span class=\"line\">        $this-&gt;sql .= &apos; WHERE &apos; . $this-&gt;sql_where;</span><br><span class=\"line\">        $this-&gt;sql .= &apos; LIMIT &apos; . $this-&gt;sql_limit;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class BaseQueryBuilder extends AbstractQueryBuilder &#123;</span><br><span class=\"line\">    private $query = NULL;</span><br><span class=\"line\">    function __construct() &#123;</span><br><span class=\"line\">        $this-&gt;query = new Model();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function table($table) &#123;</span><br><span class=\"line\">        $this-&gt;query-&gt;table($table);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function where($where) &#123;</span><br><span class=\"line\">        $this-&gt;query-&gt;where($where);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function limit($limit) &#123;</span><br><span class=\"line\">        $this-&gt;query-&gt;limit($limit);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function splicingQuery() &#123;</span><br><span class=\"line\">        $this-&gt;query-&gt;splicingQuery();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function getQuery() &#123;</span><br><span class=\"line\">        return $this-&gt;query;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class UserQueryDirector extends AbstractQueryDirector &#123;</span><br><span class=\"line\">    private $builder = NULL;</span><br><span class=\"line\">    public function __construct(AbstractQueryBuilder $builder_sql) &#123;</span><br><span class=\"line\">        $this-&gt;builder = $builder_sql;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function buildQuery() &#123;</span><br><span class=\"line\">        $this-&gt;builder-&gt;table(&apos;User&apos;);</span><br><span class=\"line\">        $this-&gt;builder-&gt;where(&apos;id &lt; 10&apos;);</span><br><span class=\"line\">        $this-&gt;builder-&gt;limit(&apos;100&apos;);</span><br><span class=\"line\">        $this-&gt;builder-&gt;splicingQuery();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function getQuery() &#123;</span><br><span class=\"line\">        return $this-&gt;builder-&gt;getQuery();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$queryBuilder = new BaseQueryBuilder();</span><br><span class=\"line\">$userDirector = new UserQueryDirector($queryBuilder);</span><br><span class=\"line\">$userDirector-&gt;buildQuery();</span><br><span class=\"line\">$userSql = $userDirector-&gt;getQuery();</span><br><span class=\"line\"></span><br><span class=\"line\">var_dump($userSql-&gt;querySql());</span><br><span class=\"line\"></span><br><span class=\"line\">// string(42) &quot;SELECT * FROM User WHERE id &lt; 10 LIMIT 100&quot;</span><br></pre></td></tr></table></figure>\n<h2 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h2><p>各个设计模式之间有相似的地方. 比如封装性。<br><!--more--></p>\n","categories":[],"tags":["设计模式"]},{"title":"设计模式-模板方法模式","url":"http://chenyangguang.github.com/2017-10-25-TheZenOfDesignPatternTemplateMethod/","content":"<p>设计模式第四式–模板方法模式。</p>\n<h2 id=\"0x00-工厂方法模式\"><a href=\"#0x00-工厂方法模式\" class=\"headerlink\" title=\"0x00 工厂方法模式\"></a>0x00 工厂方法模式</h2><h3 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p> <em>Define the skeleton of an algorithm in an operation, deferring some step to subclasses. Template Method lets subclasses redefine certain steps of an algorithm without changing the algorithm’s structure</em><br> (定义一个操作中的算法的框架, 而将一些步骤延迟到子类中。使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。)</p>\n<a id=\"more\"></a>\n<p>通用类图<br><img src=\"/2017-10-25-TheZenOfDesignPatternTemplateMethod/photos/Template-method.png\" alt=\"通用类图\"></p>\n<h4 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h4><ol>\n<li>封装不可变部分, 扩展可变部分。用不可变部分的算法封装到父类, 可变部分通过继承来扩展。</li>\n<li>提取公共部分, 便于维护。</li>\n<li>行为由父类控制，子类实现。基本的方法是由子类实现的，因此子类可以通过扩展的方式增加相应的功能，符合开闭原则。</li>\n</ol>\n<h4 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h4><p>模板方法模式属于像欧阳峰一样倒练《九阴真经》。正版的《九阴真经》或者一般的武学秘笈开篇应该是提纲挈领, 如独孤九剑，先讲抽象类负责声明最抽象、最一般的事物属性和方法–总决式，然后才娓娓道来破剑式，破刀式，破掌式, 破索式，破鞭式，破枪式，破箭式，破气式这些实现类的具体属性和方法。但是欧阳峰的模板方法模式, 照着黄蓉背给他的倒转的《九阴真经》, 头脚对调了，抽象类定义了部分抽象方法, 有子类实现，子类执行的结果影响了父类的结果, 所以子类对父类产生了影响，结果变得疯疯颠颠的了。“我是谁？欧阳峰是谁？”</p>\n<h4 id=\"使用场景\"><a href=\"#使用场景\" class=\"headerlink\" title=\"使用场景\"></a>使用场景</h4><ol>\n<li>多个子类又公有的方法, 并且逻辑基本相同时。</li>\n<li>重要、复杂的算法, 可以把核心算法设计为模板方法, 周边的相关细节功能则由各个子类实现。</li>\n<li>重构时, 把相同的代码抽到父类中，通过钩子函数约束其行为。</li>\n<li>具体如: 文件上传; 数据埋点上报等。</li>\n</ol>\n<h4 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h4><ul>\n<li>为了防止恶意的操作, 一般模板方法都加上final关键字, 不允许被覆写。</li>\n<li>抽象模板中的基本方法尽量设计为protected类型, 符合迪米特法则, 不需要暴露的属性或方法尽量设置为protected类型。 实现类若非必要, 尽量不要扩大父类中的访问<br>权限</li>\n</ul>\n<h4 id=\"php-实例\"><a href=\"#php-实例\" class=\"headerlink\" title=\"php 实例\"></a>php 实例</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">// 独孤九剑</span><br><span class=\"line\">abstract class Dugujiujian &#123;</span><br><span class=\"line\">    // protected 将独孤九剑剑法的招式秘密都保护起来，宁可烂在华山也不轻易传给华山弟子</span><br><span class=\"line\">    protected abstract function zongjueStyle();</span><br><span class=\"line\">    protected abstract function pojianStyle();</span><br><span class=\"line\">    protected abstract function podaoStyle();</span><br><span class=\"line\">    protected abstract function pozhangStyle();</span><br><span class=\"line\">    protected abstract function poqiStyle();</span><br><span class=\"line\"></span><br><span class=\"line\">    // final 关键字限定，不能随便改剑谱要诀</span><br><span class=\"line\">    final public function useDujiujian ()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;zongjueStyle();</span><br><span class=\"line\">        $this-&gt;pojianStyle();</span><br><span class=\"line\">        $this-&gt;podaoStyle();</span><br><span class=\"line\">        $this-&gt;pozhangStyle();</span><br><span class=\"line\"></span><br><span class=\"line\">        // 如果功力深厚的，再教学破气式</span><br><span class=\"line\">        if(!$this-&gt;isGonglishenhou()) &#123;</span><br><span class=\"line\">            echo( &apos;功力不济, 江湖上历练几十年再领会破气式!&apos; . PHP_EOL );</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            $this-&gt;poqiStyle();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // 钩子方法</span><br><span class=\"line\">    protected function isGonglishenhou()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Fengqingyang extends Dugujiujian &#123;</span><br><span class=\"line\">    protected $deepNeili = true;</span><br><span class=\"line\">    protected function zongjueStyle() &#123;</span><br><span class=\"line\">        echo(&apos;风清杨在教 总决式&apos; . PHP_EOL);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected function pojianStyle() &#123;</span><br><span class=\"line\">        echo(&apos;风清杨在教 破剑式&apos; . PHP_EOL);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected function podaoStyle() &#123;</span><br><span class=\"line\">        echo(&apos;风清杨在教 破刀式&apos; . PHP_EOL);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected function pozhangStyle() &#123;</span><br><span class=\"line\">        echo(&apos;风清杨在教 破掌式&apos; . PHP_EOL);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected function poqiStyle() &#123;</span><br><span class=\"line\">        echo(&apos;风清杨在教 破气式&apos; . PHP_EOL);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected function isGonglishenhou () &#123;</span><br><span class=\"line\">        return $this-&gt;deepNeili;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // 能不能教学破气式是由内力决定的</span><br><span class=\"line\">    public function checkGongli($deepNeili) &#123;</span><br><span class=\"line\">        return $this-&gt;deepNeili = (bool) $deepNeili;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class linghuchong extends Dugujiujian &#123;</span><br><span class=\"line\">    protected function zongjueStyle()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        echo(&apos;令狐冲在学 总决式&apos; . PHP_EOL);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected function pojianStyle()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        echo(&apos;令狐冲在学 破剑式&apos; . PHP_EOL);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected function podaoStyle()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        echo(&apos;令狐冲在学 破刀式&apos; . PHP_EOL);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected function pozhangStyle()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        echo(&apos;令狐冲在学 破掌式&apos; . PHP_EOL);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected function poqiStyle()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        echo(&apos;令狐冲在学 破气式&apos; . PHP_EOL);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected function isGonglishenhou()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return false;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class chuanshouDugujiujian &#123;</span><br><span class=\"line\">    public static function main ()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $fengqingyang = new Fengqingyang();</span><br><span class=\"line\">        $deepNeili = 1;</span><br><span class=\"line\">        if(!$deepNeili) &#123;</span><br><span class=\"line\">            $fengqingyang-&gt;checkGongli($deepNeili);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        $fengqingyang-&gt;useDujiujian();</span><br><span class=\"line\"></span><br><span class=\"line\">        $deepNeili = 0;</span><br><span class=\"line\">        $linghuchong = new Linghuchong();</span><br><span class=\"line\">        $linghuchong-&gt;useDujiujian();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">chuanshouDugujiujian::main();</span><br><span class=\"line\"></span><br><span class=\"line\">    // 风清杨在教 总决式</span><br><span class=\"line\">    // 风清杨在教 破剑式</span><br><span class=\"line\">    // 风清杨在教 破刀式</span><br><span class=\"line\">    // 风清杨在教 破掌式</span><br><span class=\"line\">    // 风清杨在教 破气式</span><br><span class=\"line\">    // 令狐冲在学 总决式</span><br><span class=\"line\">    // 令狐冲在学 破剑式</span><br><span class=\"line\">    // 令狐冲在学 破刀式</span><br><span class=\"line\">    // 令狐冲在学 破掌式</span><br><span class=\"line\">    // 功力不济, 江湖上历练几十年再领会破气式!</span><br></pre></td></tr></table></figure>\n<h2 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h2><p>使用风清杨教令狐冲独孤九剑的一段经历模拟了一下模板方法模式, 虽然有些生硬，但也是自己对模板方法模式的一个理解吧。反正都要自己去实现一遍, 慢慢消化吸收。哪怕就着芥末吃，也先咽下去。<br><!--more--></p>\n","categories":[],"tags":["设计模式"]},{"title":"设计模式-抽象工厂模式","url":"http://chenyangguang.github.com/2017-10-24-TheZenOfDesignPatternAbstractFactory/","content":"<h2 id=\"0x00-抽象工厂模式\"><a href=\"#0x00-抽象工厂模式\" class=\"headerlink\" title=\"0x00 抽象工厂模式\"></a>0x00 抽象工厂模式</h2><h3 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p> <em>Provide an interface or creating families of related or dependent objects without specifying their concrete classes</em><br> (为创建一组相关或相互依赖的对象提供一个接口, 而且无须指定它们的具体类。)</p>\n<p> 抽象工厂模式的通用类图:<br><img src=\"/2017-10-24-TheZenOfDesignPatternAbstractFactory/photos/abstract-factory.png\" alt=\"\"><br><img src=\"/2017-10-24-TheZenOfDesignPatternAbstractFactory/photos/abstract-factory-source.png\" alt=\"\"></p>\n<a id=\"more\"></a>\n<h4 id=\"区别于工厂方法模式\"><a href=\"#区别于工厂方法模式\" class=\"headerlink\" title=\"区别于工厂方法模式\"></a>区别于工厂方法模式</h4><ol>\n<li>子工厂必须全部继承或实现自同一个抽象类或接口. </li>\n<li>每个工厂必须包含多个工厂方法. </li>\n<li>每个工厂的方法必须一致</li>\n</ol>\n<h4 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h4><ul>\n<li>封装性, 每个产品的实现类不是高层模块需要关心的, 它只关心接口和抽象，它不关心对象是如何创建出来。只要知道工厂类是谁，就能创建出来一个需要的对象。</li>\n<li>产品族内约束是非公开状态, 是在工厂内实现的。</li>\n</ul>\n<h4 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h4><p>产品族扩展非常困难。需要同时修改抽象类和实现类.</p>\n<h4 id=\"使用场景\"><a href=\"#使用场景\" class=\"headerlink\" title=\"使用场景\"></a>使用场景</h4><p>一个对象族都有相同的约束，就可以使用抽象工厂模式. 比如 php 在 linux 和 windows 下面的运行效果看上去一样，也就是相当于有一样的约束条件: 操作系统类型。那么就可以使用抽象工厂模式, 产生不同操作系统下的 php 安装途径。</p>\n<h4 id=\"PHP-实现\"><a href=\"#PHP-实现\" class=\"headerlink\" title=\"PHP 实现\"></a>PHP 实现</h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">population</span> </span>&#123;&#125;</span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">income</span> </span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShenzhenPopulation</span> </span>&#123;&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShenzhenIncome</span> </span>&#123;&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BeijingPopulation</span> </span>&#123;&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BeijingIncome</span> </span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">NationalStatisticsAbstractFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">statisticsPopulation</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">statisticsIncome</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShenzhenFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">NationalStatisticsAbstractFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">statisticsPopulation</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ShenzhenPopulation();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">statisticsIncome</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ShenzhenIncome();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BeijingFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">NationalStatisticsAbstractFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">statisticsPopulation</span> <span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> BeijingPopulation();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">statisticsIncome</span> <span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> BeijingIncome();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>深圳工厂和北京的工厂类(ShenzhenFactory, BeijingFactory)都继承自 国家统计抽象接口(NationalStatisticsAbstractFactory), ShenzhenFactory 和 BeijingFactory 都分别包含统计收入(statisticsIncome)和统计人口(statisticsPopulation)的方法.</p>\n<h2 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h2><p>设计模式要细细品尝, 值得花时间研究.</p>\n<!--more-->\n","categories":[],"tags":["设计模式"]},{"title":"设计模式-工厂方法模式","url":"http://chenyangguang.github.com/2017-10-23-TheZenOfDesignPatternFactory/","content":"<p>设计模式第二式–工厂方法模式, 改模式使用的频率非常高。所以排在前面一点学。</p>\n<h2 id=\"0x00-工厂方法模式\"><a href=\"#0x00-工厂方法模式\" class=\"headerlink\" title=\"0x00 工厂方法模式\"></a>0x00 工厂方法模式</h2><h3 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>  <em>Define an interface for crating an object, but let subclasses decide which class to instantiate. Factor Method lets a class defer instantiation to subclasses.</em>          + <em>Separate the construction of a complex object from its representation so the same construction can create different representation</em> </p>\n<ul>\n<li>(定义一个用于创建对象的接口，让子类决定实例化哪一个类。工厂方法使一个类的实例化延迟到其子类。)</li>\n</ul>\n<a id=\"more\"></a>\n<h4 id=\"解读\"><a href=\"#解读\" class=\"headerlink\" title=\"解读\"></a>解读</h4><p>具体的产品类可以有很多个，都继承于抽象产品类。<br>抽象工厂类负责定义产品对象的产生。<br>具体如何创建一个产品的对象，是由具体的工厂类实现的。</p>\n<h4 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h4><ol>\n<li>良好的封装性，代码结构清晰。一个对象创建是有条件约束的，如一个调用者需要一个具体的产品对象，只要知道这个产品的类名即可。无须知道创建对象的艰辛过程，降低模块间的耦合。</li>\n<li>工厂方法模式的易扩展性。在增加产品类的情况下，只要适当地修改具体的工厂类或扩展一个工厂类，就可以实现“拥抱变化”。</li>\n<li>屏蔽产品类。因为产品类的实例化由工厂类负责，调用者不需关心产品类的实现如何变化，只关心产品的接口。接口不变，系统中的上层模块就不用发生变化。比如: 使用工厂方法模式连接数据库, MySQL 切换到 Oracle 只需要切换驱动名称即可。</li>\n<li>解藕框架。</li>\n</ol>\n<h4 id=\"使用场景\"><a href=\"#使用场景\" class=\"headerlink\" title=\"使用场景\"></a>使用场景</h4><ol>\n<li>工厂方法模式是 new 一个对象的替代品，如果增加一个工厂类并没有增加代码的复杂度，在需要生成对象的地方都可以使用。</li>\n<li>灵活的、可扩展的框架可以采用工厂方法模式。万物皆对象。比如: http, udp协议的连接方法中就可以使用．</li>\n<li>工厂方法模式可以用在异构项目中．</li>\n<li>可以使用在测试驱动开发的框架下．</li>\n</ol>\n<h4 id=\"扩展\"><a href=\"#扩展\" class=\"headerlink\" title=\"扩展\"></a>扩展</h4><ol>\n<li>缩小为简单工厂模式．去掉抽象类, 并使用 static　关键字．</li>\n<li>升级为多个工厂类．</li>\n<li>替代单例模式.　单例模式核心要求是内存中只有一个对象，通过工厂方法模式就可以只在内存中生产一个对象．</li>\n<li>延迟初始化．一个对象被消费完毕后，并不立刻释放，工厂类保持其初始状态，等待再次被使用．</li>\n</ol>\n<h2 id=\"0x01-小结\"><a href=\"#0x01-小结\" class=\"headerlink\" title=\"0x01 小结\"></a>0x01 小结</h2><p>工厂方法模式暂时理解为，你给我一个物品名，丢给车间, 完成生产．<br><!--more--></p>\n","categories":[],"tags":["设计模式"]},{"title":"最没出息的9大根源","url":"http://chenyangguang.github.com/2017-09-26-No_Special_People/","content":"<h2 id=\"研究表明\"><a href=\"#研究表明\" class=\"headerlink\" title=\"研究表明\"></a>研究表明</h2><p>哈佛的一项研究表明: 一个人没有出息主要有以下九大根源。</p>\n<h3 id=\"犹豫不决\"><a href=\"#犹豫不决\" class=\"headerlink\" title=\"犹豫不决\"></a>犹豫不决</h3><p>“畏惧错误就是毁灭进步”。雷厉风行很容易出错，但是原地踏步什么也不做更糟糕。<br><a id=\"more\"></a></p>\n<h3 id=\"拖延\"><a href=\"#拖延\" class=\"headerlink\" title=\"拖延\"></a>拖延</h3><p>懒惰和拖延，可以将一个有前途的计划活活闷死。迟迟不开始，或者遇到问题就推托，很容易将横在面前的困难放大，望而却步。借口根本不能解决问题。消极的心态，一旦蔓延开来，犹如蒲公英的种子一样，撒得到处都是。而如果踏进拖延的沼泽, 只会越陷越深, 无法自拔。随着时间的流逝，人的内心逐渐产生沉重的愧疚和自我否定。</p>\n<h3 id=\"三分钟热度\"><a href=\"#三分钟热度\" class=\"headerlink\" title=\"三分钟热度\"></a>三分钟热度</h3><p>这个我感触太深了: 一开始制定了雄心勃勃的计划， 最后以心灰意冷草草收场。兴趣太广泛，多数事情都是浅尝辄止。以至于在紧要关头的事情上，时有半途而废的情况出现。而作出那些时刻的决策，自己都没有认真考虑清楚后果，有的自己都没有自知。事后回想起来，才发现错过了很多。坚持，才能熬过枯燥，迎来成功, 体会到收获的喜悦。</p>\n<h3 id=\"害怕拒绝\"><a href=\"#害怕拒绝\" class=\"headerlink\" title=\"害怕拒绝\"></a>害怕拒绝</h3><p>怕拒绝, 厚重而脆弱的自尊，混在人际中感觉无名的痛。还是应该放下自尊去做事情，专注到成果的方向上去。少关注他人对自己做事的态度。</p>\n<h3 id=\"自我设限\"><a href=\"#自我设限\" class=\"headerlink\" title=\"自我设限\"></a>自我设限</h3><p>这个杀死自己能力的心里暗示行为，估计很多人都会有。</p>\n<h3 id=\"逃避现实\"><a href=\"#逃避现实\" class=\"headerlink\" title=\"逃避现实\"></a>逃避现实</h3><ol>\n<li>怎么感觉又是在说我。年少时，经常做白日梦，梦想着会飞，三分投篮可以百分百中……躲进自己的没有风雨的小楼里。</li>\n<li>喜欢随心所欲，无拘无束的生活。大学的时候，整天想的就是玩了。每到寒暑假，就跑出去周游，那时候，足迹遍布了全国的天南地北。和朋友聊天的时候，还以为别人聊到这个问题时，是在夸自己。殊不知，这些都是逃避现实的体现。知心朋友不会指出来的: 你这个游手好闲的家伙!</li>\n<li>沉迷游戏和魔幻小说。其实，我在想，喜欢看电影和电视剧的，何尝又不是逃避现实！而这些，之前每一样我都占了。</li>\n</ol>\n<p>有逃避现实的这些行为的人，会以为是想过的是惬意快乐的生活， 事实上导致的却是与日常生活格格不入的烦躁和不安。</p>\n<h3 id=\"总找接口\"><a href=\"#总找接口\" class=\"headerlink\" title=\"总找接口\"></a>总找接口</h3><p>找接口，恐怕是这个星球上除了生存之后最容易的事情了? 有习惯找接口的人，基本都是一些没有强烈的事业心，没有执着的追求的人。一出错，往往第一时间先把自己摘得干干净净，以为事出不在我的态度。不管是出于自我保护还是撇清责任，这些人在社会上总是有的。很难合作。出了bug, 不在第一时间解决问题，却想着气势凶凶追究后果，指责别人的行为，这种自我安慰的行为实在可恶。谁还没出错的时候？遇到困难，遇到问题，要去承担，要去解决。遇到风险，需要去挑战。不能退缩！</p>\n<h3 id=\"恐惧\"><a href=\"#恐惧\" class=\"headerlink\" title=\"恐惧\"></a>恐惧</h3><p> 谨小慎微的活着，怕这怕那的。可能这个和年龄、阅历都有些关系。以前都是天不怕，地不怕的。大学毕业之后，还是大学开始之后，就各种害怕，接踵而至了。仿佛是依附在身上的细菌一般。害怕批评，害怕失败，害怕结果，在意别人的评价和态度，害怕自己的缺点，害怕变成无能。想想看，这是多么脆弱的心智啊？</p>\n<h3 id=\"拒绝学习\"><a href=\"#拒绝学习\" class=\"headerlink\" title=\"拒绝学习\"></a>拒绝学习</h3><p>在互联网领域，以现在的发展速度, 半年不学习，便恍如脱离了这个世界半个世纪以上。</p>\n<h2 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h2><p>拼尽全力去学习，去体验，去生活, 去追求吧。每一天都是那么特殊，每一天都是那么弥足珍贵。多少人没有我们现在的条件，却还能作出那么多对家人，对社会，对大众有意义的事情? 何况。。。。。。</p>\n<!--more-->\n","categories":[],"tags":["点滴"]},{"title":"《天道》","url":"http://chenyangguang.github.com/2017-09-07-distant-savior/","content":"<h1 id=\"《遥远的救世主》–电视剧《天道》\"><a href=\"#《遥远的救世主》–电视剧《天道》\" class=\"headerlink\" title=\"《遥远的救世主》–电视剧《天道》\"></a>《遥远的救世主》–电视剧《天道》</h1><h2 id=\"文化属性\"><a href=\"#文化属性\" class=\"headerlink\" title=\"文化属性\"></a>文化属性</h2><ul>\n<li>透视社会依次有三个层次 <em>技术，制度和文化。小到一个人，大到一个国家一个民族，任何一种命运归根到底都是那种文化属性的产物。强势文化造就强者，弱势文化造就弱者，这就是规律，也可以理解为天道，不以人的意志为转移</em> 。</li>\n<li>强势文化就是遵循事物规律的文化，弱势文化就是依赖强者的道德期望破格获取的文化，就是期望救世主的文化。强势文化在武学上被称为“秘籍”, 而弱势文化由于易学、易懂、易用，成了流行品种。</li>\n<li>比如说文化产业，文学、影视是扒拉灵魂的艺术，如果文学、影视的创作能破解更高思维空间的文化密码，那么它的功效就是启迪人的觉悟、震撼人的灵魂，这就是众生所需，就是功德、市场、名利，精神拯救的暴利与毒品麻醉的暴利完全等值，而且不必像贩毒那样耍花招，没有心理成本和法律风险。 </li>\n<li>没有 <em>主</em> ，主义、主意从哪里来？主无处不在，简单地说， <em>支配人的价值取舍行为的那个东西就是主，就是文化属性</em> 。</li>\n<li><em>文明</em> 对于不能以人字来界定的人无能为力。</li>\n<li>死马当做活马医，再糟，死马还能再死一回吗？</li>\n<li>股票的暴利并不产生与生产经营，而是产生与股票市场本身的 <em>投机性</em> 。它的运作动力是：把你口袋里的钱装到我的口袋里去。它的规则是：把大多数羊的肉填到极少数狼的嘴里。</li>\n<li>法律机器的运作不以口供为条件。法律对程序和内容要求极限的严谨。</li>\n<li>强盗的逻辑，直接获取，冒险，刺激。</li>\n<li>强盗的本质是破格获取， <em>破格获取</em> 和 <em>直接获取</em> 是两个不同的概念。你们没有自信与强者在同一个规则下公平竞争，这只能说明你是弱者，因为弱者文化所追求的最高价值就是破格获取。所以，强盗的逻辑从本质上讲是最懦弱的生存哲学。</li>\n<li>拯救灵魂是《圣经》的买卖。</li>\n<li>《圣经》的理由是：因信着得救了，上天堂；因不信有罪了，下地狱。用这种哄孩子的、吓汉子的方法让人去信，虽有利于基督教的实践，却也迎合了人的怕死的一面、贪婪的一面。这样的因果关系已经不给人以自觉、自省的机会，人连追求高尚的机会都没有，又何以高尚呢？</li>\n<li>神是什么？神是根据人的需要造出来的。（容我仿一下：鬼是什么？鬼是根据人的恐惧造出来的。）</li>\n<li>《圣经》神学是关于人类精神的学说，是关于人的灵魂净化、升华，人的行为高尚、正典的学说。一味地攻击或捍卫神的真实性与否，都是愚昧的表现。前者没有理解基督教的历史价值和社会价值，后者没有理解基督教的真正境界。</li>\n<li>神是什么？  <em>神即道，道法自然，如来</em>  。</li>\n<li><em>你不知道你，所以你是你，如果你知道了你，你就不是你了。</em></li>\n<li>这世上原本就没什么神话，所谓的 <em>神话</em> 不过是常人的思维所不易理解的平常事。</li>\n<li>无论做什么，市场都不是一块无限大的蛋糕。神话的实质就是强力作用的杀富济贫。这就可能产生两个问题，一是杀富是不是破坏性开采市场资源？二是让井底的人扒着井沿看了一眼再掉下去是不是让他患上精神绝症。</li>\n<li>佛家常说“ <em>证到</em> ”这个词，却从来不告诉你“证到”后面是什么，因为欲说欲解都不能，因为条件的条件的条件，因为因果的因果的因果，所以就有了如人饮水冷暖自知。</li>\n<li>这就是圆融世故，不显山不露水，各得其所。可品性这东西，今天缺个角、明天裂道缝，也就离塌陷不远了。</li>\n<li>社会对公司的好感也是商业好处的一部分。这不是道德境界问题，是市场生存的法则问题。这种好感不仅仅是我们强行摊派价值观，也不仅仅是腐蚀我们自身的竞争力，更说明我们不是靠产品征服市场而是靠作秀混迹市场，这种违背商业属性的人文评价最终将葬送这个公司。</li>\n<li><em>生存法则</em> 很简单，就是 <em>忍人所不能人，能人所不能</em> 。忍是一条线，能是一条线，两者的间距就是生存机会。如果我们忍人所不忍，能人所不能，咱们就比别人多了一些生存机会。市场的生存竞争非常残酷，胜负往往就在毫厘之间, <em>两败俱伤你比他多一口气，你就是赢家</em> 。（暗合围棋屠龙对杀）</li>\n<li>扬长避短，拾遗补缺，学会夹缝里面求生存。</li>\n<li>公司必须以不断开拓市场和完善服务来抵御市场风险。</li>\n<li>翻开历史看看，你从哪一行哪一页能找到救世主救世的记录。没有，从来就没有，从来都是救人的被救了，被救的救了人。如果一定要讲救世主的话，那么 <em>符合和代表客观规律的文化</em> 就是救世主。</li>\n<li>扶贫的本质在一个扶字，如果你压根就没有打算自己站起来，老天爷来了都没用。</li>\n<li><em>法无定法，存在决定意识</em> 。</li>\n<li><p>《悟》</p>\n<ul>\n<li>悟道休言天命，</li>\n<li>修行勿取真经。</li>\n<li>一悲一喜一枯荣，</li>\n<li>哪个前生注定？</li>\n<li>袈裟本无清净，</li>\n<li>红尘不染性空。</li>\n<li>幽幽古刹千年钟，</li>\n<li>都是痴人说梦。</li>\n</ul>\n</li>\n<li><p>所谓真经，就是能够打到寂空涅槃的究竟法门，可悟不可修。修为成佛，在求。悟为明性，在知。修行以行制性，悟道以性施行，觉者由心生律，修者以律制心。不落恶果者有信无证，住因住果，住念住心，如是生灭。不昧因果者无住而住，无欲无不欲，无戒无不戒, 如是涅槃。</p>\n</li>\n<li>佛乃觉性，非人，人人都有觉性不等于觉性就是人。人相可坏，觉性无生无灭，即觉即显,即障即尘弊，无障不显，了障涅槃。觉行圆满之佛乃佛教人像之佛，圆满即止，既非无量。若佛有量，即非阿弥陀佛。佛法无量即觉行无量，无圆无不圆，无满无不满，亦无是名究竟圆满。佛教以次第而分，从精深处说是得道天成的道法，道法如来不可思议，即非文化。从浅义处说是导人向善的教义，善恶本有人相、我相、众生相，即是文化。从众生处说是以贪治贪、以幻制幻的善巧，虽不灭败坏下流，却无碍抚慰灵魂的慈悲。</li>\n<li>坐，请坐，请上座。茶，上茶，上好茶。</li>\n<li>投石击水，不起浪花也泛涟漪，妙在以扶贫而命题。当有识之士骂你比强盗还坏的时候，责骂者，责即为诊，诊而不医，无异于断为绝症，非仁人志士所为，也背不起这更大的骂名。故而，责必论道。</li>\n<li>传统观念的死结就在一个 <em>靠</em> 字上，在家靠父母，出门靠朋友，靠上帝、靠菩萨、靠皇恩。。。。。。总之靠什么都行，就是别靠自己。这是一个沉积了几千年的文化属性的问题，非几次新文化运动就能开悟。</li>\n<li><em>大爱不爱</em></li>\n<li>弱势得救之道，也有也没有。没有竞争的社会就没有活力，而竞争必然会产生贫富、等级，此乃天道，乃社会进步的必然代价。无弱，强焉在？一个 <em>强</em>　字，　弱已经在其中了。故而，佛度心苦，修的是一个平常心。</li>\n<li><em>释、道、儒</em> 是中国传统文化的三大体系。传统文化毕竟是以皇恩浩荡为先决条件的文化，讲的都是 <em>皆空、无为、中庸</em> 的理，以抑制个性而求生求解。</li>\n<li>没有地狱，天堂焉在？总得有人在地狱呆着，咱们就算上一个，不然天堂就没有着落了。</li>\n<li>天下之道论到极致，百姓的柴米油盐。人生冷暖论到极致，男人女人的一个 <em>情</em> 字。</li>\n<li>佛说 <em>看山是山，看水是水</em> ，我只是依佛法如实观照，看摩登女郎是摩登女郎，看红颜知己是红颜知己。</li>\n<li>栏内是净，栏外是土，靠着栏杆就能抽烟。</li>\n<li>有人、有枪、有地盘，还愁没有番号吗？</li>\n<li><em>骆驼穿针</em> 的天堂(？没理解)</li>\n<li>你信神吗？ <em>了妄唯真</em> 即是神（了妄唯真?）了妄唯真,那神和人是什么关系？　不一不异</li>\n<li>旅游就是意图，开阔眼界、增长见识就是意图。</li>\n<li>想到了就做，该拿的拿该放的放，自性作为不昧因果。</li>\n<li>从现象参到制度、参到文化，因为任何一种命运，归根到底都是那种文化的产物。</li>\n<li>衡量一种文化属性不是看它沉淀的时间长短，而是看它与客观规律的距离远近。五千年的文化是光辉、是灿烂，这个没有问题，但是，传统和习俗得过过客观规律的筛子。</li>\n<li>有文化和有什么文化不是一个概念。</li>\n<li>不该作为的不作为就是作为，能活个明白就不错了。</li>\n<li>好声本身的魅力已经足够了，不在需要无谓的修饰和点缀。</li>\n<li>如果我的能力只能让我穷困潦倒，那穷困潦倒就是我的价值。</li>\n<li>每个人的立场、观念、心态和思维模式不一样，获取的信息量和解读信息的方式也不一样。</li>\n<li><em>好听</em> 就是艺术，只是每个人的好听标准不一样。</li>\n<li>能做到 <em>实事求是</em> 的就是神话。能说老实话，能办老实事的人就是神。</li>\n<li>神就是道，道就是规律, 规律如来，容不得你思议，按规律办事的人就是什么。</li>\n<li>人从根本上只面对两个问题： <em>一是生存，得活下来；二是得回答生命价值的问题，让心有个安住</em> 。</li>\n<li>5年之后我不嫌你老，你就可以不老了吗？５年以后我变成了一个色狼，值得你回头看一眼吗?</li>\n<li>不以求职应聘为生。要学位意义不大，应该什么有用学什么。</li>\n<li>不管是文化艺术还是生存艺术，有道无术，术尚可求也。有术无道，止于术。</li>\n<li><em>立志要高，挖掘要深。</em></li>\n<li>外国不是我们家的厨房，不是我想进就进。有钱的男人也不是菜市场里的鸡蛋，不是我想抓一个就抓一个。</li>\n<li>马太效应： <em>你有，给你更多；你没有，把你原来的都拿走</em></li>\n<li>当人一旦从危险里跳出来，他就不再去关注这个事物的危险了，他的目光就会全部落在这个事物的利益人上，这就是人。</li>\n</ul>\n","categories":[],"tags":["点滴","读书"]},{"title":"《失控》","url":"http://chenyangguang.github.com/2017-09-01-Out-of-Control/","content":"<h1 id=\"《失控》–-全人类的最终命运和结局？\"><a href=\"#《失控》–-全人类的最终命运和结局？\" class=\"headerlink\" title=\"《失控》– 全人类的最终命运和结局？\"></a>《失控》– 全人类的最终命运和结局？</h1><h2 id=\"自我能动\"><a href=\"#自我能动\" class=\"headerlink\" title=\"自我能动\"></a>自我能动</h2><ul>\n<li>有机体既是它自己的因也是它自己的果，既是它自己固有的秩序和组织的因，也是其固有秩序和组织的果。</li>\n<li>每一个 <em>自我</em> 都是一个同义反复：自明、自指、以自己为中心并且自己创造自己。</li>\n<li>一个 <em>系统</em> ，就是任何一种能够自说自话的东西。</li>\n<li>自动控制三个阶段<ul>\n<li>由蒸汽机所引发的能量控制的第一阶段</li>\n<li>对物质的精确控制是第二阶段</li>\n<li>对信息本身的控制是第三阶段</li>\n</ul>\n</li>\n<li>21 世纪的核心事件，是对 <em>信息的颠覆</em> 。</li>\n<li>自动化的历史，就是一条 <em>从人类控制到自动控制</em> 的单向通道。其结果就是从人类的自我到第二类自我的不可逆转的转移。而第二类自我是在我们控制之外的，是失控的。</li>\n<li>具有自我适应能力、像自己的目标进化、不受人类监管自行成长的机器，将会是下一个巨大的技术进步。要想获得有智能的控制，唯一的办法就是给机器自由。</li>\n<li>有些事必须先做，而且要按 <em>正确的次序</em> 去做。</li>\n<li><em>复杂的机器必定是逐步地，而且往往是间接地完善的。别指望通过一次华丽的组装就能完成整个工作正常的机械系统。你必须首先制作一个可运行的系统，再以此为平台研制你真正想完成的系统</em> (精辟呀!微信,Facebook也是一步步来的)。</li>\n</ul>\n<h2 id=\"密封的瓶装生命\"><a href=\"#密封的瓶装生命\" class=\"headerlink\" title=\"密封的瓶装生命\"></a>密封的瓶装生命</h2><ul>\n<li>一天就可以摧毁的东西，要想建成它，可能会需要几年甚至几个世纪的时间。</li>\n<li>复杂性的开端根植于混沌之中。不过，如果复杂系统能够在一段时间的互相迁就之后获得共同的 <em>平衡</em> ，那么之后就再没有什么能够让它脱离轨道了。(是不是和习惯一样？一旦养成了自己固定的生活习惯，思维习惯，就会潜意识地贯彻下去。)</li>\n<li>“封闭”意味着与流动隔绝。一个真正的封闭系统，是不会参与外部元素流动的; 换句话，它所有的循环都是自治的。</li>\n<li>“系统”意味着相互 <em>连通</em> 。系统中的事物是相互纠结的，直接或者间接地连接到一个共同的命运。</li>\n<li><em>“存活”意味着惊喜</em> 。</li>\n<li>静态才是生态球的常态。</li>\n<li>生态球按比例放大后仍很完好。生态球越大，达到稳定所需时间就越长，破坏它也就越困难。只要处于正常状态，一个活系统的集体代谢过程就会扎下根，然后一直持续下去。</li>\n</ul>\n<h2 id=\"生态技术玻璃球\"><a href=\"#生态技术玻璃球\" class=\"headerlink\" title=\"生态技术玻璃球\"></a>生态技术玻璃球</h2><ul>\n<li>生命经营的事业就是改造环境使其有益于生命。如果你能把生命聚拢成为一个群落，给它们充分的自由制造自己茁壮成长所需的条件，这个生物集合体就能一直生存下去，也没有必要知道它是怎样运转的。</li>\n<li>对于任何一个复杂、危险的项目来说，最理想的团队人数是８个人。超过８个人，会造成决策缓慢和耽搁；而少于８个人，突发事件或者疏忽大意就会变成严重的阻碍。</li>\n<li>细节是至关重要的东西。</li>\n<li>生命的任何领域都是由数不清的独立的回路编织而成的。</li>\n</ul>\n<h2 id=\"合成生态系统\"><a href=\"#合成生态系统\" class=\"headerlink\" title=\"合成生态系统\"></a>合成生态系统</h2><ul>\n<li>一旦你改变了生态系统，　并找到适合播种的的种子，以及必不可少的气候窗口，改变就开始了，而且这是不可逆转的。这个合成的生态系统持续运转下去并不需要人的存在，它不受干扰仍会保持下去。</li>\n<li>创造生物圈：<ul>\n<li>微生物做绝大部分的工作</li>\n<li>土壤是有机体, 它是活的。它会呼吸。</li>\n<li>创造【冗余】的食物网络</li>\n<li>逐步地增加多样性</li>\n<li>如果不能提供一种物理功能，就需要模拟一个类似的功能</li>\n<li>大气会传达整个系统的状态</li>\n<li>聆听系统，看看它要去哪里</li>\n</ul>\n</li>\n<li>所有的封闭系统都是会被打开的，至少会出现泄露。(也就是: 不存在绝对封闭系统)<h2 id=\"冒出的生态圈\"><a href=\"#冒出的生态圈\" class=\"headerlink\" title=\"冒出的生态圈\"></a>冒出的生态圈</h2></li>\n<li>人体本身就是一个巨大的复杂系统。我们从自然中获得的施与是令人难以置信的。</li>\n<li>扰动是生态的必要催化剂。</li>\n<li>我们究竟可以切断多少的联系，还能保持一个物种的生存。</li>\n<li>命运始终具有讽刺意味。</li>\n<li>顺其自然就好。</li>\n<li>大气是极其重要的环境因素，大气产生生命，生命也可以产生大气。</li>\n<li>不要着急，不要在系统自组织的时候就急着催它孕育。你能给它的最重要的东西就是 <em>时间</em> 。</li>\n<li>所有复杂的共同进化系统都需要“ <em>冒出</em> ”。</li>\n<li>可以通过逐渐提高复杂性来重组大型系统；一旦一个系统达到了稳定水平，它就不会轻易地趋向于倒退，仿佛这个系统被新的复杂性带来的凝聚力所“吸引”。人类组织，比如团队和公司，也显示出 “ <em>冒出</em> “的特征。</li>\n<li><em>生命就是技术</em> 。机器技术只不过是生命技术的临时替代品而已。随着我们对机器的改进，他们会变得更有机，更生命化，更近似生命， <em>因为生命是生物的最高技术</em> 。总有一天，机器和生物间的差别会很难区分。</li>\n</ul>\n<h2 id=\"看不见的智能\"><a href=\"#看不见的智能\" class=\"headerlink\" title=\"看不见的智能\"></a>看不见的智能</h2><ul>\n<li>最深刻的技术是那些看不见的技术，它们讲自己编织进日常生活的细枝末节之中，直到成为生活的一部分。书写的技术走下精英阶层，不断放低身段，从我们的注意力中淡出。</li>\n<li>电脑的胜利不但不会使世界非人化，反而会使环境更臣服于人类的愿望。我们创造的不是机器，而是讲我们所学所能融会贯通于其中的机械化环境。我们在将自己的生命延伸到周边环境中去。</li>\n<li>缺少了隐私技术的网络文化是无法兴旺的。</li>\n<li>哪里有生态系统，哪里就有精通本地事务的生命。</li>\n<li>人类渴求隐私，但事实上，我们的社会性胜过独立性。如果机器也像我们这样互相了解（甚至是一些很私密的事情），那么机器生态就是不可征服的。</li>\n<li>自然界没有垃圾问题，因为物尽其用。</li>\n<li>想大自然一样从事。</li>\n<li>机器是整体系统, 强调系统效率最大化。将自然环境的模式作为解决环境问题的模板。</li>\n<li>尽可以将所有能想到的废物都看作是潜在的原材料。任何在当下没有用的材料，都可以通过设计从源头将它消除。</li>\n<li>生态技术即使带不来令人震惊的利润，也会带来一定的成本收益。</li>\n<li>工业将无可避免地采用生物方式<ul>\n<li>它能用更少的材料造出更好的东西。</li>\n<li>自然是掌控复杂性的大师，在处理杂乱、反直观的网络方面给我们以无价的引导。未来的人造复杂系统为了能够运转，必然会有意识地注入有机原则。</li>\n<li>大自然是不为所动的，所以必须去适应她。</li>\n<li>自然界本身－－基因和各种生命形式－－与工业系统一样能够被工程化（或模式化）。</li>\n<li>生物学是一个必然－－近于数学的必然，所有复杂性归向的必然。它是一个欧米茄（Omega）点。在天生和人缓慢的混合过程中，有机是一种显性性状，而机械是隐性性状。最终，获胜的总是生物逻辑。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"信息工厂\"><a href=\"#信息工厂\" class=\"headerlink\" title=\"信息工厂\"></a>信息工厂</h2><ul>\n<li>一个纯粹网络化的公司，应该具备这些特点<ul>\n<li>分布式</li>\n<li>去中心化</li>\n<li>协作</li>\n<li>可适应性</li>\n</ul>\n</li>\n<li>在大多数情况下，真正的财富都是通过把某种流程置于集中控制之下而获得的。越大，效率越高。</li>\n<li>如果把一个任务拆分成若干块交给不同的公司来完成，若想保持质量的话，所需的交易成本要高于在一个公司内完成这项任务的成本。</li>\n</ul>\n<h2 id=\"与错误打交道\"><a href=\"#与错误打交道\" class=\"headerlink\" title=\"与错误打交道\"></a>与错误打交道</h2><ul>\n<li>软件的编制遵循三个中心化的关键步骤。<ul>\n<li>首先设计一个全景图</li>\n<li>然后用代码实现细节</li>\n<li>最后，在接近项目尾声的时候，将其作为交互的整体来进行测试。</li>\n</ul>\n</li>\n<li>绝对不可能避免错误，但是可以避免错误成为缺陷。零缺陷设计的人物就是尽早发现错误，尽早改正错误。真正的改进在于尽早发现产生错误的原因，并尽早清除产生错误的原因。犯错的是人，处理错误的是系统。</li>\n<li>当你发现一个错误的时候，也就意味着还有另外一堆你没看见的错误在什么地方等着你。</li>\n<li>新生物学的解决之道是用一个个可以正常的单元来搭建程序性。</li>\n<li>一个好的程序员可以对任何一个已知的、规律的软件进行重写，巧妙地减少代码。但是，在创造性编程过程中，没有任何已经被完全理解的东西。</li>\n</ul>\n<h2 id=\"联通所有的一切\"><a href=\"#联通所有的一切\" class=\"headerlink\" title=\"联通所有的一切\"></a>联通所有的一切</h2><ul>\n<li>新兴网络经济具备的特征<ul>\n<li>分布式核心</li>\n<li>适应性技术</li>\n<li>灵活制造</li>\n<li>批量化的定制</li>\n<li>工业生态学</li>\n<li>全球会计</li>\n<li>共同进化的消费者</li>\n<li>以知识为基础</li>\n<li>免费的带宽</li>\n<li>收益递增</li>\n<li>数字货币</li>\n<li>隐性经济</li>\n</ul>\n</li>\n<li>这个时代里，最核心的行为就是把所有的东西都联结在一起。</li>\n</ul>\n<h2 id=\"密码无政府状态\"><a href=\"#密码无政府状态\" class=\"headerlink\" title=\"密码无政府状态\"></a>密码无政府状态</h2><ul>\n<li>要阻止信息的越界流动是一件毫无希望的事情。</li>\n<li>在信息时代，情报成为企业最主要的财富。</li>\n</ul>\n<h2 id=\"数字货币\"><a href=\"#数字货币\" class=\"headerlink\" title=\"数字货币\"></a>数字货币</h2><ul>\n<li>消费历史可以被用来构成一份精准且极具市场推广价值的档案。</li>\n<li>真正的数字现金是真钱，具有现金的私密性和电子的灵活性。</li>\n<li>安全性和私密性是矛盾的两面。</li>\n<li>信息流动到哪里，货币肯定也会跟随其后。货币是另一类信息，一种小型的控制方式。</li>\n<li>真正的数字现金，或者更准确地说，真正的数字现金所需要的经济机制，将会重新构造我们的经济、通讯以及知识。</li>\n</ul>\n","categories":[],"tags":["读书"]},{"title":"Emacs 漫步-- org-mode 二三事之 link","url":"http://chenyangguang.github.com/2017-08-15-emacs-org/","content":"<h2 id=\"org-link\"><a href=\"#org-link\" class=\"headerlink\" title=\"org-link\"></a>org-link</h2><p>emacs 内使用 Alt + X 调起 helm 界面。 helm 界面可以在输入模式下直接调起。不像vim。 输入 org-link 可以看到各种有关 org-mode 下 link 相关的操作。helm 非常友好，只要输入相关关键字的命令名称，就给列出来所有包含这个关键字的命令了。而且输入这些关键字查询的时候, 可以不分次序!</p>\n<p>org-mode 下的 link 是这样款式的 [[<a href=\"http://www.gnu.org/software/emacs/][GNU\" target=\"_blank\" rel=\"noopener\">http://www.gnu.org/software/emacs/][GNU</a> Emacs]], <a href=\"markdown的链接方式\">http://wowubuntu.com/markdown/</a>, 大同小异。正常情况下 org-link 带有三个中括号，内部第一个中括号是链接地址，可以是文件路径，图片地址，http 超链接，第二个中括号是这个链接的描述，描述可以为空 如 [[<a href=\"http://www.gitvim.com]]。\" target=\"_blank\" rel=\"noopener\">http://www.gitvim.com]]。</a></p>\n<p>列举几个常用的 link 操作: </p>\n<ol>\n<li><p>org-insert-link<br>顾名思义， 添加一个带有链接和描述的超链接文案, 先输入 link, 然后是 description。</p>\n</li>\n<li><p>org-toggle-link-display<br>可以切换 link 和 description 之间的显示, 方便修改描述和链接地址。 </p>\n</li>\n<li><p>org-store-link<br>用于…这个诡异</p>\n</li>\n<li><p>org-previous-link &amp; org-next-link<br>双胞胎, 前后跳转到链接的命令。</p>\n</li>\n</ol>\n<h2 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h2><p>Emacs 这种程序国之重器, 思量之，适可而止。</p>\n","categories":[],"tags":["Emacs","编辑器"]},{"title":"Emacs 漫步-- 快捷键入口","url":"http://chenyangguang.github.com/2017-07-21-emacs/","content":"<h2 id=\"Space-系列\"><a href=\"#Space-系列\" class=\"headerlink\" title=\"Space 系列\"></a>Space 系列</h2><p>空格键 space 开始的快捷键非常多, 查看方式，敲下 Space 键，瞬间出来第一层以 space 为绑定的快捷键。 之后，还有以关键字打头阵的第二层快捷键。</p>\n<h3 id=\"f-系列\"><a href=\"#f-系列\" class=\"headerlink\" title=\"+f 系列\"></a>+f 系列</h3><p> 就是和文件相关的。需要直接在 emacs 内部使用 sudo 命令编辑的文件，可以使用 <em>space + f + E</em> 启动。</p>\n<h3 id=\"p-系列是和项目有关联的，\"><a href=\"#p-系列是和项目有关联的，\" class=\"headerlink\" title=\"+p 系列是和项目有关联的，\"></a>+p 系列是和项目有关联的，</h3><p>如 +p 进去，发现 <em>space+p+t</em> 就是查看根目录的 nerdtree 文件目录管理。</p>\n<h3 id=\"b-buffer-系列\"><a href=\"#b-buffer-系列\" class=\"headerlink\" title=\"+b buffer 系列\"></a>+b buffer 系列</h3><p>直接 space+b+b 最近编辑过的文件的 buffer 一览无余。</p>\n<h3 id=\"g-git-系列\"><a href=\"#g-git-系列\" class=\"headerlink\" title=\"+g git 系列\"></a>+g git 系列</h3><p>各种操作 git 命令的快捷键。下雨天，magit 和 emacs 更配哟。</p>\n<h3 id=\"h-帮助\"><a href=\"#h-帮助\" class=\"headerlink\" title=\"+h 帮助\"></a>+h 帮助</h3><p>space+h 是各种 emacs 快捷键的前置快捷键</p>\n<h3 id=\"shell-命令快捷键\"><a href=\"#shell-命令快捷键\" class=\"headerlink\" title=\"+! shell 命令快捷键\"></a>+! shell 命令快捷键</h3><p>直接执行 shell 命令。So cool~</p>\n<h3 id=\"n-数字窗口切换\"><a href=\"#n-数字窗口切换\" class=\"headerlink\" title=\"+n 数字窗口切换\"></a>+n 数字窗口切换</h3><p>就是以窗口序号 1-n 之间的切换。</p>\n<p><img src=\"https://raw.githubusercontent.com/chenyangguang/StudyNotes/master/photos/space.png\" alt=\"space快捷键大观园\"><br><a id=\"more\"></a></p>\n<h2 id=\"Ctrl-c-系列\"><a href=\"#Ctrl-c-系列\" class=\"headerlink\" title=\"Ctrl+c 系列\"></a>Ctrl+c 系列</h2><p>ctrl + c 系列， 有大量 org-mode 和 markdown 的玩法。<br>比如 <em>ctrl+c+t</em> 进行 todo-list 的进度管理</p>\n<p><img src=\"https://github.com/chenyangguang/StudyNotes/blob/master/photos/ctrl-c.png?raw=true\" alt=\"ctrl+c 系列快捷键\"></p>\n<h2 id=\"Ctrl-x-系列\"><a href=\"#Ctrl-x-系列\" class=\"headerlink\" title=\"Ctrl+x 系列\"></a>Ctrl+x 系列</h2><p><img src=\"https://github.com/chenyangguang/StudyNotes/blob/master/photos/ctrl-x.png?raw=true\" alt=\"ctrl+x系列\"></p>\n<h2 id=\"逗号系列\"><a href=\"#逗号系列\" class=\"headerlink\" title=\", 逗号系列\"></a>, 逗号系列</h2><p><img src=\"https://github.com/chenyangguang/StudyNotes/blob/master/photos/douhao.png?raw=true\" alt=\"逗号系列\"><br>比如快速的插入一个 markdown 格式图片使用 <em>,+i+i</em><br><!--more--></p>\n<h2 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h2><p>一句话: 玩溜了，Emacs 之内，舒服。</p>\n","categories":[],"tags":["Emacs","编辑器"]},{"title":"Hexo blog begin","url":"http://chenyangguang.github.com/2017-05-01-hello-world/","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n","categories":[],"tags":["点滴"]},{"title":"瑞士军刀片 awk","url":"http://chenyangguang.github.com/2017-04-25-awk/","content":"<h3 id=\"awk-起源之美女选男朋友\"><a href=\"#awk-起源之美女选男朋友\" class=\"headerlink\" title=\"awk 起源之美女选男朋友\"></a>awk 起源之美女选男朋友</h3><p>说起瑞士军刀，可能很多人都听腻了。 有说 Emacs 是瑞士军刀的， 有说 Vim 也是瑞士军刀， 有说 Python 是瑞士军刀的。但是让我们暂时抛开对瑞士军刀的兴趣, 来拨弄一下一页小小的瑞士军刀片– awk。这个小家伙是一门小巧玲珑的特殊的编程语言。<br><a id=\"more\"></a></p>\n<p>不可我， 总结了一个最好的认识新事物的方法: 迎面冲上去。<br>看下面这组相亲数据 gfs.data : </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Li 65 177 10000</span><br><span class=\"line\">Wang 77 180 8000</span><br><span class=\"line\">Niu 60 199  20000</span><br><span class=\"line\">Chen 64.5 168 5000</span><br><span class=\"line\">Ouyang 80 200 12000</span><br><span class=\"line\">Liu 72.5 182 9999</span><br></pre></td></tr></table></figure>\n<p>这片小数据里面包含几个字段， 人名，体重，身高, 月收入的数据。 比如美女需要从这里挑选男朋友标准，怎么选出这里面身高 177 以上的高富帅呢？ </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos; $3 &gt; 177 &#123; print $1,$3&#125;&apos; gfs.data </span><br><span class=\"line\">Wang 180</span><br><span class=\"line\">Niu 199</span><br><span class=\"line\">Ouyang 200</span><br><span class=\"line\">Liu 182</span><br></pre></td></tr></table></figure>\n<p> tmp 是临时目录，这个是 zsh 里面的一个短路径，略过。 awk 程序的结构是 <em>pattern { action }</em> 的结构。<br>它会默认将字段看作非空白字符组成的序列。（所以你看那些中间的安安静静的空格，被当成是空气了。）剩下的，第一个字段姓名，就是 <em>$1</em>, 第二个体重是 <em>$2</em>, 177， 180, 199, 168, 200,182这些身高值就是 <em>$3</em>了, 依次类推下去。 整个一行是 $0。每个人的颜值，身家是可能不一样的, 也就是说 <em>$n</em> 的值长度是不一定一致的。</p>\n<p> 单引号包起来的 <em>$3 &gt; 177</em> 是对每行扫描匹配的条件。当扫到 Wang 时， 很明显这家伙 180 超出预期值，需要多瞄几眼，看是否是 “八字” 合的来的真名天子，被挑出来了。按照这个模式一直搜到最后行， Liu 这个哥儿们也中彩了。<br>如果这位美女眼光比较高，她找男朋友的条件比较多，比如，收入要高，体重要匀称，智商要高等， 这样的话，最好是将她的条件给写到一个文件里面去， 名值曰: conditions.data。一次给她选中得意郎君。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">awk -f conditions.data gfs.data</span><br></pre></td></tr></table></figure>\n<p><em>-f</em> 表示从文件中提取程序，这个标准可以给多个姑娘参考, 选, 不中？不要， 中？ 要得！ 选…..选…..海选!</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">awk -f progfile optionnal list of files</span><br></pre></td></tr></table></figure>\n<p>那么选择的条件一多了， 不想一条条罗列了，怎么给婚介所一个范围？ 用到字段的数量 <em>NF</em> 了。 <em>NF</em> 是 <em>Awk</em> 计算当前行的字段数量并存储的内建的变量。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk  &apos;&#123; print NF, $1, $NF &#125;&apos; gfs.data </span><br><span class=\"line\">4 Li 10000</span><br><span class=\"line\">4 Wang 8000</span><br><span class=\"line\">4 Niu 20000</span><br><span class=\"line\">4 Chen 5000</span><br><span class=\"line\">4 Ouyang 12000</span><br><span class=\"line\">4 Liu 9999</span><br></pre></td></tr></table></figure>\n<p>这就打出每一个 boy 的 考察的条件数量，姓名，月收入了。直接拿这条件去撒网了。</p>\n<p>打印真名天子所在的相亲次序 <em>NR</em>, 也是一个内建变量，是计算到目前为止，读取到的行的数量, 这里就是相亲的次数（假设这妹子每次相亲都换人）。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;&#123;print NR, $0&#125;&apos;  gfs.data</span><br><span class=\"line\">1 Li 65 177 10000</span><br><span class=\"line\">2 Wang 77 180 8000</span><br><span class=\"line\">3 Niu 60 199  20000</span><br><span class=\"line\">4 Chen 64.5 168 5000</span><br><span class=\"line\">5 Ouyang 80 200 12000</span><br><span class=\"line\">6 Liu 72.5 182 9999</span><br></pre></td></tr></table></figure>\n<p>这几个的条件呢？ </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;$4 &gt; 10000 &#123;print &quot;很有钱的人:&quot;, $1, &quot; 月收入:&quot;, $4 &#125;&apos; gfs.data  </span><br><span class=\"line\">很有钱的人: Niu  月收入: 20000</span><br><span class=\"line\">很有钱的人: Ouyang  月收入: 12000</span><br></pre></td></tr></table></figure>\n<p>人太多了，薪资位数不好比较，毕竟 0 太多了嘛! 筛选一下并格式化一下， 怎么搞？ printf(format, val_1, val_2, val_3, …, val_n), </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;&#123;printf(&quot;%-8s 的月薪是 ￥%10.2f\\n&quot;, $1,$4)&#125;&apos; gfs.data</span><br><span class=\"line\">Li       的月薪是 ￥  10000.00</span><br><span class=\"line\">Wang     的月薪是 ￥   8000.00</span><br><span class=\"line\">Niu      的月薪是 ￥  20000.00</span><br><span class=\"line\">Chen     的月薪是 ￥   5000.00</span><br><span class=\"line\">Ouyang   的月薪是 ￥  12000.00</span><br><span class=\"line\">Liu      的月薪是 ￥   9999.00</span><br></pre></td></tr></table></figure>\n<p>哎呀，还是看不清谁是优质男嘛，来，排下他们的薪资高低。 薪水往地处走，人往高处挑呀！ 用管道命令 <em>sort</em> 。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;&#123;printf(&quot; %10.2f %s\\n&quot;, $4, $0)&#125;&apos; gfs.data | sort -n</span><br><span class=\"line\">    5000.00 Chen 64.5 168 5000</span><br><span class=\"line\">    8000.00 Wang 77 180 8000</span><br><span class=\"line\">    9999.00 Liu 72.5 182 9999</span><br><span class=\"line\">   10000.00 Li 65 177 10000</span><br><span class=\"line\">   12000.00 Ouyang 80 200 12000</span><br><span class=\"line\">   20000.00 Niu 60 199  20000</span><br></pre></td></tr></table></figure>\n<p>原来牛哥是这里边最有 “钱途” 的！ 既然有三个是万元薪资的了，就先锁定他们了。毕竟谁会跟钱过不去？但是不能光看工资啊，要是这人是武大郎怎么办或者√2怎么办？ 不行，还是慎重一点，高开低走，190以上的，能过眼。长大了能像郎平和朱婷一样打排球，或者弄个小姚明？ 再加点条件吧： AND, OR 和 NOT, 用 &amp;&amp;, || 和 !</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;$4 &gt;=10000 &amp;&amp; $3 &gt; 190 &#123; print $0&#125;&apos; gfs.data</span><br><span class=\"line\">Niu 60 199  20000</span><br><span class=\"line\">Ouyang 80 200 12000</span><br></pre></td></tr></table></figure>\n<p>这个输出少了一个醒目的标题, 说不定有妹子错将体重看成是腰围呢？为避免不必要的误解发生，还是加个头吧。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;BEGIN &#123;print &quot;姓名 体重 身高 薪水&quot;; print &quot;&quot;&#125;&#123;print($0)&#125;&apos; gfs.data        </span><br><span class=\"line\">姓名 体重 身高 薪水</span><br><span class=\"line\"></span><br><span class=\"line\">Li 65 177 10000</span><br><span class=\"line\">Wang 77 180 8000</span><br><span class=\"line\">Niu 60 199  20000</span><br><span class=\"line\">Chen 64.5 168 5000</span><br><span class=\"line\">Ouyang 80 200 12000</span><br><span class=\"line\">Liu 72.5 182 9999</span><br></pre></td></tr></table></figure></p>\n<p>哎呀，提前到约会地点了，闲着没事干，要么比较一下这些人的平均工资？</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;&#123;salary = salary + $4&#125; END &#123;print NR, &quot;个人&quot;;  print &quot;总共月薪：&quot;, salary; print &quot;平均月 薪:&quot;, salary/NR&#125;&apos; gfs.data        </span><br><span class=\"line\">6 个人</span><br><span class=\"line\">总共月薪： 64999</span><br><span class=\"line\">平均月薪: 10833.2</span><br></pre></td></tr></table></figure>\n<p>还不错嘛！人还没来，将所有相亲的人名品起来能组成一首诗么？ </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;&#123;names = names $1 &quot; &quot;&#125; END &#123;print names &#125;&apos;  gfs.data</span><br><span class=\"line\">Li Wang Niu Chen Ouyang Liu</span><br></pre></td></tr></table></figure>\n<p>好吧，并没有。这些人名有多少笔画?啊不，是有几个字母组成？ </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos; &#123;print $1, length($1) &#125; &apos; gfs.data</span><br><span class=\"line\">Li 2</span><br><span class=\"line\">Wang 4</span><br><span class=\"line\">Niu 3</span><br><span class=\"line\">Chen 4</span><br><span class=\"line\">Ouyang 6</span><br><span class=\"line\">Liu 3</span><br></pre></td></tr></table></figure>\n<h3 id=\"军刀的流程\"><a href=\"#军刀的流程\" class=\"headerlink\" title=\"军刀的流程\"></a>军刀的流程</h3><p>if-else 筛筛 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;$4 &gt; 10000 &#123;n =  n + 1; salary = salary + $4 &#125;&#123; if (n &gt; 0 &amp;&amp; $4 &gt; 10000)  print $1, &quot;你有戏哟&quot;; else &#123;print $1, &quot;你被out了&quot;&#125; &#125;&apos; gfs.data</span><br><span class=\"line\">Li 你被out了</span><br><span class=\"line\">Wang 你被out了</span><br><span class=\"line\">Niu 你有戏哟</span><br><span class=\"line\">Chen 你被out了</span><br><span class=\"line\">Ouyang 你有戏哟</span><br><span class=\"line\">Liu 你被out了</span><br></pre></td></tr></table></figure>\n<p>while 循环, 从头梳理一边<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">awk &apos;&#123; line[NR] = $0 &#125; END &#123; i = NR ;while (i&gt;0) &#123; print line[i]; i = i - 1 &#125;&#125; &apos; gfs.data</span><br><span class=\"line\">Liu 72.5 182 9999</span><br><span class=\"line\">Ouyang 80 200 12000</span><br><span class=\"line\">Chen 64.5 168 5000</span><br><span class=\"line\">Niu 60 199  20000</span><br><span class=\"line\">Wang 77 180 8000</span><br><span class=\"line\">Li 65 177 10000</span><br></pre></td></tr></table></figure></p>\n<p>for  九九归一<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;BEGIN &#123;for (i=1; i &lt;=9; ++i) print i&#125;&apos;                            </span><br><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"实用“片刀式”\"><a href=\"#实用“片刀式”\" class=\"headerlink\" title=\"实用“片刀式”\"></a>实用“片刀式”</h3><p>输入行的总行数</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;END &#123; print NR&#125;&apos; gfs.data</span><br><span class=\"line\">6</span><br></pre></td></tr></table></figure>\n<p>打印第四行 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos; NR == 4 &apos; gfs.data</span><br><span class=\"line\">Chen 64.5 168 5000</span><br></pre></td></tr></table></figure>\n<p>输出每一行最后一个字段 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos; &#123;print $NF&#125;&apos; gfs.data</span><br><span class=\"line\">10000</span><br><span class=\"line\">8000</span><br><span class=\"line\">20000</span><br><span class=\"line\">5000</span><br><span class=\"line\">12000</span><br><span class=\"line\">9999</span><br></pre></td></tr></table></figure>\n<p>打印最后一行的最后一个字段</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;&#123;field = $NF&#125; END &#123; print field &#125;&apos;  gfs.data</span><br><span class=\"line\">9999</span><br></pre></td></tr></table></figure>\n<p>打印字段数多于 3 个的输入行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;NF&gt;3&apos; gfs.data</span><br><span class=\"line\">Li 65 177 10000</span><br><span class=\"line\">Wang 77 180 8000</span><br><span class=\"line\">Niu 60 199  20000</span><br><span class=\"line\">Chen 64.5 168 5000</span><br><span class=\"line\">Ouyang 80 200 12000</span><br><span class=\"line\">Liu 72.5 182 9999</span><br></pre></td></tr></table></figure>\n<p>打印最后一个字段值大于10000的输入行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;$NF &gt; 10000 &apos; gfs.data </span><br><span class=\"line\">Niu 60 199  20000</span><br><span class=\"line\">Ouyang 80 200 12000</span><br></pre></td></tr></table></figure>\n<p>打印所有输入行的字段数的总和</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos; &#123;nf = nf + NF&#125; END &#123;print nf&#125; &apos; gfs.data</span><br><span class=\"line\">24</span><br></pre></td></tr></table></figure>\n<p>打印包含 /Niu/ 的行的数量</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos; /Niu/ &#123;nlines = nlines + 1&#125; END &#123;print nlines&#125;&apos; gfs.data</span><br><span class=\"line\">1</span><br></pre></td></tr></table></figure>\n<p>打印具有最大值的第4个字段，以及包含它的行(假设 $1 总是正的)</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;$4 &gt; max &#123; max=$4; maxline=$0 &#125; END &#123; print max, maxline &#125;&apos; gfs.data </span><br><span class=\"line\">20000 Niu 60 199  20000</span><br></pre></td></tr></table></figure>\n<p>打印至少包含一个字段的行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;NF &gt; 0&apos; gfs.data</span><br><span class=\"line\">Li 65 177 10000</span><br><span class=\"line\">Wang 77 180 8000</span><br><span class=\"line\">Niu 60 199  20000</span><br><span class=\"line\">Chen 64.5 168 5000</span><br><span class=\"line\">Ouyang 80 200 12000</span><br><span class=\"line\">Liu 72.5 182 9999</span><br></pre></td></tr></table></figure>\n<p>打印长度超过 20 个字符的行<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;length($0) &gt; 16&apos; gfs.data</span><br><span class=\"line\">Niu 60 199  20000</span><br><span class=\"line\">Chen 64.5 168 5000</span><br><span class=\"line\">Ouyang 80 200 12000</span><br><span class=\"line\">Liu 72.5 182 9999</span><br></pre></td></tr></table></figure></p>\n<p>每一行的前面加上它的字段数<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;&#123;print NF, $0&#125;&apos;  gfs.data</span><br><span class=\"line\">4 Li 65 177 10000</span><br><span class=\"line\">4 Wang 77 180 8000</span><br><span class=\"line\">4 Niu 60 199  20000</span><br><span class=\"line\">4 Chen 64.5 168 5000</span><br><span class=\"line\">4 Ouyang 80 200 12000</span><br><span class=\"line\">4 Liu 72.5 182 9999</span><br></pre></td></tr></table></figure></p>\n<p>打印每行第二，第一字段</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;&#123;print $2, $1&#125;&apos; gfs.data</span><br><span class=\"line\">65 Li</span><br><span class=\"line\">77 Wang</span><br><span class=\"line\">60 Niu</span><br><span class=\"line\">64.5 Chen</span><br><span class=\"line\">80 Ouyang</span><br><span class=\"line\">72.5 Liu</span><br></pre></td></tr></table></figure>\n<p>交换一个字段并打印整行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;&#123;tmp = $1; $1 = $2; $2 = tmp; print&#125;&apos; gfs.data</span><br><span class=\"line\">65 Li 177 10000</span><br><span class=\"line\">77 Wang 180 8000</span><br><span class=\"line\">60 Niu 199 20000</span><br><span class=\"line\">64.5 Chen 168 5000</span><br><span class=\"line\">80 Ouyang 200 12000</span><br><span class=\"line\">72.5 Liu 182 9999</span><br></pre></td></tr></table></figure>\n<p>每行的第一个字段用行号代替</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk  &apos;&#123;$1 = NR; print&#125;&apos; gfs.data</span><br><span class=\"line\">1 65 177 10000</span><br><span class=\"line\">2 77 180 8000</span><br><span class=\"line\">3 60 199 20000</span><br><span class=\"line\">4 64.5 168 5000</span><br><span class=\"line\">5 80 200 12000</span><br><span class=\"line\">6 72.5 182 9999</span><br></pre></td></tr></table></figure>\n<p>打印删除了第二个字段的行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;&#123;$2 == &quot;&quot;; print&#125;&apos; gfs.data</span><br><span class=\"line\">Li 65 177 10000</span><br><span class=\"line\">Wang 77 180 8000</span><br><span class=\"line\">Niu 60 199  20000</span><br><span class=\"line\">Chen 64.5 168 5000</span><br><span class=\"line\">Ouyang 80 200 12000</span><br><span class=\"line\">Liu 72.5 182 9999</span><br></pre></td></tr></table></figure>\n<p>每一行的字段按逆序打印</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;&#123; for (i=NF; i &gt; 0; i= i-1) &#123;printf(&quot;%s &quot;, $i)&#125; printf(&quot;\\n&quot;)&#125;&apos; gfs.data</span><br><span class=\"line\">10000 177 65 Li </span><br><span class=\"line\">8000 180 77 Wang </span><br><span class=\"line\">20000 199 60 Niu </span><br><span class=\"line\">5000 168 64.5 Chen </span><br><span class=\"line\">12000 200 80 Ouyang </span><br><span class=\"line\">9999 182 72.5 Liu</span><br></pre></td></tr></table></figure>\n<p>打印每一行的所有字段值之和</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;&#123;sum = 0; for (i=1; i &lt;=NF; i=i+1) &#123;sum = sum + $i&#125; print sum &#125;&apos; gfs.data</span><br><span class=\"line\">10242</span><br><span class=\"line\">8257</span><br><span class=\"line\">20259</span><br><span class=\"line\">5232.5</span><br><span class=\"line\">12280</span><br><span class=\"line\">10253.5</span><br></pre></td></tr></table></figure>\n<p>将所有行的所有字段值累加起来 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk  &apos;&#123;for (i=1; i&lt;=NF; ++i) sum += $i&#125; END &#123;print sum&#125;&apos; gfs.data</span><br><span class=\"line\">66524</span><br></pre></td></tr></table></figure>\n<p>将所有行的所有字段值的绝对值 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk  &apos;&#123;for (i=1; i&lt;=NF; ++i) if ($i &lt; 0) &#123;$i = -$i&#125; print &#125;&apos;                  </span><br><span class=\"line\">Li -65 -177 18000 # 这里手动输入带负数的值</span><br><span class=\"line\">Li 65 177 18000 # 返回</span><br></pre></td></tr></table></figure>\n<h3 id=\"Awk-语言之萝卜白菜\"><a href=\"#Awk-语言之萝卜白菜\" class=\"headerlink\" title=\"Awk 语言之萝卜白菜\"></a>Awk 语言之萝卜白菜</h3><p>输入一个文件 就叫 <code>radish.data</code> 吧, 这个文件大体就是这样的, 这个小节就用这个萝卜白菜来拌炒鱼肉吧<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk &apos;BEGIN &#123;print &quot;名称       重量 单价 分类\\n&quot;&#125; &#123;printf(&quot;%-10s %6.2f %2.2f %-1s\\n&quot;, $1, $2, $3, $4)&#125;&apos; radish.data</span><br><span class=\"line\">名称       重量 单价 分类</span><br><span class=\"line\"></span><br><span class=\"line\">Fish        30.00 8.50 Meat</span><br><span class=\"line\">Radish      14.00 1.20 Vegetables</span><br><span class=\"line\">Cabbage     24.00 1.50 Vegetables</span><br><span class=\"line\">Apple      100.00 2.50 Fruit</span><br><span class=\"line\">Onion        8.00 0.80 Vegetables</span><br><span class=\"line\">Banana      50.00 1.40 Fruit</span><br><span class=\"line\">Beef       120.00 22.00 Meat</span><br><span class=\"line\">Rice        40.00 10.00 Staple</span><br></pre></td></tr></table></figure></p>\n<p>首先需要明确的是 Awk 炒的模式，有这么几种, 看过awk 起源之美女选男朋友的话，应该有 <em>似曾相识燕归去</em>的感觉。<br><code>BEGIN {statements}</code><br>  在输入被读取之前， statements 执行一次 , 就是不管你是爆炒还是水煮， 甭管你是鱼还是肉，你给我先洗洗!准备好油盐酱醋碗, 跟你炒没关系！<br><code>END {statements}</code><br>当所有输入读取完毕之后， statements 执行一次, 还是老话，管你吃饱没吃饱，你给我付钱！<br><code>expression {statements}</code><br>每碰到一个判断 expression 为真的输入行， statements 就执行一遍做菜流程. expression 为真的是其值非零或非空, 就是检查一下你放盐了没，油是不是太多了? 七分熟还是八分熟？<br><code>/regular expression/ {statements}</code><br>当碰到正则匹配的输入行时， statements就执行: 输入行含有一段字符串，而该字符串可以被 regular expression 匹配。一句话，老老实实按照菜谱来，要是在菜里被找到有头发或者小强便便，你丫就死定了！<br><code>compound pattern {statements}</code><br>多种模式， &amp;&amp;(AND), ||(OR), !(NOT), 以及括号组合起来。 当 <code>compound pattern</code> 为真时，statements执行。就是你可以 翻炒+添醋， 或者烘烤， 但是别给我整半生不熟的。<br><code>pattern_1, pattern_2 {statements}</code><br>一个范围模式匹配多个输入行，从pattern1 开始， 到 pattern_2 结束（包括这两行）, 对其中每一行执行statements操作。 你能露几手的环节可能就是在生火后，起锅前, 这段时间段，是你的表演时刻啊。</p>\n<p>可以将你的七十二路炒菜法写下来， 放到 <code>cooking</code> 秘籍里,<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BEGIN &#123; </span><br><span class=\"line\">      printf(&quot;%-10s %s %s %s\\n&quot;,</span><br><span class=\"line\">          &quot;名称&quot;, &quot;重量&quot;, &quot;单价&quot;, &quot;分类&quot;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      &#123; printf(&quot;%-10s %6.2f %6.2f %s\\n&quot;, $1, $2, $3, $4)</span><br><span class=\"line\">        weight = weight + $2</span><br><span class=\"line\">        price  = price + $3*$2</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">END   &#123; printf(&quot;\\n%10s %6.2f %6.2f\\n&quot;, &quot;总共: &quot;, weight, price)</span><br><span class=\"line\">      &#125;%</span><br></pre></td></tr></table></figure></p>\n<p>下次传给万中无一的练武奇才时， 直接调用 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  tmp awk -f cooking radish.data</span><br><span class=\"line\">名称         重量 单价 分类</span><br><span class=\"line\">Fish        30.00   8.50 Meat</span><br><span class=\"line\">Radish      14.00   1.20 Vegetables</span><br><span class=\"line\">Cabbage     24.00   1.50 Vegetables</span><br><span class=\"line\">Apple      100.00   2.50 Fruit</span><br><span class=\"line\">Onion        8.00   0.80 Vegetables</span><br><span class=\"line\">Banana      50.00   1.40 Fruit</span><br><span class=\"line\">Beef       120.00  22.00 Meat</span><br><span class=\"line\">Rice        40.00  10.00 Staple</span><br><span class=\"line\"></span><br><span class=\"line\">      总共:  386.00 3674.20</span><br></pre></td></tr></table></figure>\n<h3 id=\"刀片出鞘\"><a href=\"#刀片出鞘\" class=\"headerlink\" title=\"刀片出鞘\"></a>刀片出鞘</h3><p>一枝军刀片，千军万马削倒一遍!<br>欲知后事如何，且听不才我下回分解。。。。。。</p>\n<!--more-->\n","categories":[],"tags":["灵犀指"]},{"title":"Clean Code","url":"http://chenyangguang.github.com/2017-04-25-clean-code/","content":"<h2 id=\"为啥看《Clean-Code》\"><a href=\"#为啥看《Clean-Code》\" class=\"headerlink\" title=\"为啥看《Clean Code》\"></a>为啥看《Clean Code》</h2><p>将需求明确到机器可以执行的细节程度，就是编程要做的事，这种归约正是代码。<br>重新审视自己写过的一些业务代码，发现依然是个熊样儿。学习一下《代码整洁之道》, 让自己的代码整洁一些。虽然启示本身不值钱，但是学习启示与案例研究中清理代码的具体决策之间的关系，对现在的我是有很大帮助的。</p>\n<h2 id=\"小处见大\"><a href=\"#小处见大\" class=\"headerlink\" title=\"小处见大\"></a>小处见大</h2><p>软件无论写得多庞大，神在细节之中。<br>He who is faithful in little is faithful in much.<br>Mighty oaks from little acorns grow.<br>“小处诚实非小事”。<br>“物皆有其位，而后物尽归其位”。</p>\n<p>## </p>\n","categories":[],"tags":["灵犀指","代码","编程"]},{"title":"点子","url":"http://chenyangguang.github.com/2017-02-03-ideas/","content":"<h2 id=\"一些闪现的点子\"><a href=\"#一些闪现的点子\" class=\"headerlink\" title=\"一些闪现的点子\"></a>一些闪现的点子</h2><h4 id=\"自动记录围棋手数的棋盘\"><a href=\"#自动记录围棋手数的棋盘\" class=\"headerlink\" title=\"自动记录围棋手数的棋盘\"></a>自动记录围棋手数的棋盘</h4><p>今天重新看围棋视频的时候，还是发现，现在棋谱的记录仍然依赖人工手动输入的方式。<br>有趣的是，2015年职业小将赵晨宇对战以为韩国棋手时，出现双方争执未找劫材就直接提劫的情况。<br>重大比赛虽然一般都配备记谱员。不过从去年到现在都一直有职业棋手反映，根据棋谱讲解时，有些棋谱中很可能次序是错的。毕竟职业的比赛一盘棋下来，多的有的需要好几个小时。记谱员不可能像职业棋手一样一直集中那么多时间和精力到每一步上面。这个过程是有次序出错的可能的。但是围棋极其重要的就是次序，甚至就是那么一两步的次序，成就了各种妙味。<br>然后，棋手下棋时还需要手动去按下计时器。有的棋手有时下棋太专注了，竟忘记了按钟，最后因为这个而丢掉了珍贵的比赛! 太讽刺了！这种分散注意力的按钟方式，不应该交给正在下棋的棋手。<br>所以应该设计并实现一种自动准确记录棋谱的智能棋盘，将极大的解放棋谱记录者的工作, 复原比赛公正性，并给棋手比赛提供最专注的注意力。</p>\n<p>智能棋牌特点:</p>\n<ul>\n<li>自动记谱</li>\n<li>提供视频复盘</li>\n<li>智能记录耗时</li>\n<li>倒计时语音</li>\n</ul>\n","categories":[],"tags":["点滴"]},{"title":"about","url":"http://chenyangguang.github.com/about/index-1.html","content":"","categories":[],"tags":[]},{"title":"categories","url":"http://chenyangguang.github.com/categories/index.html","content":"","categories":[],"tags":[]},{"title":"About","url":"http://chenyangguang.github.com/about/index.html","content":"","categories":[],"tags":[]},{"title":"Project","url":"http://chenyangguang.github.com/project/index.html","content":"","categories":[],"tags":[]},{"title":"category","url":"http://chenyangguang.github.com/category/index.html","content":"","categories":[],"tags":[]},{"title":"Tags","url":"http://chenyangguang.github.com/tags/index.html","content":"","categories":[],"tags":[]},{"title":"search","url":"http://chenyangguang.github.com/search/index.html","content":"","categories":[],"tags":[]},{"title":"tag","url":"http://chenyangguang.github.com/tag/index.html","content":"","categories":[],"tags":[]}]